// Rabia Algorithm


dtmc

const NUM_NODES = 3;
const QUORUM_SIZE = 2;
const BUF_SIZE = 2;
const MAX_TS = 2;
const QUEUE_SIZE = 2;
const LOG_SIZE = 2;
const MAX_ROUND = 2;

const p0_bc_cmd_stage = 0;
const p1_stage = 1;
const p2s_stage = 2;
const p2v_stage = 3;
const pre_decided_stage=4; // for putting cmd back to queue
const decided = 5;
const NUM_STATES = 6;

const cmd_request = 0;
const cmd_proposal = 1;
const cmd_state = 2;
const cmd_vote = 3;
const cmd_decided=4;
const NUM_CMD_TYPES = 5;

const INVALID=-1;
const BOT = -2;
const QUES_VOTE = -3;
const OUT_OF_ROUND = -4;

const MIN_VOTE_VALUE=-4;
const MIN_TS_VALUE=-4;


module node0
    // states
    n0_seq : [0..LOG_SIZE] init 0;
    /// p1 stage
    n0_pq_valid_0 : bool init true;
    n0_pq_ts_0 : [MIN_TS_VALUE..MAX_TS] init 1;
    n0_pq_valid_1 : bool init false;
    n0_pq_ts_1 : [MIN_TS_VALUE..MAX_TS] init 0;
    n0_stage_seq0 : [0..NUM_STATES] init p0_bc_cmd_stage;
    n0_log_ts_seq0 : [MIN_TS_VALUE..MAX_TS] init INVALID; 
    n0_stage_seq1 : [0..NUM_STATES] init p0_bc_cmd_stage;
    n0_log_ts_seq1 : [MIN_TS_VALUE..MAX_TS] init INVALID; 
    /// p2 stage
    n0_round_0 : [0..MAX_ROUND] init 0; 
    n0_round_1 : [0..MAX_ROUND] init 0; 
    n0_proposal_seq0_r0_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_state_ts_seq0_r0_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_vote_ts_seq0_r0_n0 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n0_proposal_seq0_r0_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_state_ts_seq0_r0_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_vote_ts_seq0_r0_n1 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n0_proposal_seq0_r0_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_state_ts_seq0_r0_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_vote_ts_seq0_r0_n2 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n0_proposal_seq0_r1_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_state_ts_seq0_r1_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_vote_ts_seq0_r1_n0 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n0_proposal_seq0_r1_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_state_ts_seq0_r1_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_vote_ts_seq0_r1_n1 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n0_proposal_seq0_r1_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_state_ts_seq0_r1_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_vote_ts_seq0_r1_n2 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n0_proposal_seq1_r0_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_state_ts_seq1_r0_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_vote_ts_seq1_r0_n0 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n0_proposal_seq1_r0_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_state_ts_seq1_r0_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_vote_ts_seq1_r0_n1 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n0_proposal_seq1_r0_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_state_ts_seq1_r0_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_vote_ts_seq1_r0_n2 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n0_proposal_seq1_r1_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_state_ts_seq1_r1_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_vote_ts_seq1_r1_n0 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n0_proposal_seq1_r1_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_state_ts_seq1_r1_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_vote_ts_seq1_r1_n1 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n0_proposal_seq1_r1_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_state_ts_seq1_r1_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n0_vote_ts_seq1_r1_n2 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;

    // pkt to send
    n0_send_ready : bool init false; // ready means not yet sent
    n0_send_is_broadcast : bool init false;
    n0_send_type : [0..NUM_CMD_TYPES] init 0;
    n0_send_seq : [0..LOG_SIZE] init 0;
    n0_send_round : [0..MAX_ROUND] init 0;
    n0_send_cmd_ts : [MIN_TS_VALUE..MAX_TS] init 0;

    // pkt received
    n0_recv_ready : bool init false; // ready means received
    n0_recv_from : [0..NUM_NODES] init 0;
    n0_recv_type : [0..NUM_CMD_TYPES] init 0;
    n0_recv_seq : [0..LOG_SIZE] init 0;
    n0_recv_round : [0..MAX_ROUND] init 0;
    n0_recv_cmd_ts : [MIN_TS_VALUE..MAX_TS] init 0;
    
    // Try on each queue slot and execute if the slot has min ts
    [n0_propose_next_command_for_seq0_using_q0] n0_stage_seq0=p0_bc_cmd_stage & n0_send_ready=false & n0_seq=0 & n0_pq_valid_0=true & (!n0_pq_valid_0|n0_pq_ts_0>=n0_pq_ts_0)&(!n0_pq_valid_1|n0_pq_ts_1>=n0_pq_ts_0) ->         (n0_stage_seq0'=p1_stage) & (n0_round_0'=0) & (n0_proposal_seq0_r0_n0'=n0_pq_ts_0) & (n0_pq_valid_0'=false) & (n0_pq_ts_0'=0) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_proposal) & (n0_send_seq'=0) & (n0_send_round'=0) & (n0_send_cmd_ts'=n0_pq_ts_0);
    [n0_propose_next_command_for_seq1_using_q0] n0_stage_seq1=p0_bc_cmd_stage & n0_send_ready=false & n0_seq=1 & n0_pq_valid_0=true & (!n0_pq_valid_0|n0_pq_ts_0>=n0_pq_ts_0)&(!n0_pq_valid_1|n0_pq_ts_1>=n0_pq_ts_0) ->         (n0_stage_seq1'=p1_stage) & (n0_round_1'=0) & (n0_proposal_seq1_r0_n0'=n0_pq_ts_0) & (n0_pq_valid_0'=false) & (n0_pq_ts_0'=0) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_proposal) & (n0_send_seq'=1) & (n0_send_round'=0) & (n0_send_cmd_ts'=n0_pq_ts_0);
    [n0_propose_next_command_for_seq0_using_q1] n0_stage_seq0=p0_bc_cmd_stage & n0_send_ready=false & n0_seq=0 & n0_pq_valid_1=true & (!n0_pq_valid_0|n0_pq_ts_0>=n0_pq_ts_1)&(!n0_pq_valid_1|n0_pq_ts_1>=n0_pq_ts_1) ->         (n0_stage_seq0'=p1_stage) & (n0_round_0'=0) & (n0_proposal_seq0_r0_n0'=n0_pq_ts_1) & (n0_pq_valid_1'=false) & (n0_pq_ts_1'=0) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_proposal) & (n0_send_seq'=0) & (n0_send_round'=0) & (n0_send_cmd_ts'=n0_pq_ts_1);
    [n0_propose_next_command_for_seq1_using_q1] n0_stage_seq1=p0_bc_cmd_stage & n0_send_ready=false & n0_seq=1 & n0_pq_valid_1=true & (!n0_pq_valid_0|n0_pq_ts_0>=n0_pq_ts_1)&(!n0_pq_valid_1|n0_pq_ts_1>=n0_pq_ts_1) ->         (n0_stage_seq1'=p1_stage) & (n0_round_1'=0) & (n0_proposal_seq1_r0_n0'=n0_pq_ts_1) & (n0_pq_valid_1'=false) & (n0_pq_ts_1'=0) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_proposal) & (n0_send_seq'=1) & (n0_send_round'=0) & (n0_send_cmd_ts'=n0_pq_ts_1);
    
    // Process when a Proposal pkt is ready.
    // Received an old proposal for seq0, reply decided.
    [n0_receive_proposal_from_old_seq0_reply_decided]   n0_recv_ready=true & n0_recv_type=cmd_proposal & n0_recv_seq=0 & (n0_stage_seq0=decided) ->         (n0_recv_ready'=false) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_decided) & (n0_send_seq'=0) & (n0_send_cmd_ts'=n0_log_ts_seq0);
    // Received an old proposal for seq1, reply decided.
    [n0_receive_proposal_from_old_seq1_reply_decided]   n0_recv_ready=true & n0_recv_type=cmd_proposal & n0_recv_seq=1 & (n0_stage_seq1=decided) ->         (n0_recv_ready'=false) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_decided) & (n0_send_seq'=1) & (n0_send_cmd_ts'=n0_log_ts_seq1); 
    // Receive the proposal from node 0 for non-decided seq0, round0. (TODO: update this, proposal can actually from round0)
    [n0_receive_proposal_from_n0_for_seq0_r0] n0_recv_ready=true & n0_recv_from=0 & n0_recv_type=cmd_proposal & n0_recv_seq=0 & n0_recv_round=0 & (n0_stage_seq0!=decided) ->         (n0_recv_ready'=false) & (n0_proposal_seq0_r0_n0'=n0_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq0, round0. (TODO: update this, proposal can actually from round0)
    [n0_receive_proposal_from_n1_for_seq0_r0] n0_recv_ready=true & n0_recv_from=1 & n0_recv_type=cmd_proposal & n0_recv_seq=0 & n0_recv_round=0 & (n0_stage_seq0!=decided) ->         (n0_recv_ready'=false) & (n0_proposal_seq0_r0_n1'=n0_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq0, round0. (TODO: update this, proposal can actually from round0)
    [n0_receive_proposal_from_n2_for_seq0_r0] n0_recv_ready=true & n0_recv_from=2 & n0_recv_type=cmd_proposal & n0_recv_seq=0 & n0_recv_round=0 & (n0_stage_seq0!=decided) ->         (n0_recv_ready'=false) & (n0_proposal_seq0_r0_n2'=n0_recv_cmd_ts); 
    // Receive the proposal from node 0 for non-decided seq0, round1. (TODO: update this, proposal can actually from round0)
    [n0_receive_proposal_from_n0_for_seq0_r1] n0_recv_ready=true & n0_recv_from=0 & n0_recv_type=cmd_proposal & n0_recv_seq=0 & n0_recv_round=1 & (n0_stage_seq0!=decided) ->         (n0_recv_ready'=false) & (n0_proposal_seq0_r1_n0'=n0_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq0, round1. (TODO: update this, proposal can actually from round0)
    [n0_receive_proposal_from_n1_for_seq0_r1] n0_recv_ready=true & n0_recv_from=1 & n0_recv_type=cmd_proposal & n0_recv_seq=0 & n0_recv_round=1 & (n0_stage_seq0!=decided) ->         (n0_recv_ready'=false) & (n0_proposal_seq0_r1_n1'=n0_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq0, round1. (TODO: update this, proposal can actually from round0)
    [n0_receive_proposal_from_n2_for_seq0_r1] n0_recv_ready=true & n0_recv_from=2 & n0_recv_type=cmd_proposal & n0_recv_seq=0 & n0_recv_round=1 & (n0_stage_seq0!=decided) ->         (n0_recv_ready'=false) & (n0_proposal_seq0_r1_n2'=n0_recv_cmd_ts); 
    // Receive the proposal from node 0 for non-decided seq1, round0. (TODO: update this, proposal can actually from round0)
    [n0_receive_proposal_from_n0_for_seq1_r0] n0_recv_ready=true & n0_recv_from=0 & n0_recv_type=cmd_proposal & n0_recv_seq=1 & n0_recv_round=0 & (n0_stage_seq1!=decided) ->         (n0_recv_ready'=false) & (n0_proposal_seq1_r0_n0'=n0_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq1, round0. (TODO: update this, proposal can actually from round0)
    [n0_receive_proposal_from_n1_for_seq1_r0] n0_recv_ready=true & n0_recv_from=1 & n0_recv_type=cmd_proposal & n0_recv_seq=1 & n0_recv_round=0 & (n0_stage_seq1!=decided) ->         (n0_recv_ready'=false) & (n0_proposal_seq1_r0_n1'=n0_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq1, round0. (TODO: update this, proposal can actually from round0)
    [n0_receive_proposal_from_n2_for_seq1_r0] n0_recv_ready=true & n0_recv_from=2 & n0_recv_type=cmd_proposal & n0_recv_seq=1 & n0_recv_round=0 & (n0_stage_seq1!=decided) ->         (n0_recv_ready'=false) & (n0_proposal_seq1_r0_n2'=n0_recv_cmd_ts); 
    // Receive the proposal from node 0 for non-decided seq1, round1. (TODO: update this, proposal can actually from round0)
    [n0_receive_proposal_from_n0_for_seq1_r1] n0_recv_ready=true & n0_recv_from=0 & n0_recv_type=cmd_proposal & n0_recv_seq=1 & n0_recv_round=1 & (n0_stage_seq1!=decided) ->         (n0_recv_ready'=false) & (n0_proposal_seq1_r1_n0'=n0_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq1, round1. (TODO: update this, proposal can actually from round0)
    [n0_receive_proposal_from_n1_for_seq1_r1] n0_recv_ready=true & n0_recv_from=1 & n0_recv_type=cmd_proposal & n0_recv_seq=1 & n0_recv_round=1 & (n0_stage_seq1!=decided) ->         (n0_recv_ready'=false) & (n0_proposal_seq1_r1_n1'=n0_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq1, round1. (TODO: update this, proposal can actually from round0)
    [n0_receive_proposal_from_n2_for_seq1_r1] n0_recv_ready=true & n0_recv_from=2 & n0_recv_type=cmd_proposal & n0_recv_seq=1 & n0_recv_round=1 & (n0_stage_seq1!=decided) ->         (n0_recv_ready'=false) & (n0_proposal_seq1_r1_n2'=n0_recv_cmd_ts); 

    // 1. When we have enough proposals, assign the state using the proposal from node 0 for seq0 at round0.
    [n0_process_proposal_assign_state_seq0_r0_using_n0] n0_stage_seq0=p1_stage & n0_round_0=0 & n0_send_ready=false & ((n0_proposal_seq0_r0_n0!=INVALID&n0_proposal_seq0_r0_n1!=INVALID)|(n0_proposal_seq0_r0_n0!=INVALID&n0_proposal_seq0_r0_n2!=INVALID)|(n0_proposal_seq0_r0_n1!=INVALID&n0_proposal_seq0_r0_n2!=INVALID)) & ((n0_proposal_seq0_r0_n1!=INVALID&n0_proposal_seq0_r0_n1=n0_proposal_seq0_r0_n0)|(n0_proposal_seq0_r0_n2!=INVALID&n0_proposal_seq0_r0_n2=n0_proposal_seq0_r0_n0)) ->         (n0_state_ts_seq0_r0_n0'=n0_proposal_seq0_r0_n0) & (n0_stage_seq0'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=0) & (n0_send_cmd_ts'=n0_proposal_seq0_r0_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign BOT.
    [n0_process_proposal_assign_state_seq0_r0_using_n0] n0_stage_seq0=p1_stage & n0_round_0=0 & n0_send_ready=false & ((n0_proposal_seq0_r0_n0!=INVALID&n0_proposal_seq0_r0_n1!=INVALID)|(n0_proposal_seq0_r0_n0!=INVALID&n0_proposal_seq0_r0_n2!=INVALID)|(n0_proposal_seq0_r0_n1!=INVALID&n0_proposal_seq0_r0_n2!=INVALID)) & !((n0_proposal_seq0_r0_n1!=INVALID&n0_proposal_seq0_r0_n1=n0_proposal_seq0_r0_n0)|(n0_proposal_seq0_r0_n2!=INVALID&n0_proposal_seq0_r0_n2=n0_proposal_seq0_r0_n0)) ->         (n0_state_ts_seq0_r0_n0'=BOT)                                    & (n0_stage_seq0'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=0) & (n0_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 1 for seq0 at round0.
    [n0_process_proposal_assign_state_seq0_r0_using_n1] n0_stage_seq0=p1_stage & n0_round_0=0 & n0_send_ready=false & ((n0_proposal_seq0_r0_n0!=INVALID&n0_proposal_seq0_r0_n1!=INVALID)|(n0_proposal_seq0_r0_n0!=INVALID&n0_proposal_seq0_r0_n2!=INVALID)|(n0_proposal_seq0_r0_n1!=INVALID&n0_proposal_seq0_r0_n2!=INVALID)) & ((n0_proposal_seq0_r0_n0!=INVALID&n0_proposal_seq0_r0_n0=n0_proposal_seq0_r0_n1)|(n0_proposal_seq0_r0_n2!=INVALID&n0_proposal_seq0_r0_n2=n0_proposal_seq0_r0_n1)) ->         (n0_state_ts_seq0_r0_n0'=n0_proposal_seq0_r0_n1) & (n0_stage_seq0'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=0) & (n0_send_cmd_ts'=n0_proposal_seq0_r0_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign BOT.
    [n0_process_proposal_assign_state_seq0_r0_using_n1] n0_stage_seq0=p1_stage & n0_round_0=0 & n0_send_ready=false & ((n0_proposal_seq0_r0_n0!=INVALID&n0_proposal_seq0_r0_n1!=INVALID)|(n0_proposal_seq0_r0_n0!=INVALID&n0_proposal_seq0_r0_n2!=INVALID)|(n0_proposal_seq0_r0_n1!=INVALID&n0_proposal_seq0_r0_n2!=INVALID)) & !((n0_proposal_seq0_r0_n0!=INVALID&n0_proposal_seq0_r0_n0=n0_proposal_seq0_r0_n1)|(n0_proposal_seq0_r0_n2!=INVALID&n0_proposal_seq0_r0_n2=n0_proposal_seq0_r0_n1)) ->         (n0_state_ts_seq0_r0_n0'=BOT)                                    & (n0_stage_seq0'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=0) & (n0_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 2 for seq0 at round0.
    [n0_process_proposal_assign_state_seq0_r0_using_n2] n0_stage_seq0=p1_stage & n0_round_0=0 & n0_send_ready=false & ((n0_proposal_seq0_r0_n0!=INVALID&n0_proposal_seq0_r0_n1!=INVALID)|(n0_proposal_seq0_r0_n0!=INVALID&n0_proposal_seq0_r0_n2!=INVALID)|(n0_proposal_seq0_r0_n1!=INVALID&n0_proposal_seq0_r0_n2!=INVALID)) & ((n0_proposal_seq0_r0_n0!=INVALID&n0_proposal_seq0_r0_n0=n0_proposal_seq0_r0_n2)|(n0_proposal_seq0_r0_n1!=INVALID&n0_proposal_seq0_r0_n1=n0_proposal_seq0_r0_n2)) ->         (n0_state_ts_seq0_r0_n0'=n0_proposal_seq0_r0_n2) & (n0_stage_seq0'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=0) & (n0_send_cmd_ts'=n0_proposal_seq0_r0_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign BOT.
    [n0_process_proposal_assign_state_seq0_r0_using_n2] n0_stage_seq0=p1_stage & n0_round_0=0 & n0_send_ready=false & ((n0_proposal_seq0_r0_n0!=INVALID&n0_proposal_seq0_r0_n1!=INVALID)|(n0_proposal_seq0_r0_n0!=INVALID&n0_proposal_seq0_r0_n2!=INVALID)|(n0_proposal_seq0_r0_n1!=INVALID&n0_proposal_seq0_r0_n2!=INVALID)) & !((n0_proposal_seq0_r0_n0!=INVALID&n0_proposal_seq0_r0_n0=n0_proposal_seq0_r0_n2)|(n0_proposal_seq0_r0_n1!=INVALID&n0_proposal_seq0_r0_n1=n0_proposal_seq0_r0_n2)) ->         (n0_state_ts_seq0_r0_n0'=BOT)                                    & (n0_stage_seq0'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=0) & (n0_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 0 for seq0 at round1.
    [n0_process_proposal_assign_state_seq0_r1_using_n0] n0_stage_seq0=p1_stage & n0_round_0=1 & n0_send_ready=false & ((n0_proposal_seq0_r1_n0!=INVALID&n0_proposal_seq0_r1_n1!=INVALID)|(n0_proposal_seq0_r1_n0!=INVALID&n0_proposal_seq0_r1_n2!=INVALID)|(n0_proposal_seq0_r1_n1!=INVALID&n0_proposal_seq0_r1_n2!=INVALID)) & ((n0_proposal_seq0_r1_n1!=INVALID&n0_proposal_seq0_r1_n1=n0_proposal_seq0_r1_n0)|(n0_proposal_seq0_r1_n2!=INVALID&n0_proposal_seq0_r1_n2=n0_proposal_seq0_r1_n0)) ->         (n0_state_ts_seq0_r1_n0'=n0_proposal_seq0_r1_n0) & (n0_stage_seq0'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=1) & (n0_send_cmd_ts'=n0_proposal_seq0_r1_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign BOT.
    [n0_process_proposal_assign_state_seq0_r1_using_n0] n0_stage_seq0=p1_stage & n0_round_0=1 & n0_send_ready=false & ((n0_proposal_seq0_r1_n0!=INVALID&n0_proposal_seq0_r1_n1!=INVALID)|(n0_proposal_seq0_r1_n0!=INVALID&n0_proposal_seq0_r1_n2!=INVALID)|(n0_proposal_seq0_r1_n1!=INVALID&n0_proposal_seq0_r1_n2!=INVALID)) & !((n0_proposal_seq0_r1_n1!=INVALID&n0_proposal_seq0_r1_n1=n0_proposal_seq0_r1_n0)|(n0_proposal_seq0_r1_n2!=INVALID&n0_proposal_seq0_r1_n2=n0_proposal_seq0_r1_n0)) ->         (n0_state_ts_seq0_r1_n0'=BOT)                                    & (n0_stage_seq0'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=1) & (n0_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 1 for seq0 at round1.
    [n0_process_proposal_assign_state_seq0_r1_using_n1] n0_stage_seq0=p1_stage & n0_round_0=1 & n0_send_ready=false & ((n0_proposal_seq0_r1_n0!=INVALID&n0_proposal_seq0_r1_n1!=INVALID)|(n0_proposal_seq0_r1_n0!=INVALID&n0_proposal_seq0_r1_n2!=INVALID)|(n0_proposal_seq0_r1_n1!=INVALID&n0_proposal_seq0_r1_n2!=INVALID)) & ((n0_proposal_seq0_r1_n0!=INVALID&n0_proposal_seq0_r1_n0=n0_proposal_seq0_r1_n1)|(n0_proposal_seq0_r1_n2!=INVALID&n0_proposal_seq0_r1_n2=n0_proposal_seq0_r1_n1)) ->         (n0_state_ts_seq0_r1_n0'=n0_proposal_seq0_r1_n1) & (n0_stage_seq0'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=1) & (n0_send_cmd_ts'=n0_proposal_seq0_r1_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign BOT.
    [n0_process_proposal_assign_state_seq0_r1_using_n1] n0_stage_seq0=p1_stage & n0_round_0=1 & n0_send_ready=false & ((n0_proposal_seq0_r1_n0!=INVALID&n0_proposal_seq0_r1_n1!=INVALID)|(n0_proposal_seq0_r1_n0!=INVALID&n0_proposal_seq0_r1_n2!=INVALID)|(n0_proposal_seq0_r1_n1!=INVALID&n0_proposal_seq0_r1_n2!=INVALID)) & !((n0_proposal_seq0_r1_n0!=INVALID&n0_proposal_seq0_r1_n0=n0_proposal_seq0_r1_n1)|(n0_proposal_seq0_r1_n2!=INVALID&n0_proposal_seq0_r1_n2=n0_proposal_seq0_r1_n1)) ->         (n0_state_ts_seq0_r1_n0'=BOT)                                    & (n0_stage_seq0'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=1) & (n0_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 2 for seq0 at round1.
    [n0_process_proposal_assign_state_seq0_r1_using_n2] n0_stage_seq0=p1_stage & n0_round_0=1 & n0_send_ready=false & ((n0_proposal_seq0_r1_n0!=INVALID&n0_proposal_seq0_r1_n1!=INVALID)|(n0_proposal_seq0_r1_n0!=INVALID&n0_proposal_seq0_r1_n2!=INVALID)|(n0_proposal_seq0_r1_n1!=INVALID&n0_proposal_seq0_r1_n2!=INVALID)) & ((n0_proposal_seq0_r1_n0!=INVALID&n0_proposal_seq0_r1_n0=n0_proposal_seq0_r1_n2)|(n0_proposal_seq0_r1_n1!=INVALID&n0_proposal_seq0_r1_n1=n0_proposal_seq0_r1_n2)) ->         (n0_state_ts_seq0_r1_n0'=n0_proposal_seq0_r1_n2) & (n0_stage_seq0'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=1) & (n0_send_cmd_ts'=n0_proposal_seq0_r1_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign BOT.
    [n0_process_proposal_assign_state_seq0_r1_using_n2] n0_stage_seq0=p1_stage & n0_round_0=1 & n0_send_ready=false & ((n0_proposal_seq0_r1_n0!=INVALID&n0_proposal_seq0_r1_n1!=INVALID)|(n0_proposal_seq0_r1_n0!=INVALID&n0_proposal_seq0_r1_n2!=INVALID)|(n0_proposal_seq0_r1_n1!=INVALID&n0_proposal_seq0_r1_n2!=INVALID)) & !((n0_proposal_seq0_r1_n0!=INVALID&n0_proposal_seq0_r1_n0=n0_proposal_seq0_r1_n2)|(n0_proposal_seq0_r1_n1!=INVALID&n0_proposal_seq0_r1_n1=n0_proposal_seq0_r1_n2)) ->         (n0_state_ts_seq0_r1_n0'=BOT)                                    & (n0_stage_seq0'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=1) & (n0_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 0 for seq1 at round0.
    [n0_process_proposal_assign_state_seq1_r0_using_n0] n0_stage_seq1=p1_stage & n0_round_1=0 & n0_send_ready=false & ((n0_proposal_seq1_r0_n0!=INVALID&n0_proposal_seq1_r0_n1!=INVALID)|(n0_proposal_seq1_r0_n0!=INVALID&n0_proposal_seq1_r0_n2!=INVALID)|(n0_proposal_seq1_r0_n1!=INVALID&n0_proposal_seq1_r0_n2!=INVALID)) & ((n0_proposal_seq1_r0_n1!=INVALID&n0_proposal_seq1_r0_n1=n0_proposal_seq1_r0_n0)|(n0_proposal_seq1_r0_n2!=INVALID&n0_proposal_seq1_r0_n2=n0_proposal_seq1_r0_n0)) ->         (n0_state_ts_seq1_r0_n0'=n0_proposal_seq1_r0_n0) & (n0_stage_seq1'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=0) & (n0_send_cmd_ts'=n0_proposal_seq1_r0_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign BOT.
    [n0_process_proposal_assign_state_seq1_r0_using_n0] n0_stage_seq1=p1_stage & n0_round_1=0 & n0_send_ready=false & ((n0_proposal_seq1_r0_n0!=INVALID&n0_proposal_seq1_r0_n1!=INVALID)|(n0_proposal_seq1_r0_n0!=INVALID&n0_proposal_seq1_r0_n2!=INVALID)|(n0_proposal_seq1_r0_n1!=INVALID&n0_proposal_seq1_r0_n2!=INVALID)) & !((n0_proposal_seq1_r0_n1!=INVALID&n0_proposal_seq1_r0_n1=n0_proposal_seq1_r0_n0)|(n0_proposal_seq1_r0_n2!=INVALID&n0_proposal_seq1_r0_n2=n0_proposal_seq1_r0_n0)) ->         (n0_state_ts_seq1_r0_n0'=BOT)                                    & (n0_stage_seq1'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=0) & (n0_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 1 for seq1 at round0.
    [n0_process_proposal_assign_state_seq1_r0_using_n1] n0_stage_seq1=p1_stage & n0_round_1=0 & n0_send_ready=false & ((n0_proposal_seq1_r0_n0!=INVALID&n0_proposal_seq1_r0_n1!=INVALID)|(n0_proposal_seq1_r0_n0!=INVALID&n0_proposal_seq1_r0_n2!=INVALID)|(n0_proposal_seq1_r0_n1!=INVALID&n0_proposal_seq1_r0_n2!=INVALID)) & ((n0_proposal_seq1_r0_n0!=INVALID&n0_proposal_seq1_r0_n0=n0_proposal_seq1_r0_n1)|(n0_proposal_seq1_r0_n2!=INVALID&n0_proposal_seq1_r0_n2=n0_proposal_seq1_r0_n1)) ->         (n0_state_ts_seq1_r0_n0'=n0_proposal_seq1_r0_n1) & (n0_stage_seq1'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=0) & (n0_send_cmd_ts'=n0_proposal_seq1_r0_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign BOT.
    [n0_process_proposal_assign_state_seq1_r0_using_n1] n0_stage_seq1=p1_stage & n0_round_1=0 & n0_send_ready=false & ((n0_proposal_seq1_r0_n0!=INVALID&n0_proposal_seq1_r0_n1!=INVALID)|(n0_proposal_seq1_r0_n0!=INVALID&n0_proposal_seq1_r0_n2!=INVALID)|(n0_proposal_seq1_r0_n1!=INVALID&n0_proposal_seq1_r0_n2!=INVALID)) & !((n0_proposal_seq1_r0_n0!=INVALID&n0_proposal_seq1_r0_n0=n0_proposal_seq1_r0_n1)|(n0_proposal_seq1_r0_n2!=INVALID&n0_proposal_seq1_r0_n2=n0_proposal_seq1_r0_n1)) ->         (n0_state_ts_seq1_r0_n0'=BOT)                                    & (n0_stage_seq1'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=0) & (n0_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 2 for seq1 at round0.
    [n0_process_proposal_assign_state_seq1_r0_using_n2] n0_stage_seq1=p1_stage & n0_round_1=0 & n0_send_ready=false & ((n0_proposal_seq1_r0_n0!=INVALID&n0_proposal_seq1_r0_n1!=INVALID)|(n0_proposal_seq1_r0_n0!=INVALID&n0_proposal_seq1_r0_n2!=INVALID)|(n0_proposal_seq1_r0_n1!=INVALID&n0_proposal_seq1_r0_n2!=INVALID)) & ((n0_proposal_seq1_r0_n0!=INVALID&n0_proposal_seq1_r0_n0=n0_proposal_seq1_r0_n2)|(n0_proposal_seq1_r0_n1!=INVALID&n0_proposal_seq1_r0_n1=n0_proposal_seq1_r0_n2)) ->         (n0_state_ts_seq1_r0_n0'=n0_proposal_seq1_r0_n2) & (n0_stage_seq1'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=0) & (n0_send_cmd_ts'=n0_proposal_seq1_r0_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign BOT.
    [n0_process_proposal_assign_state_seq1_r0_using_n2] n0_stage_seq1=p1_stage & n0_round_1=0 & n0_send_ready=false & ((n0_proposal_seq1_r0_n0!=INVALID&n0_proposal_seq1_r0_n1!=INVALID)|(n0_proposal_seq1_r0_n0!=INVALID&n0_proposal_seq1_r0_n2!=INVALID)|(n0_proposal_seq1_r0_n1!=INVALID&n0_proposal_seq1_r0_n2!=INVALID)) & !((n0_proposal_seq1_r0_n0!=INVALID&n0_proposal_seq1_r0_n0=n0_proposal_seq1_r0_n2)|(n0_proposal_seq1_r0_n1!=INVALID&n0_proposal_seq1_r0_n1=n0_proposal_seq1_r0_n2)) ->         (n0_state_ts_seq1_r0_n0'=BOT)                                    & (n0_stage_seq1'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=0) & (n0_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 0 for seq1 at round1.
    [n0_process_proposal_assign_state_seq1_r1_using_n0] n0_stage_seq1=p1_stage & n0_round_1=1 & n0_send_ready=false & ((n0_proposal_seq1_r1_n0!=INVALID&n0_proposal_seq1_r1_n1!=INVALID)|(n0_proposal_seq1_r1_n0!=INVALID&n0_proposal_seq1_r1_n2!=INVALID)|(n0_proposal_seq1_r1_n1!=INVALID&n0_proposal_seq1_r1_n2!=INVALID)) & ((n0_proposal_seq1_r1_n1!=INVALID&n0_proposal_seq1_r1_n1=n0_proposal_seq1_r1_n0)|(n0_proposal_seq1_r1_n2!=INVALID&n0_proposal_seq1_r1_n2=n0_proposal_seq1_r1_n0)) ->         (n0_state_ts_seq1_r1_n0'=n0_proposal_seq1_r1_n0) & (n0_stage_seq1'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=1) & (n0_send_cmd_ts'=n0_proposal_seq1_r1_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign BOT.
    [n0_process_proposal_assign_state_seq1_r1_using_n0] n0_stage_seq1=p1_stage & n0_round_1=1 & n0_send_ready=false & ((n0_proposal_seq1_r1_n0!=INVALID&n0_proposal_seq1_r1_n1!=INVALID)|(n0_proposal_seq1_r1_n0!=INVALID&n0_proposal_seq1_r1_n2!=INVALID)|(n0_proposal_seq1_r1_n1!=INVALID&n0_proposal_seq1_r1_n2!=INVALID)) & !((n0_proposal_seq1_r1_n1!=INVALID&n0_proposal_seq1_r1_n1=n0_proposal_seq1_r1_n0)|(n0_proposal_seq1_r1_n2!=INVALID&n0_proposal_seq1_r1_n2=n0_proposal_seq1_r1_n0)) ->         (n0_state_ts_seq1_r1_n0'=BOT)                                    & (n0_stage_seq1'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=1) & (n0_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 1 for seq1 at round1.
    [n0_process_proposal_assign_state_seq1_r1_using_n1] n0_stage_seq1=p1_stage & n0_round_1=1 & n0_send_ready=false & ((n0_proposal_seq1_r1_n0!=INVALID&n0_proposal_seq1_r1_n1!=INVALID)|(n0_proposal_seq1_r1_n0!=INVALID&n0_proposal_seq1_r1_n2!=INVALID)|(n0_proposal_seq1_r1_n1!=INVALID&n0_proposal_seq1_r1_n2!=INVALID)) & ((n0_proposal_seq1_r1_n0!=INVALID&n0_proposal_seq1_r1_n0=n0_proposal_seq1_r1_n1)|(n0_proposal_seq1_r1_n2!=INVALID&n0_proposal_seq1_r1_n2=n0_proposal_seq1_r1_n1)) ->         (n0_state_ts_seq1_r1_n0'=n0_proposal_seq1_r1_n1) & (n0_stage_seq1'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=1) & (n0_send_cmd_ts'=n0_proposal_seq1_r1_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign BOT.
    [n0_process_proposal_assign_state_seq1_r1_using_n1] n0_stage_seq1=p1_stage & n0_round_1=1 & n0_send_ready=false & ((n0_proposal_seq1_r1_n0!=INVALID&n0_proposal_seq1_r1_n1!=INVALID)|(n0_proposal_seq1_r1_n0!=INVALID&n0_proposal_seq1_r1_n2!=INVALID)|(n0_proposal_seq1_r1_n1!=INVALID&n0_proposal_seq1_r1_n2!=INVALID)) & !((n0_proposal_seq1_r1_n0!=INVALID&n0_proposal_seq1_r1_n0=n0_proposal_seq1_r1_n1)|(n0_proposal_seq1_r1_n2!=INVALID&n0_proposal_seq1_r1_n2=n0_proposal_seq1_r1_n1)) ->         (n0_state_ts_seq1_r1_n0'=BOT)                                    & (n0_stage_seq1'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=1) & (n0_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 2 for seq1 at round1.
    [n0_process_proposal_assign_state_seq1_r1_using_n2] n0_stage_seq1=p1_stage & n0_round_1=1 & n0_send_ready=false & ((n0_proposal_seq1_r1_n0!=INVALID&n0_proposal_seq1_r1_n1!=INVALID)|(n0_proposal_seq1_r1_n0!=INVALID&n0_proposal_seq1_r1_n2!=INVALID)|(n0_proposal_seq1_r1_n1!=INVALID&n0_proposal_seq1_r1_n2!=INVALID)) & ((n0_proposal_seq1_r1_n0!=INVALID&n0_proposal_seq1_r1_n0=n0_proposal_seq1_r1_n2)|(n0_proposal_seq1_r1_n1!=INVALID&n0_proposal_seq1_r1_n1=n0_proposal_seq1_r1_n2)) ->         (n0_state_ts_seq1_r1_n0'=n0_proposal_seq1_r1_n2) & (n0_stage_seq1'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=1) & (n0_send_cmd_ts'=n0_proposal_seq1_r1_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign BOT.
    [n0_process_proposal_assign_state_seq1_r1_using_n2] n0_stage_seq1=p1_stage & n0_round_1=1 & n0_send_ready=false & ((n0_proposal_seq1_r1_n0!=INVALID&n0_proposal_seq1_r1_n1!=INVALID)|(n0_proposal_seq1_r1_n0!=INVALID&n0_proposal_seq1_r1_n2!=INVALID)|(n0_proposal_seq1_r1_n1!=INVALID&n0_proposal_seq1_r1_n2!=INVALID)) & !((n0_proposal_seq1_r1_n0!=INVALID&n0_proposal_seq1_r1_n0=n0_proposal_seq1_r1_n2)|(n0_proposal_seq1_r1_n1!=INVALID&n0_proposal_seq1_r1_n1=n0_proposal_seq1_r1_n2)) ->         (n0_state_ts_seq1_r1_n0'=BOT)                                    & (n0_stage_seq1'=p2s_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=1) & (n0_send_cmd_ts'=BOT);

        
    // Process when a State pkt is ready.
    // Received an old state for seq0, reply decided.
    [n0_receive_state_from_old_seq0_reply_decided]   n0_recv_ready=true & n0_recv_type=cmd_state & (n0_stage_seq0=decided) & n0_recv_seq=0 ->         (n0_recv_ready'=false) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_decided) & (n0_send_seq'=0) & (n0_send_cmd_ts'=n0_log_ts_seq0);
    // Received an old state for seq1, reply decided.
    [n0_receive_state_from_old_seq1_reply_decided]   n0_recv_ready=true & n0_recv_type=cmd_state & (n0_stage_seq1=decided) & n0_recv_seq=1 ->         (n0_recv_ready'=false) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_decided) & (n0_send_seq'=1) & (n0_send_cmd_ts'=n0_log_ts_seq1); 
    // Receive the proposal from node 0 for non-decided seq0, round0.
    [n0_receive_state_from_n0_for_seq0_r0] n0_recv_ready=true & n0_recv_from=0 & n0_recv_type=cmd_state & n0_recv_seq=0 & n0_recv_round=0 & (n0_stage_seq0!=decided) ->         (n0_recv_ready'=false) & (n0_state_ts_seq0_r0_n0'=n0_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq0, round0.
    [n0_receive_state_from_n1_for_seq0_r0] n0_recv_ready=true & n0_recv_from=1 & n0_recv_type=cmd_state & n0_recv_seq=0 & n0_recv_round=0 & (n0_stage_seq0!=decided) ->         (n0_recv_ready'=false) & (n0_state_ts_seq0_r0_n1'=n0_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq0, round0.
    [n0_receive_state_from_n2_for_seq0_r0] n0_recv_ready=true & n0_recv_from=2 & n0_recv_type=cmd_state & n0_recv_seq=0 & n0_recv_round=0 & (n0_stage_seq0!=decided) ->         (n0_recv_ready'=false) & (n0_state_ts_seq0_r0_n2'=n0_recv_cmd_ts); 
    // Receive the proposal from node 0 for non-decided seq0, round1.
    [n0_receive_state_from_n0_for_seq0_r1] n0_recv_ready=true & n0_recv_from=0 & n0_recv_type=cmd_state & n0_recv_seq=0 & n0_recv_round=1 & (n0_stage_seq0!=decided) ->         (n0_recv_ready'=false) & (n0_state_ts_seq0_r1_n0'=n0_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq0, round1.
    [n0_receive_state_from_n1_for_seq0_r1] n0_recv_ready=true & n0_recv_from=1 & n0_recv_type=cmd_state & n0_recv_seq=0 & n0_recv_round=1 & (n0_stage_seq0!=decided) ->         (n0_recv_ready'=false) & (n0_state_ts_seq0_r1_n1'=n0_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq0, round1.
    [n0_receive_state_from_n2_for_seq0_r1] n0_recv_ready=true & n0_recv_from=2 & n0_recv_type=cmd_state & n0_recv_seq=0 & n0_recv_round=1 & (n0_stage_seq0!=decided) ->         (n0_recv_ready'=false) & (n0_state_ts_seq0_r1_n2'=n0_recv_cmd_ts); 
    // Receive the proposal from node 0 for non-decided seq1, round0.
    [n0_receive_state_from_n0_for_seq1_r0] n0_recv_ready=true & n0_recv_from=0 & n0_recv_type=cmd_state & n0_recv_seq=1 & n0_recv_round=0 & (n0_stage_seq1!=decided) ->         (n0_recv_ready'=false) & (n0_state_ts_seq1_r0_n0'=n0_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq1, round0.
    [n0_receive_state_from_n1_for_seq1_r0] n0_recv_ready=true & n0_recv_from=1 & n0_recv_type=cmd_state & n0_recv_seq=1 & n0_recv_round=0 & (n0_stage_seq1!=decided) ->         (n0_recv_ready'=false) & (n0_state_ts_seq1_r0_n1'=n0_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq1, round0.
    [n0_receive_state_from_n2_for_seq1_r0] n0_recv_ready=true & n0_recv_from=2 & n0_recv_type=cmd_state & n0_recv_seq=1 & n0_recv_round=0 & (n0_stage_seq1!=decided) ->         (n0_recv_ready'=false) & (n0_state_ts_seq1_r0_n2'=n0_recv_cmd_ts); 
    // Receive the proposal from node 0 for non-decided seq1, round1.
    [n0_receive_state_from_n0_for_seq1_r1] n0_recv_ready=true & n0_recv_from=0 & n0_recv_type=cmd_state & n0_recv_seq=1 & n0_recv_round=1 & (n0_stage_seq1!=decided) ->         (n0_recv_ready'=false) & (n0_state_ts_seq1_r1_n0'=n0_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq1, round1.
    [n0_receive_state_from_n1_for_seq1_r1] n0_recv_ready=true & n0_recv_from=1 & n0_recv_type=cmd_state & n0_recv_seq=1 & n0_recv_round=1 & (n0_stage_seq1!=decided) ->         (n0_recv_ready'=false) & (n0_state_ts_seq1_r1_n1'=n0_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq1, round1.
    [n0_receive_state_from_n2_for_seq1_r1] n0_recv_ready=true & n0_recv_from=2 & n0_recv_type=cmd_state & n0_recv_seq=1 & n0_recv_round=1 & (n0_stage_seq1!=decided) ->         (n0_recv_ready'=false) & (n0_state_ts_seq1_r1_n2'=n0_recv_cmd_ts); 

    // 1. When we have enough states, seq0 assign the state using the proposal from node 0 for seq0 at round0.
    [n0_process_state_assign_vote_seq0_r0_using_n0] n0_stage_seq0=p2s_stage & n0_round_0=0 & n0_send_ready=false & ((n0_state_ts_seq0_r0_n0!=INVALID&n0_state_ts_seq0_r0_n1!=INVALID)|(n0_state_ts_seq0_r0_n0!=INVALID&n0_state_ts_seq0_r0_n2!=INVALID)|(n0_state_ts_seq0_r0_n1!=INVALID&n0_state_ts_seq0_r0_n2!=INVALID)) &  ((n0_state_ts_seq0_r0_n1!=INVALID&n0_state_ts_seq0_r0_n1=n0_state_ts_seq0_r0_n0)|(n0_state_ts_seq0_r0_n2!=INVALID&n0_state_ts_seq0_r0_n2=n0_state_ts_seq0_r0_n0)) ->         (n0_vote_ts_seq0_r0_n0'=n0_state_ts_seq0_r0_n0) & (n0_stage_seq0'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=0) & (n0_send_round'=0) & (n0_send_cmd_ts'=n0_state_ts_seq0_r0_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign QUES_VOTE.
    [n0_process_state_assign_vote_seq0_r0_using_n0] n0_stage_seq0=p2s_stage & n0_round_0=0 & n0_send_ready=false & ((n0_state_ts_seq0_r0_n0!=INVALID&n0_state_ts_seq0_r0_n1!=INVALID)|(n0_state_ts_seq0_r0_n0!=INVALID&n0_state_ts_seq0_r0_n2!=INVALID)|(n0_state_ts_seq0_r0_n1!=INVALID&n0_state_ts_seq0_r0_n2!=INVALID)) & !((n0_state_ts_seq0_r0_n1!=INVALID&n0_state_ts_seq0_r0_n1=n0_state_ts_seq0_r0_n0)|(n0_state_ts_seq0_r0_n2!=INVALID&n0_state_ts_seq0_r0_n2=n0_state_ts_seq0_r0_n0)) ->         (n0_vote_ts_seq0_r0_n0'=QUES_VOTE)                              & (n0_stage_seq0'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=0) & (n0_send_round'=0) & (n0_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq0 assign the state using the proposal from node 1 for seq0 at round0.
    [n0_process_state_assign_vote_seq0_r0_using_n1] n0_stage_seq0=p2s_stage & n0_round_0=0 & n0_send_ready=false & ((n0_state_ts_seq0_r0_n0!=INVALID&n0_state_ts_seq0_r0_n1!=INVALID)|(n0_state_ts_seq0_r0_n0!=INVALID&n0_state_ts_seq0_r0_n2!=INVALID)|(n0_state_ts_seq0_r0_n1!=INVALID&n0_state_ts_seq0_r0_n2!=INVALID)) &  ((n0_state_ts_seq0_r0_n0!=INVALID&n0_state_ts_seq0_r0_n0=n0_state_ts_seq0_r0_n1)|(n0_state_ts_seq0_r0_n2!=INVALID&n0_state_ts_seq0_r0_n2=n0_state_ts_seq0_r0_n1)) ->         (n0_vote_ts_seq0_r0_n0'=n0_state_ts_seq0_r0_n1) & (n0_stage_seq0'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=0) & (n0_send_round'=0) & (n0_send_cmd_ts'=n0_state_ts_seq0_r0_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign QUES_VOTE.
    [n0_process_state_assign_vote_seq0_r0_using_n1] n0_stage_seq0=p2s_stage & n0_round_0=0 & n0_send_ready=false & ((n0_state_ts_seq0_r0_n0!=INVALID&n0_state_ts_seq0_r0_n1!=INVALID)|(n0_state_ts_seq0_r0_n0!=INVALID&n0_state_ts_seq0_r0_n2!=INVALID)|(n0_state_ts_seq0_r0_n1!=INVALID&n0_state_ts_seq0_r0_n2!=INVALID)) & !((n0_state_ts_seq0_r0_n0!=INVALID&n0_state_ts_seq0_r0_n0=n0_state_ts_seq0_r0_n1)|(n0_state_ts_seq0_r0_n2!=INVALID&n0_state_ts_seq0_r0_n2=n0_state_ts_seq0_r0_n1)) ->         (n0_vote_ts_seq0_r0_n0'=QUES_VOTE)                              & (n0_stage_seq0'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=0) & (n0_send_round'=0) & (n0_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq0 assign the state using the proposal from node 2 for seq0 at round0.
    [n0_process_state_assign_vote_seq0_r0_using_n2] n0_stage_seq0=p2s_stage & n0_round_0=0 & n0_send_ready=false & ((n0_state_ts_seq0_r0_n0!=INVALID&n0_state_ts_seq0_r0_n1!=INVALID)|(n0_state_ts_seq0_r0_n0!=INVALID&n0_state_ts_seq0_r0_n2!=INVALID)|(n0_state_ts_seq0_r0_n1!=INVALID&n0_state_ts_seq0_r0_n2!=INVALID)) &  ((n0_state_ts_seq0_r0_n0!=INVALID&n0_state_ts_seq0_r0_n0=n0_state_ts_seq0_r0_n2)|(n0_state_ts_seq0_r0_n1!=INVALID&n0_state_ts_seq0_r0_n1=n0_state_ts_seq0_r0_n2)) ->         (n0_vote_ts_seq0_r0_n0'=n0_state_ts_seq0_r0_n2) & (n0_stage_seq0'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=0) & (n0_send_round'=0) & (n0_send_cmd_ts'=n0_state_ts_seq0_r0_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign QUES_VOTE.
    [n0_process_state_assign_vote_seq0_r0_using_n2] n0_stage_seq0=p2s_stage & n0_round_0=0 & n0_send_ready=false & ((n0_state_ts_seq0_r0_n0!=INVALID&n0_state_ts_seq0_r0_n1!=INVALID)|(n0_state_ts_seq0_r0_n0!=INVALID&n0_state_ts_seq0_r0_n2!=INVALID)|(n0_state_ts_seq0_r0_n1!=INVALID&n0_state_ts_seq0_r0_n2!=INVALID)) & !((n0_state_ts_seq0_r0_n0!=INVALID&n0_state_ts_seq0_r0_n0=n0_state_ts_seq0_r0_n2)|(n0_state_ts_seq0_r0_n1!=INVALID&n0_state_ts_seq0_r0_n1=n0_state_ts_seq0_r0_n2)) ->         (n0_vote_ts_seq0_r0_n0'=QUES_VOTE)                              & (n0_stage_seq0'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=0) & (n0_send_round'=0) & (n0_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq0 assign the state using the proposal from node 0 for seq0 at round1.
    [n0_process_state_assign_vote_seq0_r1_using_n0] n0_stage_seq0=p2s_stage & n0_round_0=1 & n0_send_ready=false & ((n0_state_ts_seq0_r1_n0!=INVALID&n0_state_ts_seq0_r1_n1!=INVALID)|(n0_state_ts_seq0_r1_n0!=INVALID&n0_state_ts_seq0_r1_n2!=INVALID)|(n0_state_ts_seq0_r1_n1!=INVALID&n0_state_ts_seq0_r1_n2!=INVALID)) &  ((n0_state_ts_seq0_r1_n1!=INVALID&n0_state_ts_seq0_r1_n1=n0_state_ts_seq0_r1_n0)|(n0_state_ts_seq0_r1_n2!=INVALID&n0_state_ts_seq0_r1_n2=n0_state_ts_seq0_r1_n0)) ->         (n0_vote_ts_seq0_r1_n0'=n0_state_ts_seq0_r1_n0) & (n0_stage_seq0'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=0) & (n0_send_round'=1) & (n0_send_cmd_ts'=n0_state_ts_seq0_r1_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign QUES_VOTE.
    [n0_process_state_assign_vote_seq0_r1_using_n0] n0_stage_seq0=p2s_stage & n0_round_0=1 & n0_send_ready=false & ((n0_state_ts_seq0_r1_n0!=INVALID&n0_state_ts_seq0_r1_n1!=INVALID)|(n0_state_ts_seq0_r1_n0!=INVALID&n0_state_ts_seq0_r1_n2!=INVALID)|(n0_state_ts_seq0_r1_n1!=INVALID&n0_state_ts_seq0_r1_n2!=INVALID)) & !((n0_state_ts_seq0_r1_n1!=INVALID&n0_state_ts_seq0_r1_n1=n0_state_ts_seq0_r1_n0)|(n0_state_ts_seq0_r1_n2!=INVALID&n0_state_ts_seq0_r1_n2=n0_state_ts_seq0_r1_n0)) ->         (n0_vote_ts_seq0_r1_n0'=QUES_VOTE)                              & (n0_stage_seq0'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=0) & (n0_send_round'=1) & (n0_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq0 assign the state using the proposal from node 1 for seq0 at round1.
    [n0_process_state_assign_vote_seq0_r1_using_n1] n0_stage_seq0=p2s_stage & n0_round_0=1 & n0_send_ready=false & ((n0_state_ts_seq0_r1_n0!=INVALID&n0_state_ts_seq0_r1_n1!=INVALID)|(n0_state_ts_seq0_r1_n0!=INVALID&n0_state_ts_seq0_r1_n2!=INVALID)|(n0_state_ts_seq0_r1_n1!=INVALID&n0_state_ts_seq0_r1_n2!=INVALID)) &  ((n0_state_ts_seq0_r1_n0!=INVALID&n0_state_ts_seq0_r1_n0=n0_state_ts_seq0_r1_n1)|(n0_state_ts_seq0_r1_n2!=INVALID&n0_state_ts_seq0_r1_n2=n0_state_ts_seq0_r1_n1)) ->         (n0_vote_ts_seq0_r1_n0'=n0_state_ts_seq0_r1_n1) & (n0_stage_seq0'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=0) & (n0_send_round'=1) & (n0_send_cmd_ts'=n0_state_ts_seq0_r1_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign QUES_VOTE.
    [n0_process_state_assign_vote_seq0_r1_using_n1] n0_stage_seq0=p2s_stage & n0_round_0=1 & n0_send_ready=false & ((n0_state_ts_seq0_r1_n0!=INVALID&n0_state_ts_seq0_r1_n1!=INVALID)|(n0_state_ts_seq0_r1_n0!=INVALID&n0_state_ts_seq0_r1_n2!=INVALID)|(n0_state_ts_seq0_r1_n1!=INVALID&n0_state_ts_seq0_r1_n2!=INVALID)) & !((n0_state_ts_seq0_r1_n0!=INVALID&n0_state_ts_seq0_r1_n0=n0_state_ts_seq0_r1_n1)|(n0_state_ts_seq0_r1_n2!=INVALID&n0_state_ts_seq0_r1_n2=n0_state_ts_seq0_r1_n1)) ->         (n0_vote_ts_seq0_r1_n0'=QUES_VOTE)                              & (n0_stage_seq0'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=0) & (n0_send_round'=1) & (n0_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq0 assign the state using the proposal from node 2 for seq0 at round1.
    [n0_process_state_assign_vote_seq0_r1_using_n2] n0_stage_seq0=p2s_stage & n0_round_0=1 & n0_send_ready=false & ((n0_state_ts_seq0_r1_n0!=INVALID&n0_state_ts_seq0_r1_n1!=INVALID)|(n0_state_ts_seq0_r1_n0!=INVALID&n0_state_ts_seq0_r1_n2!=INVALID)|(n0_state_ts_seq0_r1_n1!=INVALID&n0_state_ts_seq0_r1_n2!=INVALID)) &  ((n0_state_ts_seq0_r1_n0!=INVALID&n0_state_ts_seq0_r1_n0=n0_state_ts_seq0_r1_n2)|(n0_state_ts_seq0_r1_n1!=INVALID&n0_state_ts_seq0_r1_n1=n0_state_ts_seq0_r1_n2)) ->         (n0_vote_ts_seq0_r1_n0'=n0_state_ts_seq0_r1_n2) & (n0_stage_seq0'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=0) & (n0_send_round'=1) & (n0_send_cmd_ts'=n0_state_ts_seq0_r1_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign QUES_VOTE.
    [n0_process_state_assign_vote_seq0_r1_using_n2] n0_stage_seq0=p2s_stage & n0_round_0=1 & n0_send_ready=false & ((n0_state_ts_seq0_r1_n0!=INVALID&n0_state_ts_seq0_r1_n1!=INVALID)|(n0_state_ts_seq0_r1_n0!=INVALID&n0_state_ts_seq0_r1_n2!=INVALID)|(n0_state_ts_seq0_r1_n1!=INVALID&n0_state_ts_seq0_r1_n2!=INVALID)) & !((n0_state_ts_seq0_r1_n0!=INVALID&n0_state_ts_seq0_r1_n0=n0_state_ts_seq0_r1_n2)|(n0_state_ts_seq0_r1_n1!=INVALID&n0_state_ts_seq0_r1_n1=n0_state_ts_seq0_r1_n2)) ->         (n0_vote_ts_seq0_r1_n0'=QUES_VOTE)                              & (n0_stage_seq0'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=0) & (n0_send_round'=1) & (n0_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq1 assign the state using the proposal from node 0 for seq1 at round0.
    [n0_process_state_assign_vote_seq1_r0_using_n0] n0_stage_seq1=p2s_stage & n0_round_1=0 & n0_send_ready=false & ((n0_state_ts_seq1_r0_n0!=INVALID&n0_state_ts_seq1_r0_n1!=INVALID)|(n0_state_ts_seq1_r0_n0!=INVALID&n0_state_ts_seq1_r0_n2!=INVALID)|(n0_state_ts_seq1_r0_n1!=INVALID&n0_state_ts_seq1_r0_n2!=INVALID)) &  ((n0_state_ts_seq1_r0_n1!=INVALID&n0_state_ts_seq1_r0_n1=n0_state_ts_seq1_r0_n0)|(n0_state_ts_seq1_r0_n2!=INVALID&n0_state_ts_seq1_r0_n2=n0_state_ts_seq1_r0_n0)) ->         (n0_vote_ts_seq1_r0_n0'=n0_state_ts_seq1_r0_n0) & (n0_stage_seq1'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=1) & (n0_send_round'=0) & (n0_send_cmd_ts'=n0_state_ts_seq1_r0_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign QUES_VOTE.
    [n0_process_state_assign_vote_seq1_r0_using_n0] n0_stage_seq1=p2s_stage & n0_round_1=0 & n0_send_ready=false & ((n0_state_ts_seq1_r0_n0!=INVALID&n0_state_ts_seq1_r0_n1!=INVALID)|(n0_state_ts_seq1_r0_n0!=INVALID&n0_state_ts_seq1_r0_n2!=INVALID)|(n0_state_ts_seq1_r0_n1!=INVALID&n0_state_ts_seq1_r0_n2!=INVALID)) & !((n0_state_ts_seq1_r0_n1!=INVALID&n0_state_ts_seq1_r0_n1=n0_state_ts_seq1_r0_n0)|(n0_state_ts_seq1_r0_n2!=INVALID&n0_state_ts_seq1_r0_n2=n0_state_ts_seq1_r0_n0)) ->         (n0_vote_ts_seq1_r0_n0'=QUES_VOTE)                              & (n0_stage_seq1'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=1) & (n0_send_round'=0) & (n0_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq1 assign the state using the proposal from node 1 for seq1 at round0.
    [n0_process_state_assign_vote_seq1_r0_using_n1] n0_stage_seq1=p2s_stage & n0_round_1=0 & n0_send_ready=false & ((n0_state_ts_seq1_r0_n0!=INVALID&n0_state_ts_seq1_r0_n1!=INVALID)|(n0_state_ts_seq1_r0_n0!=INVALID&n0_state_ts_seq1_r0_n2!=INVALID)|(n0_state_ts_seq1_r0_n1!=INVALID&n0_state_ts_seq1_r0_n2!=INVALID)) &  ((n0_state_ts_seq1_r0_n0!=INVALID&n0_state_ts_seq1_r0_n0=n0_state_ts_seq1_r0_n1)|(n0_state_ts_seq1_r0_n2!=INVALID&n0_state_ts_seq1_r0_n2=n0_state_ts_seq1_r0_n1)) ->         (n0_vote_ts_seq1_r0_n0'=n0_state_ts_seq1_r0_n1) & (n0_stage_seq1'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=1) & (n0_send_round'=0) & (n0_send_cmd_ts'=n0_state_ts_seq1_r0_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign QUES_VOTE.
    [n0_process_state_assign_vote_seq1_r0_using_n1] n0_stage_seq1=p2s_stage & n0_round_1=0 & n0_send_ready=false & ((n0_state_ts_seq1_r0_n0!=INVALID&n0_state_ts_seq1_r0_n1!=INVALID)|(n0_state_ts_seq1_r0_n0!=INVALID&n0_state_ts_seq1_r0_n2!=INVALID)|(n0_state_ts_seq1_r0_n1!=INVALID&n0_state_ts_seq1_r0_n2!=INVALID)) & !((n0_state_ts_seq1_r0_n0!=INVALID&n0_state_ts_seq1_r0_n0=n0_state_ts_seq1_r0_n1)|(n0_state_ts_seq1_r0_n2!=INVALID&n0_state_ts_seq1_r0_n2=n0_state_ts_seq1_r0_n1)) ->         (n0_vote_ts_seq1_r0_n0'=QUES_VOTE)                              & (n0_stage_seq1'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=1) & (n0_send_round'=0) & (n0_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq1 assign the state using the proposal from node 2 for seq1 at round0.
    [n0_process_state_assign_vote_seq1_r0_using_n2] n0_stage_seq1=p2s_stage & n0_round_1=0 & n0_send_ready=false & ((n0_state_ts_seq1_r0_n0!=INVALID&n0_state_ts_seq1_r0_n1!=INVALID)|(n0_state_ts_seq1_r0_n0!=INVALID&n0_state_ts_seq1_r0_n2!=INVALID)|(n0_state_ts_seq1_r0_n1!=INVALID&n0_state_ts_seq1_r0_n2!=INVALID)) &  ((n0_state_ts_seq1_r0_n0!=INVALID&n0_state_ts_seq1_r0_n0=n0_state_ts_seq1_r0_n2)|(n0_state_ts_seq1_r0_n1!=INVALID&n0_state_ts_seq1_r0_n1=n0_state_ts_seq1_r0_n2)) ->         (n0_vote_ts_seq1_r0_n0'=n0_state_ts_seq1_r0_n2) & (n0_stage_seq1'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=1) & (n0_send_round'=0) & (n0_send_cmd_ts'=n0_state_ts_seq1_r0_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign QUES_VOTE.
    [n0_process_state_assign_vote_seq1_r0_using_n2] n0_stage_seq1=p2s_stage & n0_round_1=0 & n0_send_ready=false & ((n0_state_ts_seq1_r0_n0!=INVALID&n0_state_ts_seq1_r0_n1!=INVALID)|(n0_state_ts_seq1_r0_n0!=INVALID&n0_state_ts_seq1_r0_n2!=INVALID)|(n0_state_ts_seq1_r0_n1!=INVALID&n0_state_ts_seq1_r0_n2!=INVALID)) & !((n0_state_ts_seq1_r0_n0!=INVALID&n0_state_ts_seq1_r0_n0=n0_state_ts_seq1_r0_n2)|(n0_state_ts_seq1_r0_n1!=INVALID&n0_state_ts_seq1_r0_n1=n0_state_ts_seq1_r0_n2)) ->         (n0_vote_ts_seq1_r0_n0'=QUES_VOTE)                              & (n0_stage_seq1'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=1) & (n0_send_round'=0) & (n0_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq1 assign the state using the proposal from node 0 for seq1 at round1.
    [n0_process_state_assign_vote_seq1_r1_using_n0] n0_stage_seq1=p2s_stage & n0_round_1=1 & n0_send_ready=false & ((n0_state_ts_seq1_r1_n0!=INVALID&n0_state_ts_seq1_r1_n1!=INVALID)|(n0_state_ts_seq1_r1_n0!=INVALID&n0_state_ts_seq1_r1_n2!=INVALID)|(n0_state_ts_seq1_r1_n1!=INVALID&n0_state_ts_seq1_r1_n2!=INVALID)) &  ((n0_state_ts_seq1_r1_n1!=INVALID&n0_state_ts_seq1_r1_n1=n0_state_ts_seq1_r1_n0)|(n0_state_ts_seq1_r1_n2!=INVALID&n0_state_ts_seq1_r1_n2=n0_state_ts_seq1_r1_n0)) ->         (n0_vote_ts_seq1_r1_n0'=n0_state_ts_seq1_r1_n0) & (n0_stage_seq1'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=1) & (n0_send_round'=1) & (n0_send_cmd_ts'=n0_state_ts_seq1_r1_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign QUES_VOTE.
    [n0_process_state_assign_vote_seq1_r1_using_n0] n0_stage_seq1=p2s_stage & n0_round_1=1 & n0_send_ready=false & ((n0_state_ts_seq1_r1_n0!=INVALID&n0_state_ts_seq1_r1_n1!=INVALID)|(n0_state_ts_seq1_r1_n0!=INVALID&n0_state_ts_seq1_r1_n2!=INVALID)|(n0_state_ts_seq1_r1_n1!=INVALID&n0_state_ts_seq1_r1_n2!=INVALID)) & !((n0_state_ts_seq1_r1_n1!=INVALID&n0_state_ts_seq1_r1_n1=n0_state_ts_seq1_r1_n0)|(n0_state_ts_seq1_r1_n2!=INVALID&n0_state_ts_seq1_r1_n2=n0_state_ts_seq1_r1_n0)) ->         (n0_vote_ts_seq1_r1_n0'=QUES_VOTE)                              & (n0_stage_seq1'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=1) & (n0_send_round'=1) & (n0_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq1 assign the state using the proposal from node 1 for seq1 at round1.
    [n0_process_state_assign_vote_seq1_r1_using_n1] n0_stage_seq1=p2s_stage & n0_round_1=1 & n0_send_ready=false & ((n0_state_ts_seq1_r1_n0!=INVALID&n0_state_ts_seq1_r1_n1!=INVALID)|(n0_state_ts_seq1_r1_n0!=INVALID&n0_state_ts_seq1_r1_n2!=INVALID)|(n0_state_ts_seq1_r1_n1!=INVALID&n0_state_ts_seq1_r1_n2!=INVALID)) &  ((n0_state_ts_seq1_r1_n0!=INVALID&n0_state_ts_seq1_r1_n0=n0_state_ts_seq1_r1_n1)|(n0_state_ts_seq1_r1_n2!=INVALID&n0_state_ts_seq1_r1_n2=n0_state_ts_seq1_r1_n1)) ->         (n0_vote_ts_seq1_r1_n0'=n0_state_ts_seq1_r1_n1) & (n0_stage_seq1'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=1) & (n0_send_round'=1) & (n0_send_cmd_ts'=n0_state_ts_seq1_r1_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign QUES_VOTE.
    [n0_process_state_assign_vote_seq1_r1_using_n1] n0_stage_seq1=p2s_stage & n0_round_1=1 & n0_send_ready=false & ((n0_state_ts_seq1_r1_n0!=INVALID&n0_state_ts_seq1_r1_n1!=INVALID)|(n0_state_ts_seq1_r1_n0!=INVALID&n0_state_ts_seq1_r1_n2!=INVALID)|(n0_state_ts_seq1_r1_n1!=INVALID&n0_state_ts_seq1_r1_n2!=INVALID)) & !((n0_state_ts_seq1_r1_n0!=INVALID&n0_state_ts_seq1_r1_n0=n0_state_ts_seq1_r1_n1)|(n0_state_ts_seq1_r1_n2!=INVALID&n0_state_ts_seq1_r1_n2=n0_state_ts_seq1_r1_n1)) ->         (n0_vote_ts_seq1_r1_n0'=QUES_VOTE)                              & (n0_stage_seq1'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=1) & (n0_send_round'=1) & (n0_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq1 assign the state using the proposal from node 2 for seq1 at round1.
    [n0_process_state_assign_vote_seq1_r1_using_n2] n0_stage_seq1=p2s_stage & n0_round_1=1 & n0_send_ready=false & ((n0_state_ts_seq1_r1_n0!=INVALID&n0_state_ts_seq1_r1_n1!=INVALID)|(n0_state_ts_seq1_r1_n0!=INVALID&n0_state_ts_seq1_r1_n2!=INVALID)|(n0_state_ts_seq1_r1_n1!=INVALID&n0_state_ts_seq1_r1_n2!=INVALID)) &  ((n0_state_ts_seq1_r1_n0!=INVALID&n0_state_ts_seq1_r1_n0=n0_state_ts_seq1_r1_n2)|(n0_state_ts_seq1_r1_n1!=INVALID&n0_state_ts_seq1_r1_n1=n0_state_ts_seq1_r1_n2)) ->         (n0_vote_ts_seq1_r1_n0'=n0_state_ts_seq1_r1_n2) & (n0_stage_seq1'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=1) & (n0_send_round'=1) & (n0_send_cmd_ts'=n0_state_ts_seq1_r1_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign QUES_VOTE.
    [n0_process_state_assign_vote_seq1_r1_using_n2] n0_stage_seq1=p2s_stage & n0_round_1=1 & n0_send_ready=false & ((n0_state_ts_seq1_r1_n0!=INVALID&n0_state_ts_seq1_r1_n1!=INVALID)|(n0_state_ts_seq1_r1_n0!=INVALID&n0_state_ts_seq1_r1_n2!=INVALID)|(n0_state_ts_seq1_r1_n1!=INVALID&n0_state_ts_seq1_r1_n2!=INVALID)) & !((n0_state_ts_seq1_r1_n0!=INVALID&n0_state_ts_seq1_r1_n0=n0_state_ts_seq1_r1_n2)|(n0_state_ts_seq1_r1_n1!=INVALID&n0_state_ts_seq1_r1_n1=n0_state_ts_seq1_r1_n2)) ->         (n0_vote_ts_seq1_r1_n0'=QUES_VOTE)                              & (n0_stage_seq1'=p2v_stage) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_vote) & (n0_send_seq'=1) & (n0_send_round'=1) & (n0_send_cmd_ts'=BOT);

    // Process when a Vote pkt is ready.
    // Received an old state for seq0, reply decided.
    [n0_receive_vote_from_old_seq0_reply_decided]   n0_recv_ready=true & n0_recv_type=cmd_vote & n0_recv_seq=0 & (n0_stage_seq0=decided) ->         (n0_recv_ready'=false) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_decided) & (n0_send_seq'=0) & (n0_send_cmd_ts'=n0_log_ts_seq0);
    // Received an old state for seq1, reply decided.
    [n0_receive_vote_from_old_seq1_reply_decided]   n0_recv_ready=true & n0_recv_type=cmd_vote & n0_recv_seq=1 & (n0_stage_seq1=decided) ->         (n0_recv_ready'=false) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_decided) & (n0_send_seq'=1) & (n0_send_cmd_ts'=n0_log_ts_seq1); 
    // Receive the vote from node 0 for non-decided seq0, round0.
    [n0_receive_vote_from_n0_for_seq0_r0] n0_recv_ready=true & n0_recv_from=0 & n0_recv_type=cmd_vote & n0_recv_seq=0 & n0_recv_round=0 & n0_stage_seq0!=decided ->         (n0_recv_ready'=false) & (n0_vote_ts_seq0_r0_n0'=n0_recv_cmd_ts); 
    // Receive the vote from node 1 for non-decided seq0, round0.
    [n0_receive_vote_from_n1_for_seq0_r0] n0_recv_ready=true & n0_recv_from=1 & n0_recv_type=cmd_vote & n0_recv_seq=0 & n0_recv_round=0 & n0_stage_seq0!=decided ->         (n0_recv_ready'=false) & (n0_vote_ts_seq0_r0_n1'=n0_recv_cmd_ts); 
    // Receive the vote from node 2 for non-decided seq0, round0.
    [n0_receive_vote_from_n2_for_seq0_r0] n0_recv_ready=true & n0_recv_from=2 & n0_recv_type=cmd_vote & n0_recv_seq=0 & n0_recv_round=0 & n0_stage_seq0!=decided ->         (n0_recv_ready'=false) & (n0_vote_ts_seq0_r0_n2'=n0_recv_cmd_ts); 
    // Receive the vote from node 0 for non-decided seq0, round1.
    [n0_receive_vote_from_n0_for_seq0_r1] n0_recv_ready=true & n0_recv_from=0 & n0_recv_type=cmd_vote & n0_recv_seq=0 & n0_recv_round=1 & n0_stage_seq0!=decided ->         (n0_recv_ready'=false) & (n0_vote_ts_seq0_r1_n0'=n0_recv_cmd_ts); 
    // Receive the vote from node 1 for non-decided seq0, round1.
    [n0_receive_vote_from_n1_for_seq0_r1] n0_recv_ready=true & n0_recv_from=1 & n0_recv_type=cmd_vote & n0_recv_seq=0 & n0_recv_round=1 & n0_stage_seq0!=decided ->         (n0_recv_ready'=false) & (n0_vote_ts_seq0_r1_n1'=n0_recv_cmd_ts); 
    // Receive the vote from node 2 for non-decided seq0, round1.
    [n0_receive_vote_from_n2_for_seq0_r1] n0_recv_ready=true & n0_recv_from=2 & n0_recv_type=cmd_vote & n0_recv_seq=0 & n0_recv_round=1 & n0_stage_seq0!=decided ->         (n0_recv_ready'=false) & (n0_vote_ts_seq0_r1_n2'=n0_recv_cmd_ts); 
    // Receive the vote from node 0 for non-decided seq1, round0.
    [n0_receive_vote_from_n0_for_seq1_r0] n0_recv_ready=true & n0_recv_from=0 & n0_recv_type=cmd_vote & n0_recv_seq=1 & n0_recv_round=0 & n0_stage_seq1!=decided ->         (n0_recv_ready'=false) & (n0_vote_ts_seq1_r0_n0'=n0_recv_cmd_ts); 
    // Receive the vote from node 1 for non-decided seq1, round0.
    [n0_receive_vote_from_n1_for_seq1_r0] n0_recv_ready=true & n0_recv_from=1 & n0_recv_type=cmd_vote & n0_recv_seq=1 & n0_recv_round=0 & n0_stage_seq1!=decided ->         (n0_recv_ready'=false) & (n0_vote_ts_seq1_r0_n1'=n0_recv_cmd_ts); 
    // Receive the vote from node 2 for non-decided seq1, round0.
    [n0_receive_vote_from_n2_for_seq1_r0] n0_recv_ready=true & n0_recv_from=2 & n0_recv_type=cmd_vote & n0_recv_seq=1 & n0_recv_round=0 & n0_stage_seq1!=decided ->         (n0_recv_ready'=false) & (n0_vote_ts_seq1_r0_n2'=n0_recv_cmd_ts); 
    // Receive the vote from node 0 for non-decided seq1, round1.
    [n0_receive_vote_from_n0_for_seq1_r1] n0_recv_ready=true & n0_recv_from=0 & n0_recv_type=cmd_vote & n0_recv_seq=1 & n0_recv_round=1 & n0_stage_seq1!=decided ->         (n0_recv_ready'=false) & (n0_vote_ts_seq1_r1_n0'=n0_recv_cmd_ts); 
    // Receive the vote from node 1 for non-decided seq1, round1.
    [n0_receive_vote_from_n1_for_seq1_r1] n0_recv_ready=true & n0_recv_from=1 & n0_recv_type=cmd_vote & n0_recv_seq=1 & n0_recv_round=1 & n0_stage_seq1!=decided ->         (n0_recv_ready'=false) & (n0_vote_ts_seq1_r1_n1'=n0_recv_cmd_ts); 
    // Receive the vote from node 2 for non-decided seq1, round1.
    [n0_receive_vote_from_n2_for_seq1_r1] n0_recv_ready=true & n0_recv_from=2 & n0_recv_type=cmd_vote & n0_recv_seq=1 & n0_recv_round=1 & n0_stage_seq1!=decided ->         (n0_recv_ready'=false) & (n0_vote_ts_seq1_r1_n2'=n0_recv_cmd_ts); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 0 for seq0 at round0.
    [n0_process_vote_for_seq0_r0_using_n0] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=0 & (n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n0!=QUES_VOTE) & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n1!=INVALID)|(n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)) & ((n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n1=n0_vote_ts_seq0_r0_n0)|(n0_vote_ts_seq0_r0_n2!=INVALID&n0_vote_ts_seq0_r0_n2=n0_vote_ts_seq0_r0_n0)) ->         (n0_log_ts_seq0'=n0_vote_ts_seq0_r0_n0) & (n0_stage_seq0'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 1 for seq0 at round0.
    [n0_process_vote_for_seq0_r0_using_n1] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=0 & (n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n1!=QUES_VOTE) & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n1!=INVALID)|(n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)) & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n0=n0_vote_ts_seq0_r0_n1)|(n0_vote_ts_seq0_r0_n2!=INVALID&n0_vote_ts_seq0_r0_n2=n0_vote_ts_seq0_r0_n1)) ->         (n0_log_ts_seq0'=n0_vote_ts_seq0_r0_n1) & (n0_stage_seq0'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 2 for seq0 at round0.
    [n0_process_vote_for_seq0_r0_using_n2] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=0 & (n0_vote_ts_seq0_r0_n2!=INVALID&n0_vote_ts_seq0_r0_n2!=QUES_VOTE) & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n1!=INVALID)|(n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)) & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n0=n0_vote_ts_seq0_r0_n2)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n1=n0_vote_ts_seq0_r0_n2)) ->         (n0_log_ts_seq0'=n0_vote_ts_seq0_r0_n2) & (n0_stage_seq0'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 0 for seq0 at round1.
    [n0_process_vote_for_seq0_r1_using_n0] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=1 & (n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n0!=QUES_VOTE) & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n1!=INVALID)|(n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)) & ((n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n1=n0_vote_ts_seq0_r1_n0)|(n0_vote_ts_seq0_r1_n2!=INVALID&n0_vote_ts_seq0_r1_n2=n0_vote_ts_seq0_r1_n0)) ->         (n0_log_ts_seq0'=n0_vote_ts_seq0_r1_n0) & (n0_stage_seq0'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 1 for seq0 at round1.
    [n0_process_vote_for_seq0_r1_using_n1] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=1 & (n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n1!=QUES_VOTE) & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n1!=INVALID)|(n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)) & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n0=n0_vote_ts_seq0_r1_n1)|(n0_vote_ts_seq0_r1_n2!=INVALID&n0_vote_ts_seq0_r1_n2=n0_vote_ts_seq0_r1_n1)) ->         (n0_log_ts_seq0'=n0_vote_ts_seq0_r1_n1) & (n0_stage_seq0'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 2 for seq0 at round1.
    [n0_process_vote_for_seq0_r1_using_n2] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=1 & (n0_vote_ts_seq0_r1_n2!=INVALID&n0_vote_ts_seq0_r1_n2!=QUES_VOTE) & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n1!=INVALID)|(n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)) & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n0=n0_vote_ts_seq0_r1_n2)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n1=n0_vote_ts_seq0_r1_n2)) ->         (n0_log_ts_seq0'=n0_vote_ts_seq0_r1_n2) & (n0_stage_seq0'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 0 for seq1 at round0.
    [n0_process_vote_for_seq1_r0_using_n0] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=0 & (n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n0!=QUES_VOTE) & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n1!=INVALID)|(n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)) & ((n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n1=n0_vote_ts_seq1_r0_n0)|(n0_vote_ts_seq1_r0_n2!=INVALID&n0_vote_ts_seq1_r0_n2=n0_vote_ts_seq1_r0_n0)) ->         (n0_log_ts_seq1'=n0_vote_ts_seq1_r0_n0) & (n0_stage_seq1'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 1 for seq1 at round0.
    [n0_process_vote_for_seq1_r0_using_n1] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=0 & (n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n1!=QUES_VOTE) & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n1!=INVALID)|(n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)) & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n0=n0_vote_ts_seq1_r0_n1)|(n0_vote_ts_seq1_r0_n2!=INVALID&n0_vote_ts_seq1_r0_n2=n0_vote_ts_seq1_r0_n1)) ->         (n0_log_ts_seq1'=n0_vote_ts_seq1_r0_n1) & (n0_stage_seq1'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 2 for seq1 at round0.
    [n0_process_vote_for_seq1_r0_using_n2] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=0 & (n0_vote_ts_seq1_r0_n2!=INVALID&n0_vote_ts_seq1_r0_n2!=QUES_VOTE) & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n1!=INVALID)|(n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)) & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n0=n0_vote_ts_seq1_r0_n2)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n1=n0_vote_ts_seq1_r0_n2)) ->         (n0_log_ts_seq1'=n0_vote_ts_seq1_r0_n2) & (n0_stage_seq1'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 0 for seq1 at round1.
    [n0_process_vote_for_seq1_r1_using_n0] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=1 & (n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n0!=QUES_VOTE) & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n1!=INVALID)|(n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)) & ((n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n1=n0_vote_ts_seq1_r1_n0)|(n0_vote_ts_seq1_r1_n2!=INVALID&n0_vote_ts_seq1_r1_n2=n0_vote_ts_seq1_r1_n0)) ->         (n0_log_ts_seq1'=n0_vote_ts_seq1_r1_n0) & (n0_stage_seq1'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 1 for seq1 at round1.
    [n0_process_vote_for_seq1_r1_using_n1] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=1 & (n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n1!=QUES_VOTE) & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n1!=INVALID)|(n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)) & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n0=n0_vote_ts_seq1_r1_n1)|(n0_vote_ts_seq1_r1_n2!=INVALID&n0_vote_ts_seq1_r1_n2=n0_vote_ts_seq1_r1_n1)) ->         (n0_log_ts_seq1'=n0_vote_ts_seq1_r1_n1) & (n0_stage_seq1'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 2 for seq1 at round1.
    [n0_process_vote_for_seq1_r1_using_n2] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=1 & (n0_vote_ts_seq1_r1_n2!=INVALID&n0_vote_ts_seq1_r1_n2!=QUES_VOTE) & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n1!=INVALID)|(n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)) & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n0=n0_vote_ts_seq1_r1_n2)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n1=n0_vote_ts_seq1_r1_n2)) ->         (n0_log_ts_seq1'=n0_vote_ts_seq1_r1_n2) & (n0_stage_seq1'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 0 for seq0 at round0.
    [n0_process_vote_for_seq0_r0_using_n0] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=0 & n0_round_0+1<MAX_ROUND & (n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n0!=QUES_VOTE) & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n1!=INVALID)|(n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)) & !((n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n1=n0_vote_ts_seq0_r0_n0)|(n0_vote_ts_seq0_r0_n2!=INVALID&n0_vote_ts_seq0_r0_n2=n0_vote_ts_seq0_r0_n0)) ->         (n0_state_ts_seq0_r0_n0'=n0_vote_ts_seq0_r0_n0) & (n0_vote_ts_seq0_r0_n0'=INVALID) & (n0_stage_seq0'=p2s_stage) & (n0_round_0'=n0_round_0+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=0+1) & (n0_send_cmd_ts'=n0_state_ts_seq0_r0_n0);
    //// 2.fail: Out of rounds
    [n0_process_vote_for_seq0_r0_using_n0] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=0 & n0_round_0+1=MAX_ROUND & (n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n0!=QUES_VOTE) & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n1!=INVALID)|(n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)) & !((n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n1=n0_vote_ts_seq0_r0_n0)|(n0_vote_ts_seq0_r0_n2!=INVALID&n0_vote_ts_seq0_r0_n2=n0_vote_ts_seq0_r0_n0)) ->         (n0_log_ts_seq0'=OUT_OF_ROUND) & (n0_stage_seq0'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n0_process_vote_for_seq0_r0_using_n0] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=0 & n0_round_0+1<MAX_ROUND & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n1!=INVALID)|(n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)) & n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n0=QUES_VOTE&n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n1=QUES_VOTE&n0_vote_ts_seq0_r0_n2!=INVALID&n0_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n0_state_ts_seq0_r0_n0'=BOT)                                    & (n0_vote_ts_seq0_r0_n0'=INVALID) & (n0_stage_seq0'=p2s_stage) & (n0_round_0'=n0_round_0+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=0+1) & (n0_send_cmd_ts'=BOT);
    [n0_process_vote_for_seq0_r0_using_n0] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=0 & n0_round_0+1<MAX_ROUND & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n1!=INVALID)|(n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)) & n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n0=QUES_VOTE&n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n1=QUES_VOTE&n0_vote_ts_seq0_r0_n2!=INVALID&n0_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n0_state_ts_seq0_r0_n0'=n0_state_ts_seq0_r0_n0) & (n0_vote_ts_seq0_r0_n0'=INVALID) & (n0_stage_seq0'=p2s_stage) & (n0_round_0'=n0_round_0+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=0+1) & (n0_send_cmd_ts'=n0_state_ts_seq0_r0_n0);
    //// 3.fail: Out of rounds
    [n0_process_vote_for_seq0_r0_using_n0] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=0 & n0_round_0+1=MAX_ROUND & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n1!=INVALID)|(n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)) & n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n0=QUES_VOTE&n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n1=QUES_VOTE&n0_vote_ts_seq0_r0_n2!=INVALID&n0_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n0_log_ts_seq0'=OUT_OF_ROUND) & (n0_stage_seq0'=pre_decided_stage);
    [n0_process_vote_for_seq0_r0_using_n0] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=0 & n0_round_0+1=MAX_ROUND & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n1!=INVALID)|(n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)) & n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n0=QUES_VOTE&n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n1=QUES_VOTE&n0_vote_ts_seq0_r0_n2!=INVALID&n0_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n0_log_ts_seq0'=OUT_OF_ROUND) & (n0_stage_seq0'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 1 for seq0 at round0.
    [n0_process_vote_for_seq0_r0_using_n1] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=0 & n0_round_0+1<MAX_ROUND & (n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n1!=QUES_VOTE) & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n1!=INVALID)|(n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)) & !((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n0=n0_vote_ts_seq0_r0_n1)|(n0_vote_ts_seq0_r0_n2!=INVALID&n0_vote_ts_seq0_r0_n2=n0_vote_ts_seq0_r0_n1)) ->         (n0_state_ts_seq0_r0_n0'=n0_vote_ts_seq0_r0_n1) & (n0_vote_ts_seq0_r0_n0'=INVALID) & (n0_stage_seq0'=p2s_stage) & (n0_round_0'=n0_round_0+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=0+1) & (n0_send_cmd_ts'=n0_state_ts_seq0_r0_n1);
    //// 2.fail: Out of rounds
    [n0_process_vote_for_seq0_r0_using_n1] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=0 & n0_round_0+1=MAX_ROUND & (n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n1!=QUES_VOTE) & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n1!=INVALID)|(n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)) & !((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n0=n0_vote_ts_seq0_r0_n1)|(n0_vote_ts_seq0_r0_n2!=INVALID&n0_vote_ts_seq0_r0_n2=n0_vote_ts_seq0_r0_n1)) ->         (n0_log_ts_seq0'=OUT_OF_ROUND) & (n0_stage_seq0'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n0_process_vote_for_seq0_r0_using_n1] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=0 & n0_round_0+1<MAX_ROUND & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n1!=INVALID)|(n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)) & n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n0=QUES_VOTE&n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n1=QUES_VOTE&n0_vote_ts_seq0_r0_n2!=INVALID&n0_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n0_state_ts_seq0_r0_n0'=BOT)                                    & (n0_vote_ts_seq0_r0_n0'=INVALID) & (n0_stage_seq0'=p2s_stage) & (n0_round_0'=n0_round_0+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=0+1) & (n0_send_cmd_ts'=BOT);
    [n0_process_vote_for_seq0_r0_using_n1] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=0 & n0_round_0+1<MAX_ROUND & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n1!=INVALID)|(n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)) & n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n0=QUES_VOTE&n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n1=QUES_VOTE&n0_vote_ts_seq0_r0_n2!=INVALID&n0_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n0_state_ts_seq0_r0_n0'=n0_state_ts_seq0_r0_n1) & (n0_vote_ts_seq0_r0_n0'=INVALID) & (n0_stage_seq0'=p2s_stage) & (n0_round_0'=n0_round_0+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=0+1) & (n0_send_cmd_ts'=n0_state_ts_seq0_r0_n1);
    //// 3.fail: Out of rounds
    [n0_process_vote_for_seq0_r0_using_n1] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=0 & n0_round_0+1=MAX_ROUND & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n1!=INVALID)|(n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)) & n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n0=QUES_VOTE&n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n1=QUES_VOTE&n0_vote_ts_seq0_r0_n2!=INVALID&n0_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n0_log_ts_seq0'=OUT_OF_ROUND) & (n0_stage_seq0'=pre_decided_stage);
    [n0_process_vote_for_seq0_r0_using_n1] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=0 & n0_round_0+1=MAX_ROUND & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n1!=INVALID)|(n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)) & n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n0=QUES_VOTE&n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n1=QUES_VOTE&n0_vote_ts_seq0_r0_n2!=INVALID&n0_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n0_log_ts_seq0'=OUT_OF_ROUND) & (n0_stage_seq0'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 2 for seq0 at round0.
    [n0_process_vote_for_seq0_r0_using_n2] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=0 & n0_round_0+1<MAX_ROUND & (n0_vote_ts_seq0_r0_n2!=INVALID&n0_vote_ts_seq0_r0_n2!=QUES_VOTE) & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n1!=INVALID)|(n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)) & !((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n0=n0_vote_ts_seq0_r0_n2)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n1=n0_vote_ts_seq0_r0_n2)) ->         (n0_state_ts_seq0_r0_n0'=n0_vote_ts_seq0_r0_n2) & (n0_vote_ts_seq0_r0_n0'=INVALID) & (n0_stage_seq0'=p2s_stage) & (n0_round_0'=n0_round_0+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=0+1) & (n0_send_cmd_ts'=n0_state_ts_seq0_r0_n2);
    //// 2.fail: Out of rounds
    [n0_process_vote_for_seq0_r0_using_n2] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=0 & n0_round_0+1=MAX_ROUND & (n0_vote_ts_seq0_r0_n2!=INVALID&n0_vote_ts_seq0_r0_n2!=QUES_VOTE) & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n1!=INVALID)|(n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)) & !((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n0=n0_vote_ts_seq0_r0_n2)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n1=n0_vote_ts_seq0_r0_n2)) ->         (n0_log_ts_seq0'=OUT_OF_ROUND) & (n0_stage_seq0'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n0_process_vote_for_seq0_r0_using_n2] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=0 & n0_round_0+1<MAX_ROUND & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n1!=INVALID)|(n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)) & n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n0=QUES_VOTE&n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n1=QUES_VOTE&n0_vote_ts_seq0_r0_n2!=INVALID&n0_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n0_state_ts_seq0_r0_n0'=BOT)                                    & (n0_vote_ts_seq0_r0_n0'=INVALID) & (n0_stage_seq0'=p2s_stage) & (n0_round_0'=n0_round_0+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=0+1) & (n0_send_cmd_ts'=BOT);
    [n0_process_vote_for_seq0_r0_using_n2] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=0 & n0_round_0+1<MAX_ROUND & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n1!=INVALID)|(n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)) & n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n0=QUES_VOTE&n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n1=QUES_VOTE&n0_vote_ts_seq0_r0_n2!=INVALID&n0_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n0_state_ts_seq0_r0_n0'=n0_state_ts_seq0_r0_n2) & (n0_vote_ts_seq0_r0_n0'=INVALID) & (n0_stage_seq0'=p2s_stage) & (n0_round_0'=n0_round_0+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=0+1) & (n0_send_cmd_ts'=n0_state_ts_seq0_r0_n2);
    //// 3.fail: Out of rounds
    [n0_process_vote_for_seq0_r0_using_n2] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=0 & n0_round_0+1=MAX_ROUND & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n1!=INVALID)|(n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)) & n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n0=QUES_VOTE&n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n1=QUES_VOTE&n0_vote_ts_seq0_r0_n2!=INVALID&n0_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n0_log_ts_seq0'=OUT_OF_ROUND) & (n0_stage_seq0'=pre_decided_stage);
    [n0_process_vote_for_seq0_r0_using_n2] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=0 & n0_round_0+1=MAX_ROUND & ((n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n1!=INVALID)|(n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)|(n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n2!=INVALID)) & n0_vote_ts_seq0_r0_n0!=INVALID&n0_vote_ts_seq0_r0_n0=QUES_VOTE&n0_vote_ts_seq0_r0_n1!=INVALID&n0_vote_ts_seq0_r0_n1=QUES_VOTE&n0_vote_ts_seq0_r0_n2!=INVALID&n0_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n0_log_ts_seq0'=OUT_OF_ROUND) & (n0_stage_seq0'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 0 for seq0 at round1.
    [n0_process_vote_for_seq0_r1_using_n0] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=1 & n0_round_0+1<MAX_ROUND & (n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n0!=QUES_VOTE) & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n1!=INVALID)|(n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)) & !((n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n1=n0_vote_ts_seq0_r1_n0)|(n0_vote_ts_seq0_r1_n2!=INVALID&n0_vote_ts_seq0_r1_n2=n0_vote_ts_seq0_r1_n0)) ->         (n0_state_ts_seq0_r1_n0'=n0_vote_ts_seq0_r1_n0) & (n0_vote_ts_seq0_r1_n0'=INVALID) & (n0_stage_seq0'=p2s_stage) & (n0_round_0'=n0_round_0+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=1+1) & (n0_send_cmd_ts'=n0_state_ts_seq0_r1_n0);
    //// 2.fail: Out of rounds
    [n0_process_vote_for_seq0_r1_using_n0] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=1 & n0_round_0+1=MAX_ROUND & (n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n0!=QUES_VOTE) & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n1!=INVALID)|(n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)) & !((n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n1=n0_vote_ts_seq0_r1_n0)|(n0_vote_ts_seq0_r1_n2!=INVALID&n0_vote_ts_seq0_r1_n2=n0_vote_ts_seq0_r1_n0)) ->         (n0_log_ts_seq0'=OUT_OF_ROUND) & (n0_stage_seq0'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n0_process_vote_for_seq0_r1_using_n0] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=1 & n0_round_0+1<MAX_ROUND & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n1!=INVALID)|(n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)) & n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n0=QUES_VOTE&n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n1=QUES_VOTE&n0_vote_ts_seq0_r1_n2!=INVALID&n0_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n0_state_ts_seq0_r1_n0'=BOT)                                    & (n0_vote_ts_seq0_r1_n0'=INVALID) & (n0_stage_seq0'=p2s_stage) & (n0_round_0'=n0_round_0+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=1+1) & (n0_send_cmd_ts'=BOT);
    [n0_process_vote_for_seq0_r1_using_n0] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=1 & n0_round_0+1<MAX_ROUND & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n1!=INVALID)|(n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)) & n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n0=QUES_VOTE&n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n1=QUES_VOTE&n0_vote_ts_seq0_r1_n2!=INVALID&n0_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n0_state_ts_seq0_r1_n0'=n0_state_ts_seq0_r1_n0) & (n0_vote_ts_seq0_r1_n0'=INVALID) & (n0_stage_seq0'=p2s_stage) & (n0_round_0'=n0_round_0+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=1+1) & (n0_send_cmd_ts'=n0_state_ts_seq0_r1_n0);
    //// 3.fail: Out of rounds
    [n0_process_vote_for_seq0_r1_using_n0] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=1 & n0_round_0+1=MAX_ROUND & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n1!=INVALID)|(n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)) & n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n0=QUES_VOTE&n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n1=QUES_VOTE&n0_vote_ts_seq0_r1_n2!=INVALID&n0_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n0_log_ts_seq0'=OUT_OF_ROUND) & (n0_stage_seq0'=pre_decided_stage);
    [n0_process_vote_for_seq0_r1_using_n0] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=1 & n0_round_0+1=MAX_ROUND & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n1!=INVALID)|(n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)) & n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n0=QUES_VOTE&n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n1=QUES_VOTE&n0_vote_ts_seq0_r1_n2!=INVALID&n0_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n0_log_ts_seq0'=OUT_OF_ROUND) & (n0_stage_seq0'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 1 for seq0 at round1.
    [n0_process_vote_for_seq0_r1_using_n1] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=1 & n0_round_0+1<MAX_ROUND & (n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n1!=QUES_VOTE) & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n1!=INVALID)|(n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)) & !((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n0=n0_vote_ts_seq0_r1_n1)|(n0_vote_ts_seq0_r1_n2!=INVALID&n0_vote_ts_seq0_r1_n2=n0_vote_ts_seq0_r1_n1)) ->         (n0_state_ts_seq0_r1_n0'=n0_vote_ts_seq0_r1_n1) & (n0_vote_ts_seq0_r1_n0'=INVALID) & (n0_stage_seq0'=p2s_stage) & (n0_round_0'=n0_round_0+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=1+1) & (n0_send_cmd_ts'=n0_state_ts_seq0_r1_n1);
    //// 2.fail: Out of rounds
    [n0_process_vote_for_seq0_r1_using_n1] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=1 & n0_round_0+1=MAX_ROUND & (n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n1!=QUES_VOTE) & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n1!=INVALID)|(n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)) & !((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n0=n0_vote_ts_seq0_r1_n1)|(n0_vote_ts_seq0_r1_n2!=INVALID&n0_vote_ts_seq0_r1_n2=n0_vote_ts_seq0_r1_n1)) ->         (n0_log_ts_seq0'=OUT_OF_ROUND) & (n0_stage_seq0'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n0_process_vote_for_seq0_r1_using_n1] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=1 & n0_round_0+1<MAX_ROUND & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n1!=INVALID)|(n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)) & n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n0=QUES_VOTE&n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n1=QUES_VOTE&n0_vote_ts_seq0_r1_n2!=INVALID&n0_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n0_state_ts_seq0_r1_n0'=BOT)                                    & (n0_vote_ts_seq0_r1_n0'=INVALID) & (n0_stage_seq0'=p2s_stage) & (n0_round_0'=n0_round_0+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=1+1) & (n0_send_cmd_ts'=BOT);
    [n0_process_vote_for_seq0_r1_using_n1] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=1 & n0_round_0+1<MAX_ROUND & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n1!=INVALID)|(n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)) & n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n0=QUES_VOTE&n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n1=QUES_VOTE&n0_vote_ts_seq0_r1_n2!=INVALID&n0_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n0_state_ts_seq0_r1_n0'=n0_state_ts_seq0_r1_n1) & (n0_vote_ts_seq0_r1_n0'=INVALID) & (n0_stage_seq0'=p2s_stage) & (n0_round_0'=n0_round_0+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=1+1) & (n0_send_cmd_ts'=n0_state_ts_seq0_r1_n1);
    //// 3.fail: Out of rounds
    [n0_process_vote_for_seq0_r1_using_n1] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=1 & n0_round_0+1=MAX_ROUND & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n1!=INVALID)|(n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)) & n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n0=QUES_VOTE&n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n1=QUES_VOTE&n0_vote_ts_seq0_r1_n2!=INVALID&n0_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n0_log_ts_seq0'=OUT_OF_ROUND) & (n0_stage_seq0'=pre_decided_stage);
    [n0_process_vote_for_seq0_r1_using_n1] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=1 & n0_round_0+1=MAX_ROUND & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n1!=INVALID)|(n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)) & n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n0=QUES_VOTE&n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n1=QUES_VOTE&n0_vote_ts_seq0_r1_n2!=INVALID&n0_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n0_log_ts_seq0'=OUT_OF_ROUND) & (n0_stage_seq0'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 2 for seq0 at round1.
    [n0_process_vote_for_seq0_r1_using_n2] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=1 & n0_round_0+1<MAX_ROUND & (n0_vote_ts_seq0_r1_n2!=INVALID&n0_vote_ts_seq0_r1_n2!=QUES_VOTE) & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n1!=INVALID)|(n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)) & !((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n0=n0_vote_ts_seq0_r1_n2)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n1=n0_vote_ts_seq0_r1_n2)) ->         (n0_state_ts_seq0_r1_n0'=n0_vote_ts_seq0_r1_n2) & (n0_vote_ts_seq0_r1_n0'=INVALID) & (n0_stage_seq0'=p2s_stage) & (n0_round_0'=n0_round_0+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=1+1) & (n0_send_cmd_ts'=n0_state_ts_seq0_r1_n2);
    //// 2.fail: Out of rounds
    [n0_process_vote_for_seq0_r1_using_n2] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=1 & n0_round_0+1=MAX_ROUND & (n0_vote_ts_seq0_r1_n2!=INVALID&n0_vote_ts_seq0_r1_n2!=QUES_VOTE) & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n1!=INVALID)|(n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)) & !((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n0=n0_vote_ts_seq0_r1_n2)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n1=n0_vote_ts_seq0_r1_n2)) ->         (n0_log_ts_seq0'=OUT_OF_ROUND) & (n0_stage_seq0'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n0_process_vote_for_seq0_r1_using_n2] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=1 & n0_round_0+1<MAX_ROUND & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n1!=INVALID)|(n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)) & n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n0=QUES_VOTE&n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n1=QUES_VOTE&n0_vote_ts_seq0_r1_n2!=INVALID&n0_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n0_state_ts_seq0_r1_n0'=BOT)                                    & (n0_vote_ts_seq0_r1_n0'=INVALID) & (n0_stage_seq0'=p2s_stage) & (n0_round_0'=n0_round_0+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=1+1) & (n0_send_cmd_ts'=BOT);
    [n0_process_vote_for_seq0_r1_using_n2] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=1 & n0_round_0+1<MAX_ROUND & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n1!=INVALID)|(n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)) & n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n0=QUES_VOTE&n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n1=QUES_VOTE&n0_vote_ts_seq0_r1_n2!=INVALID&n0_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n0_state_ts_seq0_r1_n0'=n0_state_ts_seq0_r1_n2) & (n0_vote_ts_seq0_r1_n0'=INVALID) & (n0_stage_seq0'=p2s_stage) & (n0_round_0'=n0_round_0+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=0) & (n0_send_round'=1+1) & (n0_send_cmd_ts'=n0_state_ts_seq0_r1_n2);
    //// 3.fail: Out of rounds
    [n0_process_vote_for_seq0_r1_using_n2] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=1 & n0_round_0+1=MAX_ROUND & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n1!=INVALID)|(n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)) & n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n0=QUES_VOTE&n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n1=QUES_VOTE&n0_vote_ts_seq0_r1_n2!=INVALID&n0_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n0_log_ts_seq0'=OUT_OF_ROUND) & (n0_stage_seq0'=pre_decided_stage);
    [n0_process_vote_for_seq0_r1_using_n2] n0_stage_seq0=p2v_stage & n0_send_ready=false & n0_round_0=1 & n0_round_0+1=MAX_ROUND & ((n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n1!=INVALID)|(n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)|(n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n2!=INVALID)) & n0_vote_ts_seq0_r1_n0!=INVALID&n0_vote_ts_seq0_r1_n0=QUES_VOTE&n0_vote_ts_seq0_r1_n1!=INVALID&n0_vote_ts_seq0_r1_n1=QUES_VOTE&n0_vote_ts_seq0_r1_n2!=INVALID&n0_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n0_log_ts_seq0'=OUT_OF_ROUND) & (n0_stage_seq0'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 0 for seq1 at round0.
    [n0_process_vote_for_seq1_r0_using_n0] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=0 & n0_round_1+1<MAX_ROUND & (n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n0!=QUES_VOTE) & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n1!=INVALID)|(n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)) & !((n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n1=n0_vote_ts_seq1_r0_n0)|(n0_vote_ts_seq1_r0_n2!=INVALID&n0_vote_ts_seq1_r0_n2=n0_vote_ts_seq1_r0_n0)) ->         (n0_state_ts_seq1_r0_n0'=n0_vote_ts_seq1_r0_n0) & (n0_vote_ts_seq1_r0_n0'=INVALID) & (n0_stage_seq1'=p2s_stage) & (n0_round_1'=n0_round_1+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=0+1) & (n0_send_cmd_ts'=n0_state_ts_seq1_r0_n0);
    //// 2.fail: Out of rounds
    [n0_process_vote_for_seq1_r0_using_n0] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=0 & n0_round_1+1=MAX_ROUND & (n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n0!=QUES_VOTE) & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n1!=INVALID)|(n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)) & !((n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n1=n0_vote_ts_seq1_r0_n0)|(n0_vote_ts_seq1_r0_n2!=INVALID&n0_vote_ts_seq1_r0_n2=n0_vote_ts_seq1_r0_n0)) ->         (n0_log_ts_seq1'=OUT_OF_ROUND) & (n0_stage_seq1'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n0_process_vote_for_seq1_r0_using_n0] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=0 & n0_round_1+1<MAX_ROUND & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n1!=INVALID)|(n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)) & n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n0=QUES_VOTE&n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n1=QUES_VOTE&n0_vote_ts_seq1_r0_n2!=INVALID&n0_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n0_state_ts_seq1_r0_n0'=BOT)                                    & (n0_vote_ts_seq1_r0_n0'=INVALID) & (n0_stage_seq1'=p2s_stage) & (n0_round_1'=n0_round_1+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=0+1) & (n0_send_cmd_ts'=BOT);
    [n0_process_vote_for_seq1_r0_using_n0] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=0 & n0_round_1+1<MAX_ROUND & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n1!=INVALID)|(n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)) & n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n0=QUES_VOTE&n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n1=QUES_VOTE&n0_vote_ts_seq1_r0_n2!=INVALID&n0_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n0_state_ts_seq1_r0_n0'=n0_state_ts_seq1_r0_n0) & (n0_vote_ts_seq1_r0_n0'=INVALID) & (n0_stage_seq1'=p2s_stage) & (n0_round_1'=n0_round_1+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=0+1) & (n0_send_cmd_ts'=n0_state_ts_seq1_r0_n0);
    //// 3.fail: Out of rounds
    [n0_process_vote_for_seq1_r0_using_n0] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=0 & n0_round_1+1=MAX_ROUND & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n1!=INVALID)|(n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)) & n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n0=QUES_VOTE&n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n1=QUES_VOTE&n0_vote_ts_seq1_r0_n2!=INVALID&n0_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n0_log_ts_seq1'=OUT_OF_ROUND) & (n0_stage_seq1'=pre_decided_stage);
    [n0_process_vote_for_seq1_r0_using_n0] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=0 & n0_round_1+1=MAX_ROUND & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n1!=INVALID)|(n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)) & n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n0=QUES_VOTE&n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n1=QUES_VOTE&n0_vote_ts_seq1_r0_n2!=INVALID&n0_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n0_log_ts_seq1'=OUT_OF_ROUND) & (n0_stage_seq1'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 1 for seq1 at round0.
    [n0_process_vote_for_seq1_r0_using_n1] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=0 & n0_round_1+1<MAX_ROUND & (n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n1!=QUES_VOTE) & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n1!=INVALID)|(n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)) & !((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n0=n0_vote_ts_seq1_r0_n1)|(n0_vote_ts_seq1_r0_n2!=INVALID&n0_vote_ts_seq1_r0_n2=n0_vote_ts_seq1_r0_n1)) ->         (n0_state_ts_seq1_r0_n0'=n0_vote_ts_seq1_r0_n1) & (n0_vote_ts_seq1_r0_n0'=INVALID) & (n0_stage_seq1'=p2s_stage) & (n0_round_1'=n0_round_1+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=0+1) & (n0_send_cmd_ts'=n0_state_ts_seq1_r0_n1);
    //// 2.fail: Out of rounds
    [n0_process_vote_for_seq1_r0_using_n1] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=0 & n0_round_1+1=MAX_ROUND & (n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n1!=QUES_VOTE) & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n1!=INVALID)|(n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)) & !((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n0=n0_vote_ts_seq1_r0_n1)|(n0_vote_ts_seq1_r0_n2!=INVALID&n0_vote_ts_seq1_r0_n2=n0_vote_ts_seq1_r0_n1)) ->         (n0_log_ts_seq1'=OUT_OF_ROUND) & (n0_stage_seq1'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n0_process_vote_for_seq1_r0_using_n1] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=0 & n0_round_1+1<MAX_ROUND & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n1!=INVALID)|(n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)) & n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n0=QUES_VOTE&n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n1=QUES_VOTE&n0_vote_ts_seq1_r0_n2!=INVALID&n0_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n0_state_ts_seq1_r0_n0'=BOT)                                    & (n0_vote_ts_seq1_r0_n0'=INVALID) & (n0_stage_seq1'=p2s_stage) & (n0_round_1'=n0_round_1+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=0+1) & (n0_send_cmd_ts'=BOT);
    [n0_process_vote_for_seq1_r0_using_n1] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=0 & n0_round_1+1<MAX_ROUND & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n1!=INVALID)|(n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)) & n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n0=QUES_VOTE&n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n1=QUES_VOTE&n0_vote_ts_seq1_r0_n2!=INVALID&n0_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n0_state_ts_seq1_r0_n0'=n0_state_ts_seq1_r0_n1) & (n0_vote_ts_seq1_r0_n0'=INVALID) & (n0_stage_seq1'=p2s_stage) & (n0_round_1'=n0_round_1+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=0+1) & (n0_send_cmd_ts'=n0_state_ts_seq1_r0_n1);
    //// 3.fail: Out of rounds
    [n0_process_vote_for_seq1_r0_using_n1] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=0 & n0_round_1+1=MAX_ROUND & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n1!=INVALID)|(n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)) & n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n0=QUES_VOTE&n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n1=QUES_VOTE&n0_vote_ts_seq1_r0_n2!=INVALID&n0_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n0_log_ts_seq1'=OUT_OF_ROUND) & (n0_stage_seq1'=pre_decided_stage);
    [n0_process_vote_for_seq1_r0_using_n1] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=0 & n0_round_1+1=MAX_ROUND & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n1!=INVALID)|(n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)) & n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n0=QUES_VOTE&n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n1=QUES_VOTE&n0_vote_ts_seq1_r0_n2!=INVALID&n0_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n0_log_ts_seq1'=OUT_OF_ROUND) & (n0_stage_seq1'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 2 for seq1 at round0.
    [n0_process_vote_for_seq1_r0_using_n2] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=0 & n0_round_1+1<MAX_ROUND & (n0_vote_ts_seq1_r0_n2!=INVALID&n0_vote_ts_seq1_r0_n2!=QUES_VOTE) & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n1!=INVALID)|(n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)) & !((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n0=n0_vote_ts_seq1_r0_n2)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n1=n0_vote_ts_seq1_r0_n2)) ->         (n0_state_ts_seq1_r0_n0'=n0_vote_ts_seq1_r0_n2) & (n0_vote_ts_seq1_r0_n0'=INVALID) & (n0_stage_seq1'=p2s_stage) & (n0_round_1'=n0_round_1+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=0+1) & (n0_send_cmd_ts'=n0_state_ts_seq1_r0_n2);
    //// 2.fail: Out of rounds
    [n0_process_vote_for_seq1_r0_using_n2] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=0 & n0_round_1+1=MAX_ROUND & (n0_vote_ts_seq1_r0_n2!=INVALID&n0_vote_ts_seq1_r0_n2!=QUES_VOTE) & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n1!=INVALID)|(n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)) & !((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n0=n0_vote_ts_seq1_r0_n2)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n1=n0_vote_ts_seq1_r0_n2)) ->         (n0_log_ts_seq1'=OUT_OF_ROUND) & (n0_stage_seq1'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n0_process_vote_for_seq1_r0_using_n2] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=0 & n0_round_1+1<MAX_ROUND & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n1!=INVALID)|(n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)) & n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n0=QUES_VOTE&n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n1=QUES_VOTE&n0_vote_ts_seq1_r0_n2!=INVALID&n0_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n0_state_ts_seq1_r0_n0'=BOT)                                    & (n0_vote_ts_seq1_r0_n0'=INVALID) & (n0_stage_seq1'=p2s_stage) & (n0_round_1'=n0_round_1+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=0+1) & (n0_send_cmd_ts'=BOT);
    [n0_process_vote_for_seq1_r0_using_n2] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=0 & n0_round_1+1<MAX_ROUND & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n1!=INVALID)|(n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)) & n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n0=QUES_VOTE&n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n1=QUES_VOTE&n0_vote_ts_seq1_r0_n2!=INVALID&n0_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n0_state_ts_seq1_r0_n0'=n0_state_ts_seq1_r0_n2) & (n0_vote_ts_seq1_r0_n0'=INVALID) & (n0_stage_seq1'=p2s_stage) & (n0_round_1'=n0_round_1+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=0+1) & (n0_send_cmd_ts'=n0_state_ts_seq1_r0_n2);
    //// 3.fail: Out of rounds
    [n0_process_vote_for_seq1_r0_using_n2] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=0 & n0_round_1+1=MAX_ROUND & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n1!=INVALID)|(n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)) & n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n0=QUES_VOTE&n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n1=QUES_VOTE&n0_vote_ts_seq1_r0_n2!=INVALID&n0_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n0_log_ts_seq1'=OUT_OF_ROUND) & (n0_stage_seq1'=pre_decided_stage);
    [n0_process_vote_for_seq1_r0_using_n2] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=0 & n0_round_1+1=MAX_ROUND & ((n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n1!=INVALID)|(n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)|(n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n2!=INVALID)) & n0_vote_ts_seq1_r0_n0!=INVALID&n0_vote_ts_seq1_r0_n0=QUES_VOTE&n0_vote_ts_seq1_r0_n1!=INVALID&n0_vote_ts_seq1_r0_n1=QUES_VOTE&n0_vote_ts_seq1_r0_n2!=INVALID&n0_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n0_log_ts_seq1'=OUT_OF_ROUND) & (n0_stage_seq1'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 0 for seq1 at round1.
    [n0_process_vote_for_seq1_r1_using_n0] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=1 & n0_round_1+1<MAX_ROUND & (n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n0!=QUES_VOTE) & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n1!=INVALID)|(n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)) & !((n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n1=n0_vote_ts_seq1_r1_n0)|(n0_vote_ts_seq1_r1_n2!=INVALID&n0_vote_ts_seq1_r1_n2=n0_vote_ts_seq1_r1_n0)) ->         (n0_state_ts_seq1_r1_n0'=n0_vote_ts_seq1_r1_n0) & (n0_vote_ts_seq1_r1_n0'=INVALID) & (n0_stage_seq1'=p2s_stage) & (n0_round_1'=n0_round_1+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=1+1) & (n0_send_cmd_ts'=n0_state_ts_seq1_r1_n0);
    //// 2.fail: Out of rounds
    [n0_process_vote_for_seq1_r1_using_n0] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=1 & n0_round_1+1=MAX_ROUND & (n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n0!=QUES_VOTE) & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n1!=INVALID)|(n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)) & !((n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n1=n0_vote_ts_seq1_r1_n0)|(n0_vote_ts_seq1_r1_n2!=INVALID&n0_vote_ts_seq1_r1_n2=n0_vote_ts_seq1_r1_n0)) ->         (n0_log_ts_seq1'=OUT_OF_ROUND) & (n0_stage_seq1'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n0_process_vote_for_seq1_r1_using_n0] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=1 & n0_round_1+1<MAX_ROUND & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n1!=INVALID)|(n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)) & n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n0=QUES_VOTE&n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n1=QUES_VOTE&n0_vote_ts_seq1_r1_n2!=INVALID&n0_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n0_state_ts_seq1_r1_n0'=BOT)                                    & (n0_vote_ts_seq1_r1_n0'=INVALID) & (n0_stage_seq1'=p2s_stage) & (n0_round_1'=n0_round_1+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=1+1) & (n0_send_cmd_ts'=BOT);
    [n0_process_vote_for_seq1_r1_using_n0] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=1 & n0_round_1+1<MAX_ROUND & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n1!=INVALID)|(n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)) & n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n0=QUES_VOTE&n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n1=QUES_VOTE&n0_vote_ts_seq1_r1_n2!=INVALID&n0_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n0_state_ts_seq1_r1_n0'=n0_state_ts_seq1_r1_n0) & (n0_vote_ts_seq1_r1_n0'=INVALID) & (n0_stage_seq1'=p2s_stage) & (n0_round_1'=n0_round_1+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=1+1) & (n0_send_cmd_ts'=n0_state_ts_seq1_r1_n0);
    //// 3.fail: Out of rounds
    [n0_process_vote_for_seq1_r1_using_n0] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=1 & n0_round_1+1=MAX_ROUND & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n1!=INVALID)|(n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)) & n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n0=QUES_VOTE&n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n1=QUES_VOTE&n0_vote_ts_seq1_r1_n2!=INVALID&n0_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n0_log_ts_seq1'=OUT_OF_ROUND) & (n0_stage_seq1'=pre_decided_stage);
    [n0_process_vote_for_seq1_r1_using_n0] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=1 & n0_round_1+1=MAX_ROUND & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n1!=INVALID)|(n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)) & n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n0=QUES_VOTE&n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n1=QUES_VOTE&n0_vote_ts_seq1_r1_n2!=INVALID&n0_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n0_log_ts_seq1'=OUT_OF_ROUND) & (n0_stage_seq1'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 1 for seq1 at round1.
    [n0_process_vote_for_seq1_r1_using_n1] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=1 & n0_round_1+1<MAX_ROUND & (n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n1!=QUES_VOTE) & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n1!=INVALID)|(n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)) & !((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n0=n0_vote_ts_seq1_r1_n1)|(n0_vote_ts_seq1_r1_n2!=INVALID&n0_vote_ts_seq1_r1_n2=n0_vote_ts_seq1_r1_n1)) ->         (n0_state_ts_seq1_r1_n0'=n0_vote_ts_seq1_r1_n1) & (n0_vote_ts_seq1_r1_n0'=INVALID) & (n0_stage_seq1'=p2s_stage) & (n0_round_1'=n0_round_1+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=1+1) & (n0_send_cmd_ts'=n0_state_ts_seq1_r1_n1);
    //// 2.fail: Out of rounds
    [n0_process_vote_for_seq1_r1_using_n1] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=1 & n0_round_1+1=MAX_ROUND & (n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n1!=QUES_VOTE) & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n1!=INVALID)|(n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)) & !((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n0=n0_vote_ts_seq1_r1_n1)|(n0_vote_ts_seq1_r1_n2!=INVALID&n0_vote_ts_seq1_r1_n2=n0_vote_ts_seq1_r1_n1)) ->         (n0_log_ts_seq1'=OUT_OF_ROUND) & (n0_stage_seq1'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n0_process_vote_for_seq1_r1_using_n1] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=1 & n0_round_1+1<MAX_ROUND & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n1!=INVALID)|(n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)) & n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n0=QUES_VOTE&n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n1=QUES_VOTE&n0_vote_ts_seq1_r1_n2!=INVALID&n0_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n0_state_ts_seq1_r1_n0'=BOT)                                    & (n0_vote_ts_seq1_r1_n0'=INVALID) & (n0_stage_seq1'=p2s_stage) & (n0_round_1'=n0_round_1+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=1+1) & (n0_send_cmd_ts'=BOT);
    [n0_process_vote_for_seq1_r1_using_n1] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=1 & n0_round_1+1<MAX_ROUND & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n1!=INVALID)|(n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)) & n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n0=QUES_VOTE&n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n1=QUES_VOTE&n0_vote_ts_seq1_r1_n2!=INVALID&n0_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n0_state_ts_seq1_r1_n0'=n0_state_ts_seq1_r1_n1) & (n0_vote_ts_seq1_r1_n0'=INVALID) & (n0_stage_seq1'=p2s_stage) & (n0_round_1'=n0_round_1+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=1+1) & (n0_send_cmd_ts'=n0_state_ts_seq1_r1_n1);
    //// 3.fail: Out of rounds
    [n0_process_vote_for_seq1_r1_using_n1] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=1 & n0_round_1+1=MAX_ROUND & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n1!=INVALID)|(n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)) & n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n0=QUES_VOTE&n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n1=QUES_VOTE&n0_vote_ts_seq1_r1_n2!=INVALID&n0_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n0_log_ts_seq1'=OUT_OF_ROUND) & (n0_stage_seq1'=pre_decided_stage);
    [n0_process_vote_for_seq1_r1_using_n1] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=1 & n0_round_1+1=MAX_ROUND & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n1!=INVALID)|(n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)) & n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n0=QUES_VOTE&n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n1=QUES_VOTE&n0_vote_ts_seq1_r1_n2!=INVALID&n0_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n0_log_ts_seq1'=OUT_OF_ROUND) & (n0_stage_seq1'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 2 for seq1 at round1.
    [n0_process_vote_for_seq1_r1_using_n2] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=1 & n0_round_1+1<MAX_ROUND & (n0_vote_ts_seq1_r1_n2!=INVALID&n0_vote_ts_seq1_r1_n2!=QUES_VOTE) & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n1!=INVALID)|(n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)) & !((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n0=n0_vote_ts_seq1_r1_n2)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n1=n0_vote_ts_seq1_r1_n2)) ->         (n0_state_ts_seq1_r1_n0'=n0_vote_ts_seq1_r1_n2) & (n0_vote_ts_seq1_r1_n0'=INVALID) & (n0_stage_seq1'=p2s_stage) & (n0_round_1'=n0_round_1+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=1+1) & (n0_send_cmd_ts'=n0_state_ts_seq1_r1_n2);
    //// 2.fail: Out of rounds
    [n0_process_vote_for_seq1_r1_using_n2] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=1 & n0_round_1+1=MAX_ROUND & (n0_vote_ts_seq1_r1_n2!=INVALID&n0_vote_ts_seq1_r1_n2!=QUES_VOTE) & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n1!=INVALID)|(n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)) & !((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n0=n0_vote_ts_seq1_r1_n2)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n1=n0_vote_ts_seq1_r1_n2)) ->         (n0_log_ts_seq1'=OUT_OF_ROUND) & (n0_stage_seq1'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n0_process_vote_for_seq1_r1_using_n2] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=1 & n0_round_1+1<MAX_ROUND & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n1!=INVALID)|(n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)) & n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n0=QUES_VOTE&n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n1=QUES_VOTE&n0_vote_ts_seq1_r1_n2!=INVALID&n0_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n0_state_ts_seq1_r1_n0'=BOT)                                    & (n0_vote_ts_seq1_r1_n0'=INVALID) & (n0_stage_seq1'=p2s_stage) & (n0_round_1'=n0_round_1+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=1+1) & (n0_send_cmd_ts'=BOT);
    [n0_process_vote_for_seq1_r1_using_n2] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=1 & n0_round_1+1<MAX_ROUND & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n1!=INVALID)|(n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)) & n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n0=QUES_VOTE&n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n1=QUES_VOTE&n0_vote_ts_seq1_r1_n2!=INVALID&n0_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n0_state_ts_seq1_r1_n0'=n0_state_ts_seq1_r1_n2) & (n0_vote_ts_seq1_r1_n0'=INVALID) & (n0_stage_seq1'=p2s_stage) & (n0_round_1'=n0_round_1+1) & (n0_send_ready'=true) & (n0_send_is_broadcast'=true) & (n0_send_type'=cmd_state) & (n0_send_seq'=1) & (n0_send_round'=1+1) & (n0_send_cmd_ts'=n0_state_ts_seq1_r1_n2);
    //// 3.fail: Out of rounds
    [n0_process_vote_for_seq1_r1_using_n2] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=1 & n0_round_1+1=MAX_ROUND & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n1!=INVALID)|(n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)) & n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n0=QUES_VOTE&n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n1=QUES_VOTE&n0_vote_ts_seq1_r1_n2!=INVALID&n0_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n0_log_ts_seq1'=OUT_OF_ROUND) & (n0_stage_seq1'=pre_decided_stage);
    [n0_process_vote_for_seq1_r1_using_n2] n0_stage_seq1=p2v_stage & n0_send_ready=false & n0_round_1=1 & n0_round_1+1=MAX_ROUND & ((n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n1!=INVALID)|(n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)|(n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n2!=INVALID)) & n0_vote_ts_seq1_r1_n0!=INVALID&n0_vote_ts_seq1_r1_n0=QUES_VOTE&n0_vote_ts_seq1_r1_n1!=INVALID&n0_vote_ts_seq1_r1_n1=QUES_VOTE&n0_vote_ts_seq1_r1_n2!=INVALID&n0_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n0_log_ts_seq1'=OUT_OF_ROUND) & (n0_stage_seq1'=pre_decided_stage);

    // Pre-decided 
    // Success case, directly go to decided 
    [n0_pre_decided_stage_seq0] n0_stage_seq0=pre_decided_stage & n0_log_ts_seq0!=OUT_OF_ROUND & n0_seq+1<LOG_SIZE -> (n0_stage_seq0'=decided) & (n0_seq'=n0_seq+1);
    [n0_pre_decided_stage_seq0] n0_stage_seq0=pre_decided_stage & n0_log_ts_seq0!=OUT_OF_ROUND & n0_seq+1=LOG_SIZE -> (n0_stage_seq0'=decided);
    // Success case, directly go to decided 
    [n0_pre_decided_stage_seq1] n0_stage_seq1=pre_decided_stage & n0_log_ts_seq1!=OUT_OF_ROUND & n0_seq+1<LOG_SIZE -> (n0_stage_seq1'=decided) & (n0_seq'=n0_seq+1);
    [n0_pre_decided_stage_seq1] n0_stage_seq1=pre_decided_stage & n0_log_ts_seq1!=OUT_OF_ROUND & n0_seq+1=LOG_SIZE -> (n0_stage_seq1'=decided);
    // Failed case, put my proposal back to q0
    [n0_pre_decided_stage_seq0_using_q0] n0_stage_seq0=pre_decided_stage & n0_log_ts_seq0=OUT_OF_ROUND & n0_pq_valid_0=false & n0_seq+1<LOG_SIZE -> (n0_stage_seq0'=decided) & (n0_pq_valid_0'=true) & (n0_pq_ts_0'=n0_proposal_seq0_r0_n0) & (n0_seq'=n0_seq+1);
    [n0_pre_decided_stage_seq0_using_q0] n0_stage_seq0=pre_decided_stage & n0_log_ts_seq0=OUT_OF_ROUND & n0_pq_valid_0=false & n0_seq+1=LOG_SIZE -> (n0_stage_seq0'=decided) & (n0_pq_valid_0'=true) & (n0_pq_ts_0'=n0_proposal_seq0_r0_n0);
    // Failed case, put my proposal back to q1
    [n0_pre_decided_stage_seq0_using_q1] n0_stage_seq0=pre_decided_stage & n0_log_ts_seq0=OUT_OF_ROUND & n0_pq_valid_1=false & n0_seq+1<LOG_SIZE -> (n0_stage_seq0'=decided) & (n0_pq_valid_1'=true) & (n0_pq_ts_1'=n0_proposal_seq0_r0_n0) & (n0_seq'=n0_seq+1);
    [n0_pre_decided_stage_seq0_using_q1] n0_stage_seq0=pre_decided_stage & n0_log_ts_seq0=OUT_OF_ROUND & n0_pq_valid_1=false & n0_seq+1=LOG_SIZE -> (n0_stage_seq0'=decided) & (n0_pq_valid_1'=true) & (n0_pq_ts_1'=n0_proposal_seq0_r0_n0);
    // Failed case, put my proposal back to q0
    [n0_pre_decided_stage_seq1_using_q0] n0_stage_seq1=pre_decided_stage & n0_log_ts_seq1=OUT_OF_ROUND & n0_pq_valid_0=false & n0_seq+1<LOG_SIZE -> (n0_stage_seq1'=decided) & (n0_pq_valid_0'=true) & (n0_pq_ts_0'=n0_proposal_seq1_r0_n0) & (n0_seq'=n0_seq+1);
    [n0_pre_decided_stage_seq1_using_q0] n0_stage_seq1=pre_decided_stage & n0_log_ts_seq1=OUT_OF_ROUND & n0_pq_valid_0=false & n0_seq+1=LOG_SIZE -> (n0_stage_seq1'=decided) & (n0_pq_valid_0'=true) & (n0_pq_ts_0'=n0_proposal_seq1_r0_n0);
    // Failed case, put my proposal back to q1
    [n0_pre_decided_stage_seq1_using_q1] n0_stage_seq1=pre_decided_stage & n0_log_ts_seq1=OUT_OF_ROUND & n0_pq_valid_1=false & n0_seq+1<LOG_SIZE -> (n0_stage_seq1'=decided) & (n0_pq_valid_1'=true) & (n0_pq_ts_1'=n0_proposal_seq1_r0_n0) & (n0_seq'=n0_seq+1);
    [n0_pre_decided_stage_seq1_using_q1] n0_stage_seq1=pre_decided_stage & n0_log_ts_seq1=OUT_OF_ROUND & n0_pq_valid_1=false & n0_seq+1=LOG_SIZE -> (n0_stage_seq1'=decided) & (n0_pq_valid_1'=true) & (n0_pq_ts_1'=n0_proposal_seq1_r0_n0);
                                                                                                                                                                                                                                                                           
    // Receive and process_decided
    [n0_receive_and_process_decided_for_seq0] n0_recv_ready=true & n0_recv_type=cmd_decided & n0_recv_seq=0 & n0_stage_seq0!=decided & n0_seq+1<LOG_SIZE -> (n0_recv_ready'=false) & (n0_log_ts_seq0'=n0_recv_cmd_ts) & (n0_stage_seq0'=decided) & (n0_seq'=n0_seq+1);
    [n0_receive_and_process_decided_for_seq0] n0_recv_ready=true & n0_recv_type=cmd_decided & n0_recv_seq=0 & n0_stage_seq0!=decided & n0_seq+1=LOG_SIZE -> (n0_recv_ready'=false) & (n0_log_ts_seq0'=n0_recv_cmd_ts) & (n0_stage_seq0'=decided);
    [n0_receive_and_process_decided_for_seq0] n0_recv_ready=true & n0_recv_type=cmd_decided & n0_recv_seq=0 & n0_stage_seq0=decided  -> (n0_recv_ready'=false);
                                                                                                                                                                                                                                                                           
    // Receive and process_decided
    [n0_receive_and_process_decided_for_seq1] n0_recv_ready=true & n0_recv_type=cmd_decided & n0_recv_seq=1 & n0_stage_seq1!=decided & n0_seq+1<LOG_SIZE -> (n0_recv_ready'=false) & (n0_log_ts_seq1'=n0_recv_cmd_ts) & (n0_stage_seq1'=decided) & (n0_seq'=n0_seq+1);
    [n0_receive_and_process_decided_for_seq1] n0_recv_ready=true & n0_recv_type=cmd_decided & n0_recv_seq=1 & n0_stage_seq1!=decided & n0_seq+1=LOG_SIZE -> (n0_recv_ready'=false) & (n0_log_ts_seq1'=n0_recv_cmd_ts) & (n0_stage_seq1'=decided);
    [n0_receive_and_process_decided_for_seq1] n0_recv_ready=true & n0_recv_type=cmd_decided & n0_recv_seq=1 & n0_stage_seq1=decided  -> (n0_recv_ready'=false);

    // Send when a pkt is ready; Recv when a pkt is ready.
    [recv_10_0] n0_recv_ready=false ->         (n0_recv_ready'=true) & (n0_recv_from'=1) & (n0_recv_type'=w10_pkt_type_0) & (n0_recv_seq'=w10_pkt_seq_0) & (n0_recv_round'=w10_pkt_round_0) & (n0_recv_cmd_ts'=w10_pkt_cmd_ts_0);
    [send_01_0] n0_send_ready=true & n0_send_is_broadcast=false -> (n0_send_ready'=false);
    [recv_20_0] n0_recv_ready=false ->         (n0_recv_ready'=true) & (n0_recv_from'=2) & (n0_recv_type'=w20_pkt_type_0) & (n0_recv_seq'=w20_pkt_seq_0) & (n0_recv_round'=w20_pkt_round_0) & (n0_recv_cmd_ts'=w20_pkt_cmd_ts_0);
    [send_02_0] n0_send_ready=true & n0_send_is_broadcast=false -> (n0_send_ready'=false);
    [recv_10_1] n0_recv_ready=false ->         (n0_recv_ready'=true) & (n0_recv_from'=1) & (n0_recv_type'=w10_pkt_type_1) & (n0_recv_seq'=w10_pkt_seq_1) & (n0_recv_round'=w10_pkt_round_1) & (n0_recv_cmd_ts'=w10_pkt_cmd_ts_1);
    [send_01_1] n0_send_ready=true & n0_send_is_broadcast=false -> (n0_send_ready'=false);
    [recv_20_1] n0_recv_ready=false ->         (n0_recv_ready'=true) & (n0_recv_from'=2) & (n0_recv_type'=w20_pkt_type_1) & (n0_recv_seq'=w20_pkt_seq_1) & (n0_recv_round'=w20_pkt_round_1) & (n0_recv_cmd_ts'=w20_pkt_cmd_ts_1);
    [send_02_1] n0_send_ready=true & n0_send_is_broadcast=false -> (n0_send_ready'=false);
    [n0_send_broadcast] n0_send_ready=true & n0_send_is_broadcast=true -> (n0_send_ready'=false);

endmodule


module node1
    // states
    n1_seq : [0..LOG_SIZE] init 0;
    /// p1 stage
    n1_pq_valid_0 : bool init true;
    n1_pq_ts_0 : [MIN_TS_VALUE..MAX_TS] init 1;
    n1_pq_valid_1 : bool init false;
    n1_pq_ts_1 : [MIN_TS_VALUE..MAX_TS] init 0;
    n1_stage_seq0 : [0..NUM_STATES] init p0_bc_cmd_stage;
    n1_log_ts_seq0 : [MIN_TS_VALUE..MAX_TS] init INVALID; 
    n1_stage_seq1 : [0..NUM_STATES] init p0_bc_cmd_stage;
    n1_log_ts_seq1 : [MIN_TS_VALUE..MAX_TS] init INVALID; 
    /// p2 stage
    n1_round_0 : [0..MAX_ROUND] init 0; 
    n1_round_1 : [0..MAX_ROUND] init 0; 
    n1_proposal_seq0_r0_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_state_ts_seq0_r0_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_vote_ts_seq0_r0_n0 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n1_proposal_seq0_r0_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_state_ts_seq0_r0_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_vote_ts_seq0_r0_n1 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n1_proposal_seq0_r0_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_state_ts_seq0_r0_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_vote_ts_seq0_r0_n2 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n1_proposal_seq0_r1_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_state_ts_seq0_r1_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_vote_ts_seq0_r1_n0 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n1_proposal_seq0_r1_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_state_ts_seq0_r1_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_vote_ts_seq0_r1_n1 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n1_proposal_seq0_r1_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_state_ts_seq0_r1_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_vote_ts_seq0_r1_n2 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n1_proposal_seq1_r0_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_state_ts_seq1_r0_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_vote_ts_seq1_r0_n0 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n1_proposal_seq1_r0_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_state_ts_seq1_r0_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_vote_ts_seq1_r0_n1 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n1_proposal_seq1_r0_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_state_ts_seq1_r0_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_vote_ts_seq1_r0_n2 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n1_proposal_seq1_r1_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_state_ts_seq1_r1_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_vote_ts_seq1_r1_n0 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n1_proposal_seq1_r1_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_state_ts_seq1_r1_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_vote_ts_seq1_r1_n1 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n1_proposal_seq1_r1_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_state_ts_seq1_r1_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n1_vote_ts_seq1_r1_n2 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;

    // pkt to send
    n1_send_ready : bool init false; // ready means not yet sent
    n1_send_is_broadcast : bool init false;
    n1_send_type : [0..NUM_CMD_TYPES] init 0;
    n1_send_seq : [0..LOG_SIZE] init 0;
    n1_send_round : [0..MAX_ROUND] init 0;
    n1_send_cmd_ts : [MIN_TS_VALUE..MAX_TS] init 0;

    // pkt received
    n1_recv_ready : bool init false; // ready means received
    n1_recv_from : [0..NUM_NODES] init 0;
    n1_recv_type : [0..NUM_CMD_TYPES] init 0;
    n1_recv_seq : [0..LOG_SIZE] init 0;
    n1_recv_round : [0..MAX_ROUND] init 0;
    n1_recv_cmd_ts : [MIN_TS_VALUE..MAX_TS] init 0;
    
    // Try on each queue slot and execute if the slot has min ts
    [n1_propose_next_command_for_seq0_using_q0] n1_stage_seq0=p0_bc_cmd_stage & n1_send_ready=false & n1_seq=0 & n1_pq_valid_0=true & (!n1_pq_valid_0|n1_pq_ts_0>=n1_pq_ts_0)&(!n1_pq_valid_1|n1_pq_ts_1>=n1_pq_ts_0) ->         (n1_stage_seq0'=p1_stage) & (n1_round_0'=0) & (n1_proposal_seq0_r0_n1'=n1_pq_ts_0) & (n1_pq_valid_0'=false) & (n1_pq_ts_0'=0) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_proposal) & (n1_send_seq'=0) & (n1_send_round'=0) & (n1_send_cmd_ts'=n1_pq_ts_0);
    [n1_propose_next_command_for_seq1_using_q0] n1_stage_seq1=p0_bc_cmd_stage & n1_send_ready=false & n1_seq=1 & n1_pq_valid_0=true & (!n1_pq_valid_0|n1_pq_ts_0>=n1_pq_ts_0)&(!n1_pq_valid_1|n1_pq_ts_1>=n1_pq_ts_0) ->         (n1_stage_seq1'=p1_stage) & (n1_round_1'=0) & (n1_proposal_seq1_r0_n1'=n1_pq_ts_0) & (n1_pq_valid_0'=false) & (n1_pq_ts_0'=0) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_proposal) & (n1_send_seq'=1) & (n1_send_round'=0) & (n1_send_cmd_ts'=n1_pq_ts_0);
    [n1_propose_next_command_for_seq0_using_q1] n1_stage_seq0=p0_bc_cmd_stage & n1_send_ready=false & n1_seq=0 & n1_pq_valid_1=true & (!n1_pq_valid_0|n1_pq_ts_0>=n1_pq_ts_1)&(!n1_pq_valid_1|n1_pq_ts_1>=n1_pq_ts_1) ->         (n1_stage_seq0'=p1_stage) & (n1_round_0'=0) & (n1_proposal_seq0_r0_n1'=n1_pq_ts_1) & (n1_pq_valid_1'=false) & (n1_pq_ts_1'=0) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_proposal) & (n1_send_seq'=0) & (n1_send_round'=0) & (n1_send_cmd_ts'=n1_pq_ts_1);
    [n1_propose_next_command_for_seq1_using_q1] n1_stage_seq1=p0_bc_cmd_stage & n1_send_ready=false & n1_seq=1 & n1_pq_valid_1=true & (!n1_pq_valid_0|n1_pq_ts_0>=n1_pq_ts_1)&(!n1_pq_valid_1|n1_pq_ts_1>=n1_pq_ts_1) ->         (n1_stage_seq1'=p1_stage) & (n1_round_1'=0) & (n1_proposal_seq1_r0_n1'=n1_pq_ts_1) & (n1_pq_valid_1'=false) & (n1_pq_ts_1'=0) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_proposal) & (n1_send_seq'=1) & (n1_send_round'=0) & (n1_send_cmd_ts'=n1_pq_ts_1);
    
    // Process when a Proposal pkt is ready.
    // Received an old proposal for seq0, reply decided.
    [n1_receive_proposal_from_old_seq0_reply_decided]   n1_recv_ready=true & n1_recv_type=cmd_proposal & n1_recv_seq=0 & (n1_stage_seq0=decided) ->         (n1_recv_ready'=false) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_decided) & (n1_send_seq'=0) & (n1_send_cmd_ts'=n1_log_ts_seq0);
    // Received an old proposal for seq1, reply decided.
    [n1_receive_proposal_from_old_seq1_reply_decided]   n1_recv_ready=true & n1_recv_type=cmd_proposal & n1_recv_seq=1 & (n1_stage_seq1=decided) ->         (n1_recv_ready'=false) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_decided) & (n1_send_seq'=1) & (n1_send_cmd_ts'=n1_log_ts_seq1); 
    // Receive the proposal from node 0 for non-decided seq0, round0. (TODO: update this, proposal can actually from round0)
    [n1_receive_proposal_from_n0_for_seq0_r0] n1_recv_ready=true & n1_recv_from=0 & n1_recv_type=cmd_proposal & n1_recv_seq=0 & n1_recv_round=0 & (n1_stage_seq0!=decided) ->         (n1_recv_ready'=false) & (n1_proposal_seq0_r0_n0'=n1_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq0, round0. (TODO: update this, proposal can actually from round0)
    [n1_receive_proposal_from_n1_for_seq0_r0] n1_recv_ready=true & n1_recv_from=1 & n1_recv_type=cmd_proposal & n1_recv_seq=0 & n1_recv_round=0 & (n1_stage_seq0!=decided) ->         (n1_recv_ready'=false) & (n1_proposal_seq0_r0_n1'=n1_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq0, round0. (TODO: update this, proposal can actually from round0)
    [n1_receive_proposal_from_n2_for_seq0_r0] n1_recv_ready=true & n1_recv_from=2 & n1_recv_type=cmd_proposal & n1_recv_seq=0 & n1_recv_round=0 & (n1_stage_seq0!=decided) ->         (n1_recv_ready'=false) & (n1_proposal_seq0_r0_n2'=n1_recv_cmd_ts); 
    // Receive the proposal from node 0 for non-decided seq0, round1. (TODO: update this, proposal can actually from round0)
    [n1_receive_proposal_from_n0_for_seq0_r1] n1_recv_ready=true & n1_recv_from=0 & n1_recv_type=cmd_proposal & n1_recv_seq=0 & n1_recv_round=1 & (n1_stage_seq0!=decided) ->         (n1_recv_ready'=false) & (n1_proposal_seq0_r1_n0'=n1_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq0, round1. (TODO: update this, proposal can actually from round0)
    [n1_receive_proposal_from_n1_for_seq0_r1] n1_recv_ready=true & n1_recv_from=1 & n1_recv_type=cmd_proposal & n1_recv_seq=0 & n1_recv_round=1 & (n1_stage_seq0!=decided) ->         (n1_recv_ready'=false) & (n1_proposal_seq0_r1_n1'=n1_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq0, round1. (TODO: update this, proposal can actually from round0)
    [n1_receive_proposal_from_n2_for_seq0_r1] n1_recv_ready=true & n1_recv_from=2 & n1_recv_type=cmd_proposal & n1_recv_seq=0 & n1_recv_round=1 & (n1_stage_seq0!=decided) ->         (n1_recv_ready'=false) & (n1_proposal_seq0_r1_n2'=n1_recv_cmd_ts); 
    // Receive the proposal from node 0 for non-decided seq1, round0. (TODO: update this, proposal can actually from round0)
    [n1_receive_proposal_from_n0_for_seq1_r0] n1_recv_ready=true & n1_recv_from=0 & n1_recv_type=cmd_proposal & n1_recv_seq=1 & n1_recv_round=0 & (n1_stage_seq1!=decided) ->         (n1_recv_ready'=false) & (n1_proposal_seq1_r0_n0'=n1_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq1, round0. (TODO: update this, proposal can actually from round0)
    [n1_receive_proposal_from_n1_for_seq1_r0] n1_recv_ready=true & n1_recv_from=1 & n1_recv_type=cmd_proposal & n1_recv_seq=1 & n1_recv_round=0 & (n1_stage_seq1!=decided) ->         (n1_recv_ready'=false) & (n1_proposal_seq1_r0_n1'=n1_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq1, round0. (TODO: update this, proposal can actually from round0)
    [n1_receive_proposal_from_n2_for_seq1_r0] n1_recv_ready=true & n1_recv_from=2 & n1_recv_type=cmd_proposal & n1_recv_seq=1 & n1_recv_round=0 & (n1_stage_seq1!=decided) ->         (n1_recv_ready'=false) & (n1_proposal_seq1_r0_n2'=n1_recv_cmd_ts); 
    // Receive the proposal from node 0 for non-decided seq1, round1. (TODO: update this, proposal can actually from round0)
    [n1_receive_proposal_from_n0_for_seq1_r1] n1_recv_ready=true & n1_recv_from=0 & n1_recv_type=cmd_proposal & n1_recv_seq=1 & n1_recv_round=1 & (n1_stage_seq1!=decided) ->         (n1_recv_ready'=false) & (n1_proposal_seq1_r1_n0'=n1_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq1, round1. (TODO: update this, proposal can actually from round0)
    [n1_receive_proposal_from_n1_for_seq1_r1] n1_recv_ready=true & n1_recv_from=1 & n1_recv_type=cmd_proposal & n1_recv_seq=1 & n1_recv_round=1 & (n1_stage_seq1!=decided) ->         (n1_recv_ready'=false) & (n1_proposal_seq1_r1_n1'=n1_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq1, round1. (TODO: update this, proposal can actually from round0)
    [n1_receive_proposal_from_n2_for_seq1_r1] n1_recv_ready=true & n1_recv_from=2 & n1_recv_type=cmd_proposal & n1_recv_seq=1 & n1_recv_round=1 & (n1_stage_seq1!=decided) ->         (n1_recv_ready'=false) & (n1_proposal_seq1_r1_n2'=n1_recv_cmd_ts); 

    // 1. When we have enough proposals, assign the state using the proposal from node 0 for seq0 at round0.
    [n1_process_proposal_assign_state_seq0_r0_using_n0] n1_stage_seq0=p1_stage & n1_round_0=0 & n1_send_ready=false & ((n1_proposal_seq0_r0_n0!=INVALID&n1_proposal_seq0_r0_n1!=INVALID)|(n1_proposal_seq0_r0_n0!=INVALID&n1_proposal_seq0_r0_n2!=INVALID)|(n1_proposal_seq0_r0_n1!=INVALID&n1_proposal_seq0_r0_n2!=INVALID)) & ((n1_proposal_seq0_r0_n1!=INVALID&n1_proposal_seq0_r0_n1=n1_proposal_seq0_r0_n0)|(n1_proposal_seq0_r0_n2!=INVALID&n1_proposal_seq0_r0_n2=n1_proposal_seq0_r0_n0)) ->         (n1_state_ts_seq0_r0_n1'=n1_proposal_seq0_r0_n0) & (n1_stage_seq0'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=0) & (n1_send_cmd_ts'=n1_proposal_seq0_r0_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign BOT.
    [n1_process_proposal_assign_state_seq0_r0_using_n0] n1_stage_seq0=p1_stage & n1_round_0=0 & n1_send_ready=false & ((n1_proposal_seq0_r0_n0!=INVALID&n1_proposal_seq0_r0_n1!=INVALID)|(n1_proposal_seq0_r0_n0!=INVALID&n1_proposal_seq0_r0_n2!=INVALID)|(n1_proposal_seq0_r0_n1!=INVALID&n1_proposal_seq0_r0_n2!=INVALID)) & !((n1_proposal_seq0_r0_n1!=INVALID&n1_proposal_seq0_r0_n1=n1_proposal_seq0_r0_n0)|(n1_proposal_seq0_r0_n2!=INVALID&n1_proposal_seq0_r0_n2=n1_proposal_seq0_r0_n0)) ->         (n1_state_ts_seq0_r0_n1'=BOT)                                    & (n1_stage_seq0'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=0) & (n1_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 1 for seq0 at round0.
    [n1_process_proposal_assign_state_seq0_r0_using_n1] n1_stage_seq0=p1_stage & n1_round_0=0 & n1_send_ready=false & ((n1_proposal_seq0_r0_n0!=INVALID&n1_proposal_seq0_r0_n1!=INVALID)|(n1_proposal_seq0_r0_n0!=INVALID&n1_proposal_seq0_r0_n2!=INVALID)|(n1_proposal_seq0_r0_n1!=INVALID&n1_proposal_seq0_r0_n2!=INVALID)) & ((n1_proposal_seq0_r0_n0!=INVALID&n1_proposal_seq0_r0_n0=n1_proposal_seq0_r0_n1)|(n1_proposal_seq0_r0_n2!=INVALID&n1_proposal_seq0_r0_n2=n1_proposal_seq0_r0_n1)) ->         (n1_state_ts_seq0_r0_n1'=n1_proposal_seq0_r0_n1) & (n1_stage_seq0'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=0) & (n1_send_cmd_ts'=n1_proposal_seq0_r0_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign BOT.
    [n1_process_proposal_assign_state_seq0_r0_using_n1] n1_stage_seq0=p1_stage & n1_round_0=0 & n1_send_ready=false & ((n1_proposal_seq0_r0_n0!=INVALID&n1_proposal_seq0_r0_n1!=INVALID)|(n1_proposal_seq0_r0_n0!=INVALID&n1_proposal_seq0_r0_n2!=INVALID)|(n1_proposal_seq0_r0_n1!=INVALID&n1_proposal_seq0_r0_n2!=INVALID)) & !((n1_proposal_seq0_r0_n0!=INVALID&n1_proposal_seq0_r0_n0=n1_proposal_seq0_r0_n1)|(n1_proposal_seq0_r0_n2!=INVALID&n1_proposal_seq0_r0_n2=n1_proposal_seq0_r0_n1)) ->         (n1_state_ts_seq0_r0_n1'=BOT)                                    & (n1_stage_seq0'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=0) & (n1_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 2 for seq0 at round0.
    [n1_process_proposal_assign_state_seq0_r0_using_n2] n1_stage_seq0=p1_stage & n1_round_0=0 & n1_send_ready=false & ((n1_proposal_seq0_r0_n0!=INVALID&n1_proposal_seq0_r0_n1!=INVALID)|(n1_proposal_seq0_r0_n0!=INVALID&n1_proposal_seq0_r0_n2!=INVALID)|(n1_proposal_seq0_r0_n1!=INVALID&n1_proposal_seq0_r0_n2!=INVALID)) & ((n1_proposal_seq0_r0_n0!=INVALID&n1_proposal_seq0_r0_n0=n1_proposal_seq0_r0_n2)|(n1_proposal_seq0_r0_n1!=INVALID&n1_proposal_seq0_r0_n1=n1_proposal_seq0_r0_n2)) ->         (n1_state_ts_seq0_r0_n1'=n1_proposal_seq0_r0_n2) & (n1_stage_seq0'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=0) & (n1_send_cmd_ts'=n1_proposal_seq0_r0_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign BOT.
    [n1_process_proposal_assign_state_seq0_r0_using_n2] n1_stage_seq0=p1_stage & n1_round_0=0 & n1_send_ready=false & ((n1_proposal_seq0_r0_n0!=INVALID&n1_proposal_seq0_r0_n1!=INVALID)|(n1_proposal_seq0_r0_n0!=INVALID&n1_proposal_seq0_r0_n2!=INVALID)|(n1_proposal_seq0_r0_n1!=INVALID&n1_proposal_seq0_r0_n2!=INVALID)) & !((n1_proposal_seq0_r0_n0!=INVALID&n1_proposal_seq0_r0_n0=n1_proposal_seq0_r0_n2)|(n1_proposal_seq0_r0_n1!=INVALID&n1_proposal_seq0_r0_n1=n1_proposal_seq0_r0_n2)) ->         (n1_state_ts_seq0_r0_n1'=BOT)                                    & (n1_stage_seq0'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=0) & (n1_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 0 for seq0 at round1.
    [n1_process_proposal_assign_state_seq0_r1_using_n0] n1_stage_seq0=p1_stage & n1_round_0=1 & n1_send_ready=false & ((n1_proposal_seq0_r1_n0!=INVALID&n1_proposal_seq0_r1_n1!=INVALID)|(n1_proposal_seq0_r1_n0!=INVALID&n1_proposal_seq0_r1_n2!=INVALID)|(n1_proposal_seq0_r1_n1!=INVALID&n1_proposal_seq0_r1_n2!=INVALID)) & ((n1_proposal_seq0_r1_n1!=INVALID&n1_proposal_seq0_r1_n1=n1_proposal_seq0_r1_n0)|(n1_proposal_seq0_r1_n2!=INVALID&n1_proposal_seq0_r1_n2=n1_proposal_seq0_r1_n0)) ->         (n1_state_ts_seq0_r1_n1'=n1_proposal_seq0_r1_n0) & (n1_stage_seq0'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=1) & (n1_send_cmd_ts'=n1_proposal_seq0_r1_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign BOT.
    [n1_process_proposal_assign_state_seq0_r1_using_n0] n1_stage_seq0=p1_stage & n1_round_0=1 & n1_send_ready=false & ((n1_proposal_seq0_r1_n0!=INVALID&n1_proposal_seq0_r1_n1!=INVALID)|(n1_proposal_seq0_r1_n0!=INVALID&n1_proposal_seq0_r1_n2!=INVALID)|(n1_proposal_seq0_r1_n1!=INVALID&n1_proposal_seq0_r1_n2!=INVALID)) & !((n1_proposal_seq0_r1_n1!=INVALID&n1_proposal_seq0_r1_n1=n1_proposal_seq0_r1_n0)|(n1_proposal_seq0_r1_n2!=INVALID&n1_proposal_seq0_r1_n2=n1_proposal_seq0_r1_n0)) ->         (n1_state_ts_seq0_r1_n1'=BOT)                                    & (n1_stage_seq0'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=1) & (n1_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 1 for seq0 at round1.
    [n1_process_proposal_assign_state_seq0_r1_using_n1] n1_stage_seq0=p1_stage & n1_round_0=1 & n1_send_ready=false & ((n1_proposal_seq0_r1_n0!=INVALID&n1_proposal_seq0_r1_n1!=INVALID)|(n1_proposal_seq0_r1_n0!=INVALID&n1_proposal_seq0_r1_n2!=INVALID)|(n1_proposal_seq0_r1_n1!=INVALID&n1_proposal_seq0_r1_n2!=INVALID)) & ((n1_proposal_seq0_r1_n0!=INVALID&n1_proposal_seq0_r1_n0=n1_proposal_seq0_r1_n1)|(n1_proposal_seq0_r1_n2!=INVALID&n1_proposal_seq0_r1_n2=n1_proposal_seq0_r1_n1)) ->         (n1_state_ts_seq0_r1_n1'=n1_proposal_seq0_r1_n1) & (n1_stage_seq0'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=1) & (n1_send_cmd_ts'=n1_proposal_seq0_r1_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign BOT.
    [n1_process_proposal_assign_state_seq0_r1_using_n1] n1_stage_seq0=p1_stage & n1_round_0=1 & n1_send_ready=false & ((n1_proposal_seq0_r1_n0!=INVALID&n1_proposal_seq0_r1_n1!=INVALID)|(n1_proposal_seq0_r1_n0!=INVALID&n1_proposal_seq0_r1_n2!=INVALID)|(n1_proposal_seq0_r1_n1!=INVALID&n1_proposal_seq0_r1_n2!=INVALID)) & !((n1_proposal_seq0_r1_n0!=INVALID&n1_proposal_seq0_r1_n0=n1_proposal_seq0_r1_n1)|(n1_proposal_seq0_r1_n2!=INVALID&n1_proposal_seq0_r1_n2=n1_proposal_seq0_r1_n1)) ->         (n1_state_ts_seq0_r1_n1'=BOT)                                    & (n1_stage_seq0'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=1) & (n1_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 2 for seq0 at round1.
    [n1_process_proposal_assign_state_seq0_r1_using_n2] n1_stage_seq0=p1_stage & n1_round_0=1 & n1_send_ready=false & ((n1_proposal_seq0_r1_n0!=INVALID&n1_proposal_seq0_r1_n1!=INVALID)|(n1_proposal_seq0_r1_n0!=INVALID&n1_proposal_seq0_r1_n2!=INVALID)|(n1_proposal_seq0_r1_n1!=INVALID&n1_proposal_seq0_r1_n2!=INVALID)) & ((n1_proposal_seq0_r1_n0!=INVALID&n1_proposal_seq0_r1_n0=n1_proposal_seq0_r1_n2)|(n1_proposal_seq0_r1_n1!=INVALID&n1_proposal_seq0_r1_n1=n1_proposal_seq0_r1_n2)) ->         (n1_state_ts_seq0_r1_n1'=n1_proposal_seq0_r1_n2) & (n1_stage_seq0'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=1) & (n1_send_cmd_ts'=n1_proposal_seq0_r1_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign BOT.
    [n1_process_proposal_assign_state_seq0_r1_using_n2] n1_stage_seq0=p1_stage & n1_round_0=1 & n1_send_ready=false & ((n1_proposal_seq0_r1_n0!=INVALID&n1_proposal_seq0_r1_n1!=INVALID)|(n1_proposal_seq0_r1_n0!=INVALID&n1_proposal_seq0_r1_n2!=INVALID)|(n1_proposal_seq0_r1_n1!=INVALID&n1_proposal_seq0_r1_n2!=INVALID)) & !((n1_proposal_seq0_r1_n0!=INVALID&n1_proposal_seq0_r1_n0=n1_proposal_seq0_r1_n2)|(n1_proposal_seq0_r1_n1!=INVALID&n1_proposal_seq0_r1_n1=n1_proposal_seq0_r1_n2)) ->         (n1_state_ts_seq0_r1_n1'=BOT)                                    & (n1_stage_seq0'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=1) & (n1_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 0 for seq1 at round0.
    [n1_process_proposal_assign_state_seq1_r0_using_n0] n1_stage_seq1=p1_stage & n1_round_1=0 & n1_send_ready=false & ((n1_proposal_seq1_r0_n0!=INVALID&n1_proposal_seq1_r0_n1!=INVALID)|(n1_proposal_seq1_r0_n0!=INVALID&n1_proposal_seq1_r0_n2!=INVALID)|(n1_proposal_seq1_r0_n1!=INVALID&n1_proposal_seq1_r0_n2!=INVALID)) & ((n1_proposal_seq1_r0_n1!=INVALID&n1_proposal_seq1_r0_n1=n1_proposal_seq1_r0_n0)|(n1_proposal_seq1_r0_n2!=INVALID&n1_proposal_seq1_r0_n2=n1_proposal_seq1_r0_n0)) ->         (n1_state_ts_seq1_r0_n1'=n1_proposal_seq1_r0_n0) & (n1_stage_seq1'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=0) & (n1_send_cmd_ts'=n1_proposal_seq1_r0_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign BOT.
    [n1_process_proposal_assign_state_seq1_r0_using_n0] n1_stage_seq1=p1_stage & n1_round_1=0 & n1_send_ready=false & ((n1_proposal_seq1_r0_n0!=INVALID&n1_proposal_seq1_r0_n1!=INVALID)|(n1_proposal_seq1_r0_n0!=INVALID&n1_proposal_seq1_r0_n2!=INVALID)|(n1_proposal_seq1_r0_n1!=INVALID&n1_proposal_seq1_r0_n2!=INVALID)) & !((n1_proposal_seq1_r0_n1!=INVALID&n1_proposal_seq1_r0_n1=n1_proposal_seq1_r0_n0)|(n1_proposal_seq1_r0_n2!=INVALID&n1_proposal_seq1_r0_n2=n1_proposal_seq1_r0_n0)) ->         (n1_state_ts_seq1_r0_n1'=BOT)                                    & (n1_stage_seq1'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=0) & (n1_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 1 for seq1 at round0.
    [n1_process_proposal_assign_state_seq1_r0_using_n1] n1_stage_seq1=p1_stage & n1_round_1=0 & n1_send_ready=false & ((n1_proposal_seq1_r0_n0!=INVALID&n1_proposal_seq1_r0_n1!=INVALID)|(n1_proposal_seq1_r0_n0!=INVALID&n1_proposal_seq1_r0_n2!=INVALID)|(n1_proposal_seq1_r0_n1!=INVALID&n1_proposal_seq1_r0_n2!=INVALID)) & ((n1_proposal_seq1_r0_n0!=INVALID&n1_proposal_seq1_r0_n0=n1_proposal_seq1_r0_n1)|(n1_proposal_seq1_r0_n2!=INVALID&n1_proposal_seq1_r0_n2=n1_proposal_seq1_r0_n1)) ->         (n1_state_ts_seq1_r0_n1'=n1_proposal_seq1_r0_n1) & (n1_stage_seq1'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=0) & (n1_send_cmd_ts'=n1_proposal_seq1_r0_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign BOT.
    [n1_process_proposal_assign_state_seq1_r0_using_n1] n1_stage_seq1=p1_stage & n1_round_1=0 & n1_send_ready=false & ((n1_proposal_seq1_r0_n0!=INVALID&n1_proposal_seq1_r0_n1!=INVALID)|(n1_proposal_seq1_r0_n0!=INVALID&n1_proposal_seq1_r0_n2!=INVALID)|(n1_proposal_seq1_r0_n1!=INVALID&n1_proposal_seq1_r0_n2!=INVALID)) & !((n1_proposal_seq1_r0_n0!=INVALID&n1_proposal_seq1_r0_n0=n1_proposal_seq1_r0_n1)|(n1_proposal_seq1_r0_n2!=INVALID&n1_proposal_seq1_r0_n2=n1_proposal_seq1_r0_n1)) ->         (n1_state_ts_seq1_r0_n1'=BOT)                                    & (n1_stage_seq1'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=0) & (n1_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 2 for seq1 at round0.
    [n1_process_proposal_assign_state_seq1_r0_using_n2] n1_stage_seq1=p1_stage & n1_round_1=0 & n1_send_ready=false & ((n1_proposal_seq1_r0_n0!=INVALID&n1_proposal_seq1_r0_n1!=INVALID)|(n1_proposal_seq1_r0_n0!=INVALID&n1_proposal_seq1_r0_n2!=INVALID)|(n1_proposal_seq1_r0_n1!=INVALID&n1_proposal_seq1_r0_n2!=INVALID)) & ((n1_proposal_seq1_r0_n0!=INVALID&n1_proposal_seq1_r0_n0=n1_proposal_seq1_r0_n2)|(n1_proposal_seq1_r0_n1!=INVALID&n1_proposal_seq1_r0_n1=n1_proposal_seq1_r0_n2)) ->         (n1_state_ts_seq1_r0_n1'=n1_proposal_seq1_r0_n2) & (n1_stage_seq1'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=0) & (n1_send_cmd_ts'=n1_proposal_seq1_r0_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign BOT.
    [n1_process_proposal_assign_state_seq1_r0_using_n2] n1_stage_seq1=p1_stage & n1_round_1=0 & n1_send_ready=false & ((n1_proposal_seq1_r0_n0!=INVALID&n1_proposal_seq1_r0_n1!=INVALID)|(n1_proposal_seq1_r0_n0!=INVALID&n1_proposal_seq1_r0_n2!=INVALID)|(n1_proposal_seq1_r0_n1!=INVALID&n1_proposal_seq1_r0_n2!=INVALID)) & !((n1_proposal_seq1_r0_n0!=INVALID&n1_proposal_seq1_r0_n0=n1_proposal_seq1_r0_n2)|(n1_proposal_seq1_r0_n1!=INVALID&n1_proposal_seq1_r0_n1=n1_proposal_seq1_r0_n2)) ->         (n1_state_ts_seq1_r0_n1'=BOT)                                    & (n1_stage_seq1'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=0) & (n1_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 0 for seq1 at round1.
    [n1_process_proposal_assign_state_seq1_r1_using_n0] n1_stage_seq1=p1_stage & n1_round_1=1 & n1_send_ready=false & ((n1_proposal_seq1_r1_n0!=INVALID&n1_proposal_seq1_r1_n1!=INVALID)|(n1_proposal_seq1_r1_n0!=INVALID&n1_proposal_seq1_r1_n2!=INVALID)|(n1_proposal_seq1_r1_n1!=INVALID&n1_proposal_seq1_r1_n2!=INVALID)) & ((n1_proposal_seq1_r1_n1!=INVALID&n1_proposal_seq1_r1_n1=n1_proposal_seq1_r1_n0)|(n1_proposal_seq1_r1_n2!=INVALID&n1_proposal_seq1_r1_n2=n1_proposal_seq1_r1_n0)) ->         (n1_state_ts_seq1_r1_n1'=n1_proposal_seq1_r1_n0) & (n1_stage_seq1'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=1) & (n1_send_cmd_ts'=n1_proposal_seq1_r1_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign BOT.
    [n1_process_proposal_assign_state_seq1_r1_using_n0] n1_stage_seq1=p1_stage & n1_round_1=1 & n1_send_ready=false & ((n1_proposal_seq1_r1_n0!=INVALID&n1_proposal_seq1_r1_n1!=INVALID)|(n1_proposal_seq1_r1_n0!=INVALID&n1_proposal_seq1_r1_n2!=INVALID)|(n1_proposal_seq1_r1_n1!=INVALID&n1_proposal_seq1_r1_n2!=INVALID)) & !((n1_proposal_seq1_r1_n1!=INVALID&n1_proposal_seq1_r1_n1=n1_proposal_seq1_r1_n0)|(n1_proposal_seq1_r1_n2!=INVALID&n1_proposal_seq1_r1_n2=n1_proposal_seq1_r1_n0)) ->         (n1_state_ts_seq1_r1_n1'=BOT)                                    & (n1_stage_seq1'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=1) & (n1_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 1 for seq1 at round1.
    [n1_process_proposal_assign_state_seq1_r1_using_n1] n1_stage_seq1=p1_stage & n1_round_1=1 & n1_send_ready=false & ((n1_proposal_seq1_r1_n0!=INVALID&n1_proposal_seq1_r1_n1!=INVALID)|(n1_proposal_seq1_r1_n0!=INVALID&n1_proposal_seq1_r1_n2!=INVALID)|(n1_proposal_seq1_r1_n1!=INVALID&n1_proposal_seq1_r1_n2!=INVALID)) & ((n1_proposal_seq1_r1_n0!=INVALID&n1_proposal_seq1_r1_n0=n1_proposal_seq1_r1_n1)|(n1_proposal_seq1_r1_n2!=INVALID&n1_proposal_seq1_r1_n2=n1_proposal_seq1_r1_n1)) ->         (n1_state_ts_seq1_r1_n1'=n1_proposal_seq1_r1_n1) & (n1_stage_seq1'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=1) & (n1_send_cmd_ts'=n1_proposal_seq1_r1_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign BOT.
    [n1_process_proposal_assign_state_seq1_r1_using_n1] n1_stage_seq1=p1_stage & n1_round_1=1 & n1_send_ready=false & ((n1_proposal_seq1_r1_n0!=INVALID&n1_proposal_seq1_r1_n1!=INVALID)|(n1_proposal_seq1_r1_n0!=INVALID&n1_proposal_seq1_r1_n2!=INVALID)|(n1_proposal_seq1_r1_n1!=INVALID&n1_proposal_seq1_r1_n2!=INVALID)) & !((n1_proposal_seq1_r1_n0!=INVALID&n1_proposal_seq1_r1_n0=n1_proposal_seq1_r1_n1)|(n1_proposal_seq1_r1_n2!=INVALID&n1_proposal_seq1_r1_n2=n1_proposal_seq1_r1_n1)) ->         (n1_state_ts_seq1_r1_n1'=BOT)                                    & (n1_stage_seq1'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=1) & (n1_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 2 for seq1 at round1.
    [n1_process_proposal_assign_state_seq1_r1_using_n2] n1_stage_seq1=p1_stage & n1_round_1=1 & n1_send_ready=false & ((n1_proposal_seq1_r1_n0!=INVALID&n1_proposal_seq1_r1_n1!=INVALID)|(n1_proposal_seq1_r1_n0!=INVALID&n1_proposal_seq1_r1_n2!=INVALID)|(n1_proposal_seq1_r1_n1!=INVALID&n1_proposal_seq1_r1_n2!=INVALID)) & ((n1_proposal_seq1_r1_n0!=INVALID&n1_proposal_seq1_r1_n0=n1_proposal_seq1_r1_n2)|(n1_proposal_seq1_r1_n1!=INVALID&n1_proposal_seq1_r1_n1=n1_proposal_seq1_r1_n2)) ->         (n1_state_ts_seq1_r1_n1'=n1_proposal_seq1_r1_n2) & (n1_stage_seq1'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=1) & (n1_send_cmd_ts'=n1_proposal_seq1_r1_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign BOT.
    [n1_process_proposal_assign_state_seq1_r1_using_n2] n1_stage_seq1=p1_stage & n1_round_1=1 & n1_send_ready=false & ((n1_proposal_seq1_r1_n0!=INVALID&n1_proposal_seq1_r1_n1!=INVALID)|(n1_proposal_seq1_r1_n0!=INVALID&n1_proposal_seq1_r1_n2!=INVALID)|(n1_proposal_seq1_r1_n1!=INVALID&n1_proposal_seq1_r1_n2!=INVALID)) & !((n1_proposal_seq1_r1_n0!=INVALID&n1_proposal_seq1_r1_n0=n1_proposal_seq1_r1_n2)|(n1_proposal_seq1_r1_n1!=INVALID&n1_proposal_seq1_r1_n1=n1_proposal_seq1_r1_n2)) ->         (n1_state_ts_seq1_r1_n1'=BOT)                                    & (n1_stage_seq1'=p2s_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=1) & (n1_send_cmd_ts'=BOT);

        
    // Process when a State pkt is ready.
    // Received an old state for seq0, reply decided.
    [n1_receive_state_from_old_seq0_reply_decided]   n1_recv_ready=true & n1_recv_type=cmd_state & (n1_stage_seq0=decided) & n1_recv_seq=0 ->         (n1_recv_ready'=false) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_decided) & (n1_send_seq'=0) & (n1_send_cmd_ts'=n1_log_ts_seq0);
    // Received an old state for seq1, reply decided.
    [n1_receive_state_from_old_seq1_reply_decided]   n1_recv_ready=true & n1_recv_type=cmd_state & (n1_stage_seq1=decided) & n1_recv_seq=1 ->         (n1_recv_ready'=false) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_decided) & (n1_send_seq'=1) & (n1_send_cmd_ts'=n1_log_ts_seq1); 
    // Receive the proposal from node 0 for non-decided seq0, round0.
    [n1_receive_state_from_n0_for_seq0_r0] n1_recv_ready=true & n1_recv_from=0 & n1_recv_type=cmd_state & n1_recv_seq=0 & n1_recv_round=0 & (n1_stage_seq0!=decided) ->         (n1_recv_ready'=false) & (n1_state_ts_seq0_r0_n0'=n1_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq0, round0.
    [n1_receive_state_from_n1_for_seq0_r0] n1_recv_ready=true & n1_recv_from=1 & n1_recv_type=cmd_state & n1_recv_seq=0 & n1_recv_round=0 & (n1_stage_seq0!=decided) ->         (n1_recv_ready'=false) & (n1_state_ts_seq0_r0_n1'=n1_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq0, round0.
    [n1_receive_state_from_n2_for_seq0_r0] n1_recv_ready=true & n1_recv_from=2 & n1_recv_type=cmd_state & n1_recv_seq=0 & n1_recv_round=0 & (n1_stage_seq0!=decided) ->         (n1_recv_ready'=false) & (n1_state_ts_seq0_r0_n2'=n1_recv_cmd_ts); 
    // Receive the proposal from node 0 for non-decided seq0, round1.
    [n1_receive_state_from_n0_for_seq0_r1] n1_recv_ready=true & n1_recv_from=0 & n1_recv_type=cmd_state & n1_recv_seq=0 & n1_recv_round=1 & (n1_stage_seq0!=decided) ->         (n1_recv_ready'=false) & (n1_state_ts_seq0_r1_n0'=n1_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq0, round1.
    [n1_receive_state_from_n1_for_seq0_r1] n1_recv_ready=true & n1_recv_from=1 & n1_recv_type=cmd_state & n1_recv_seq=0 & n1_recv_round=1 & (n1_stage_seq0!=decided) ->         (n1_recv_ready'=false) & (n1_state_ts_seq0_r1_n1'=n1_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq0, round1.
    [n1_receive_state_from_n2_for_seq0_r1] n1_recv_ready=true & n1_recv_from=2 & n1_recv_type=cmd_state & n1_recv_seq=0 & n1_recv_round=1 & (n1_stage_seq0!=decided) ->         (n1_recv_ready'=false) & (n1_state_ts_seq0_r1_n2'=n1_recv_cmd_ts); 
    // Receive the proposal from node 0 for non-decided seq1, round0.
    [n1_receive_state_from_n0_for_seq1_r0] n1_recv_ready=true & n1_recv_from=0 & n1_recv_type=cmd_state & n1_recv_seq=1 & n1_recv_round=0 & (n1_stage_seq1!=decided) ->         (n1_recv_ready'=false) & (n1_state_ts_seq1_r0_n0'=n1_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq1, round0.
    [n1_receive_state_from_n1_for_seq1_r0] n1_recv_ready=true & n1_recv_from=1 & n1_recv_type=cmd_state & n1_recv_seq=1 & n1_recv_round=0 & (n1_stage_seq1!=decided) ->         (n1_recv_ready'=false) & (n1_state_ts_seq1_r0_n1'=n1_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq1, round0.
    [n1_receive_state_from_n2_for_seq1_r0] n1_recv_ready=true & n1_recv_from=2 & n1_recv_type=cmd_state & n1_recv_seq=1 & n1_recv_round=0 & (n1_stage_seq1!=decided) ->         (n1_recv_ready'=false) & (n1_state_ts_seq1_r0_n2'=n1_recv_cmd_ts); 
    // Receive the proposal from node 0 for non-decided seq1, round1.
    [n1_receive_state_from_n0_for_seq1_r1] n1_recv_ready=true & n1_recv_from=0 & n1_recv_type=cmd_state & n1_recv_seq=1 & n1_recv_round=1 & (n1_stage_seq1!=decided) ->         (n1_recv_ready'=false) & (n1_state_ts_seq1_r1_n0'=n1_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq1, round1.
    [n1_receive_state_from_n1_for_seq1_r1] n1_recv_ready=true & n1_recv_from=1 & n1_recv_type=cmd_state & n1_recv_seq=1 & n1_recv_round=1 & (n1_stage_seq1!=decided) ->         (n1_recv_ready'=false) & (n1_state_ts_seq1_r1_n1'=n1_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq1, round1.
    [n1_receive_state_from_n2_for_seq1_r1] n1_recv_ready=true & n1_recv_from=2 & n1_recv_type=cmd_state & n1_recv_seq=1 & n1_recv_round=1 & (n1_stage_seq1!=decided) ->         (n1_recv_ready'=false) & (n1_state_ts_seq1_r1_n2'=n1_recv_cmd_ts); 

    // 1. When we have enough states, seq0 assign the state using the proposal from node 0 for seq0 at round0.
    [n1_process_state_assign_vote_seq0_r0_using_n0] n1_stage_seq0=p2s_stage & n1_round_0=0 & n1_send_ready=false & ((n1_state_ts_seq0_r0_n0!=INVALID&n1_state_ts_seq0_r0_n1!=INVALID)|(n1_state_ts_seq0_r0_n0!=INVALID&n1_state_ts_seq0_r0_n2!=INVALID)|(n1_state_ts_seq0_r0_n1!=INVALID&n1_state_ts_seq0_r0_n2!=INVALID)) &  ((n1_state_ts_seq0_r0_n1!=INVALID&n1_state_ts_seq0_r0_n1=n1_state_ts_seq0_r0_n0)|(n1_state_ts_seq0_r0_n2!=INVALID&n1_state_ts_seq0_r0_n2=n1_state_ts_seq0_r0_n0)) ->         (n1_vote_ts_seq0_r0_n1'=n1_state_ts_seq0_r0_n0) & (n1_stage_seq0'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=0) & (n1_send_round'=0) & (n1_send_cmd_ts'=n1_state_ts_seq0_r0_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign QUES_VOTE.
    [n1_process_state_assign_vote_seq0_r0_using_n0] n1_stage_seq0=p2s_stage & n1_round_0=0 & n1_send_ready=false & ((n1_state_ts_seq0_r0_n0!=INVALID&n1_state_ts_seq0_r0_n1!=INVALID)|(n1_state_ts_seq0_r0_n0!=INVALID&n1_state_ts_seq0_r0_n2!=INVALID)|(n1_state_ts_seq0_r0_n1!=INVALID&n1_state_ts_seq0_r0_n2!=INVALID)) & !((n1_state_ts_seq0_r0_n1!=INVALID&n1_state_ts_seq0_r0_n1=n1_state_ts_seq0_r0_n0)|(n1_state_ts_seq0_r0_n2!=INVALID&n1_state_ts_seq0_r0_n2=n1_state_ts_seq0_r0_n0)) ->         (n1_vote_ts_seq0_r0_n1'=QUES_VOTE)                              & (n1_stage_seq0'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=0) & (n1_send_round'=0) & (n1_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq0 assign the state using the proposal from node 1 for seq0 at round0.
    [n1_process_state_assign_vote_seq0_r0_using_n1] n1_stage_seq0=p2s_stage & n1_round_0=0 & n1_send_ready=false & ((n1_state_ts_seq0_r0_n0!=INVALID&n1_state_ts_seq0_r0_n1!=INVALID)|(n1_state_ts_seq0_r0_n0!=INVALID&n1_state_ts_seq0_r0_n2!=INVALID)|(n1_state_ts_seq0_r0_n1!=INVALID&n1_state_ts_seq0_r0_n2!=INVALID)) &  ((n1_state_ts_seq0_r0_n0!=INVALID&n1_state_ts_seq0_r0_n0=n1_state_ts_seq0_r0_n1)|(n1_state_ts_seq0_r0_n2!=INVALID&n1_state_ts_seq0_r0_n2=n1_state_ts_seq0_r0_n1)) ->         (n1_vote_ts_seq0_r0_n1'=n1_state_ts_seq0_r0_n1) & (n1_stage_seq0'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=0) & (n1_send_round'=0) & (n1_send_cmd_ts'=n1_state_ts_seq0_r0_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign QUES_VOTE.
    [n1_process_state_assign_vote_seq0_r0_using_n1] n1_stage_seq0=p2s_stage & n1_round_0=0 & n1_send_ready=false & ((n1_state_ts_seq0_r0_n0!=INVALID&n1_state_ts_seq0_r0_n1!=INVALID)|(n1_state_ts_seq0_r0_n0!=INVALID&n1_state_ts_seq0_r0_n2!=INVALID)|(n1_state_ts_seq0_r0_n1!=INVALID&n1_state_ts_seq0_r0_n2!=INVALID)) & !((n1_state_ts_seq0_r0_n0!=INVALID&n1_state_ts_seq0_r0_n0=n1_state_ts_seq0_r0_n1)|(n1_state_ts_seq0_r0_n2!=INVALID&n1_state_ts_seq0_r0_n2=n1_state_ts_seq0_r0_n1)) ->         (n1_vote_ts_seq0_r0_n1'=QUES_VOTE)                              & (n1_stage_seq0'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=0) & (n1_send_round'=0) & (n1_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq0 assign the state using the proposal from node 2 for seq0 at round0.
    [n1_process_state_assign_vote_seq0_r0_using_n2] n1_stage_seq0=p2s_stage & n1_round_0=0 & n1_send_ready=false & ((n1_state_ts_seq0_r0_n0!=INVALID&n1_state_ts_seq0_r0_n1!=INVALID)|(n1_state_ts_seq0_r0_n0!=INVALID&n1_state_ts_seq0_r0_n2!=INVALID)|(n1_state_ts_seq0_r0_n1!=INVALID&n1_state_ts_seq0_r0_n2!=INVALID)) &  ((n1_state_ts_seq0_r0_n0!=INVALID&n1_state_ts_seq0_r0_n0=n1_state_ts_seq0_r0_n2)|(n1_state_ts_seq0_r0_n1!=INVALID&n1_state_ts_seq0_r0_n1=n1_state_ts_seq0_r0_n2)) ->         (n1_vote_ts_seq0_r0_n1'=n1_state_ts_seq0_r0_n2) & (n1_stage_seq0'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=0) & (n1_send_round'=0) & (n1_send_cmd_ts'=n1_state_ts_seq0_r0_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign QUES_VOTE.
    [n1_process_state_assign_vote_seq0_r0_using_n2] n1_stage_seq0=p2s_stage & n1_round_0=0 & n1_send_ready=false & ((n1_state_ts_seq0_r0_n0!=INVALID&n1_state_ts_seq0_r0_n1!=INVALID)|(n1_state_ts_seq0_r0_n0!=INVALID&n1_state_ts_seq0_r0_n2!=INVALID)|(n1_state_ts_seq0_r0_n1!=INVALID&n1_state_ts_seq0_r0_n2!=INVALID)) & !((n1_state_ts_seq0_r0_n0!=INVALID&n1_state_ts_seq0_r0_n0=n1_state_ts_seq0_r0_n2)|(n1_state_ts_seq0_r0_n1!=INVALID&n1_state_ts_seq0_r0_n1=n1_state_ts_seq0_r0_n2)) ->         (n1_vote_ts_seq0_r0_n1'=QUES_VOTE)                              & (n1_stage_seq0'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=0) & (n1_send_round'=0) & (n1_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq0 assign the state using the proposal from node 0 for seq0 at round1.
    [n1_process_state_assign_vote_seq0_r1_using_n0] n1_stage_seq0=p2s_stage & n1_round_0=1 & n1_send_ready=false & ((n1_state_ts_seq0_r1_n0!=INVALID&n1_state_ts_seq0_r1_n1!=INVALID)|(n1_state_ts_seq0_r1_n0!=INVALID&n1_state_ts_seq0_r1_n2!=INVALID)|(n1_state_ts_seq0_r1_n1!=INVALID&n1_state_ts_seq0_r1_n2!=INVALID)) &  ((n1_state_ts_seq0_r1_n1!=INVALID&n1_state_ts_seq0_r1_n1=n1_state_ts_seq0_r1_n0)|(n1_state_ts_seq0_r1_n2!=INVALID&n1_state_ts_seq0_r1_n2=n1_state_ts_seq0_r1_n0)) ->         (n1_vote_ts_seq0_r1_n1'=n1_state_ts_seq0_r1_n0) & (n1_stage_seq0'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=0) & (n1_send_round'=1) & (n1_send_cmd_ts'=n1_state_ts_seq0_r1_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign QUES_VOTE.
    [n1_process_state_assign_vote_seq0_r1_using_n0] n1_stage_seq0=p2s_stage & n1_round_0=1 & n1_send_ready=false & ((n1_state_ts_seq0_r1_n0!=INVALID&n1_state_ts_seq0_r1_n1!=INVALID)|(n1_state_ts_seq0_r1_n0!=INVALID&n1_state_ts_seq0_r1_n2!=INVALID)|(n1_state_ts_seq0_r1_n1!=INVALID&n1_state_ts_seq0_r1_n2!=INVALID)) & !((n1_state_ts_seq0_r1_n1!=INVALID&n1_state_ts_seq0_r1_n1=n1_state_ts_seq0_r1_n0)|(n1_state_ts_seq0_r1_n2!=INVALID&n1_state_ts_seq0_r1_n2=n1_state_ts_seq0_r1_n0)) ->         (n1_vote_ts_seq0_r1_n1'=QUES_VOTE)                              & (n1_stage_seq0'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=0) & (n1_send_round'=1) & (n1_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq0 assign the state using the proposal from node 1 for seq0 at round1.
    [n1_process_state_assign_vote_seq0_r1_using_n1] n1_stage_seq0=p2s_stage & n1_round_0=1 & n1_send_ready=false & ((n1_state_ts_seq0_r1_n0!=INVALID&n1_state_ts_seq0_r1_n1!=INVALID)|(n1_state_ts_seq0_r1_n0!=INVALID&n1_state_ts_seq0_r1_n2!=INVALID)|(n1_state_ts_seq0_r1_n1!=INVALID&n1_state_ts_seq0_r1_n2!=INVALID)) &  ((n1_state_ts_seq0_r1_n0!=INVALID&n1_state_ts_seq0_r1_n0=n1_state_ts_seq0_r1_n1)|(n1_state_ts_seq0_r1_n2!=INVALID&n1_state_ts_seq0_r1_n2=n1_state_ts_seq0_r1_n1)) ->         (n1_vote_ts_seq0_r1_n1'=n1_state_ts_seq0_r1_n1) & (n1_stage_seq0'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=0) & (n1_send_round'=1) & (n1_send_cmd_ts'=n1_state_ts_seq0_r1_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign QUES_VOTE.
    [n1_process_state_assign_vote_seq0_r1_using_n1] n1_stage_seq0=p2s_stage & n1_round_0=1 & n1_send_ready=false & ((n1_state_ts_seq0_r1_n0!=INVALID&n1_state_ts_seq0_r1_n1!=INVALID)|(n1_state_ts_seq0_r1_n0!=INVALID&n1_state_ts_seq0_r1_n2!=INVALID)|(n1_state_ts_seq0_r1_n1!=INVALID&n1_state_ts_seq0_r1_n2!=INVALID)) & !((n1_state_ts_seq0_r1_n0!=INVALID&n1_state_ts_seq0_r1_n0=n1_state_ts_seq0_r1_n1)|(n1_state_ts_seq0_r1_n2!=INVALID&n1_state_ts_seq0_r1_n2=n1_state_ts_seq0_r1_n1)) ->         (n1_vote_ts_seq0_r1_n1'=QUES_VOTE)                              & (n1_stage_seq0'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=0) & (n1_send_round'=1) & (n1_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq0 assign the state using the proposal from node 2 for seq0 at round1.
    [n1_process_state_assign_vote_seq0_r1_using_n2] n1_stage_seq0=p2s_stage & n1_round_0=1 & n1_send_ready=false & ((n1_state_ts_seq0_r1_n0!=INVALID&n1_state_ts_seq0_r1_n1!=INVALID)|(n1_state_ts_seq0_r1_n0!=INVALID&n1_state_ts_seq0_r1_n2!=INVALID)|(n1_state_ts_seq0_r1_n1!=INVALID&n1_state_ts_seq0_r1_n2!=INVALID)) &  ((n1_state_ts_seq0_r1_n0!=INVALID&n1_state_ts_seq0_r1_n0=n1_state_ts_seq0_r1_n2)|(n1_state_ts_seq0_r1_n1!=INVALID&n1_state_ts_seq0_r1_n1=n1_state_ts_seq0_r1_n2)) ->         (n1_vote_ts_seq0_r1_n1'=n1_state_ts_seq0_r1_n2) & (n1_stage_seq0'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=0) & (n1_send_round'=1) & (n1_send_cmd_ts'=n1_state_ts_seq0_r1_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign QUES_VOTE.
    [n1_process_state_assign_vote_seq0_r1_using_n2] n1_stage_seq0=p2s_stage & n1_round_0=1 & n1_send_ready=false & ((n1_state_ts_seq0_r1_n0!=INVALID&n1_state_ts_seq0_r1_n1!=INVALID)|(n1_state_ts_seq0_r1_n0!=INVALID&n1_state_ts_seq0_r1_n2!=INVALID)|(n1_state_ts_seq0_r1_n1!=INVALID&n1_state_ts_seq0_r1_n2!=INVALID)) & !((n1_state_ts_seq0_r1_n0!=INVALID&n1_state_ts_seq0_r1_n0=n1_state_ts_seq0_r1_n2)|(n1_state_ts_seq0_r1_n1!=INVALID&n1_state_ts_seq0_r1_n1=n1_state_ts_seq0_r1_n2)) ->         (n1_vote_ts_seq0_r1_n1'=QUES_VOTE)                              & (n1_stage_seq0'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=0) & (n1_send_round'=1) & (n1_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq1 assign the state using the proposal from node 0 for seq1 at round0.
    [n1_process_state_assign_vote_seq1_r0_using_n0] n1_stage_seq1=p2s_stage & n1_round_1=0 & n1_send_ready=false & ((n1_state_ts_seq1_r0_n0!=INVALID&n1_state_ts_seq1_r0_n1!=INVALID)|(n1_state_ts_seq1_r0_n0!=INVALID&n1_state_ts_seq1_r0_n2!=INVALID)|(n1_state_ts_seq1_r0_n1!=INVALID&n1_state_ts_seq1_r0_n2!=INVALID)) &  ((n1_state_ts_seq1_r0_n1!=INVALID&n1_state_ts_seq1_r0_n1=n1_state_ts_seq1_r0_n0)|(n1_state_ts_seq1_r0_n2!=INVALID&n1_state_ts_seq1_r0_n2=n1_state_ts_seq1_r0_n0)) ->         (n1_vote_ts_seq1_r0_n1'=n1_state_ts_seq1_r0_n0) & (n1_stage_seq1'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=1) & (n1_send_round'=0) & (n1_send_cmd_ts'=n1_state_ts_seq1_r0_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign QUES_VOTE.
    [n1_process_state_assign_vote_seq1_r0_using_n0] n1_stage_seq1=p2s_stage & n1_round_1=0 & n1_send_ready=false & ((n1_state_ts_seq1_r0_n0!=INVALID&n1_state_ts_seq1_r0_n1!=INVALID)|(n1_state_ts_seq1_r0_n0!=INVALID&n1_state_ts_seq1_r0_n2!=INVALID)|(n1_state_ts_seq1_r0_n1!=INVALID&n1_state_ts_seq1_r0_n2!=INVALID)) & !((n1_state_ts_seq1_r0_n1!=INVALID&n1_state_ts_seq1_r0_n1=n1_state_ts_seq1_r0_n0)|(n1_state_ts_seq1_r0_n2!=INVALID&n1_state_ts_seq1_r0_n2=n1_state_ts_seq1_r0_n0)) ->         (n1_vote_ts_seq1_r0_n1'=QUES_VOTE)                              & (n1_stage_seq1'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=1) & (n1_send_round'=0) & (n1_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq1 assign the state using the proposal from node 1 for seq1 at round0.
    [n1_process_state_assign_vote_seq1_r0_using_n1] n1_stage_seq1=p2s_stage & n1_round_1=0 & n1_send_ready=false & ((n1_state_ts_seq1_r0_n0!=INVALID&n1_state_ts_seq1_r0_n1!=INVALID)|(n1_state_ts_seq1_r0_n0!=INVALID&n1_state_ts_seq1_r0_n2!=INVALID)|(n1_state_ts_seq1_r0_n1!=INVALID&n1_state_ts_seq1_r0_n2!=INVALID)) &  ((n1_state_ts_seq1_r0_n0!=INVALID&n1_state_ts_seq1_r0_n0=n1_state_ts_seq1_r0_n1)|(n1_state_ts_seq1_r0_n2!=INVALID&n1_state_ts_seq1_r0_n2=n1_state_ts_seq1_r0_n1)) ->         (n1_vote_ts_seq1_r0_n1'=n1_state_ts_seq1_r0_n1) & (n1_stage_seq1'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=1) & (n1_send_round'=0) & (n1_send_cmd_ts'=n1_state_ts_seq1_r0_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign QUES_VOTE.
    [n1_process_state_assign_vote_seq1_r0_using_n1] n1_stage_seq1=p2s_stage & n1_round_1=0 & n1_send_ready=false & ((n1_state_ts_seq1_r0_n0!=INVALID&n1_state_ts_seq1_r0_n1!=INVALID)|(n1_state_ts_seq1_r0_n0!=INVALID&n1_state_ts_seq1_r0_n2!=INVALID)|(n1_state_ts_seq1_r0_n1!=INVALID&n1_state_ts_seq1_r0_n2!=INVALID)) & !((n1_state_ts_seq1_r0_n0!=INVALID&n1_state_ts_seq1_r0_n0=n1_state_ts_seq1_r0_n1)|(n1_state_ts_seq1_r0_n2!=INVALID&n1_state_ts_seq1_r0_n2=n1_state_ts_seq1_r0_n1)) ->         (n1_vote_ts_seq1_r0_n1'=QUES_VOTE)                              & (n1_stage_seq1'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=1) & (n1_send_round'=0) & (n1_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq1 assign the state using the proposal from node 2 for seq1 at round0.
    [n1_process_state_assign_vote_seq1_r0_using_n2] n1_stage_seq1=p2s_stage & n1_round_1=0 & n1_send_ready=false & ((n1_state_ts_seq1_r0_n0!=INVALID&n1_state_ts_seq1_r0_n1!=INVALID)|(n1_state_ts_seq1_r0_n0!=INVALID&n1_state_ts_seq1_r0_n2!=INVALID)|(n1_state_ts_seq1_r0_n1!=INVALID&n1_state_ts_seq1_r0_n2!=INVALID)) &  ((n1_state_ts_seq1_r0_n0!=INVALID&n1_state_ts_seq1_r0_n0=n1_state_ts_seq1_r0_n2)|(n1_state_ts_seq1_r0_n1!=INVALID&n1_state_ts_seq1_r0_n1=n1_state_ts_seq1_r0_n2)) ->         (n1_vote_ts_seq1_r0_n1'=n1_state_ts_seq1_r0_n2) & (n1_stage_seq1'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=1) & (n1_send_round'=0) & (n1_send_cmd_ts'=n1_state_ts_seq1_r0_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign QUES_VOTE.
    [n1_process_state_assign_vote_seq1_r0_using_n2] n1_stage_seq1=p2s_stage & n1_round_1=0 & n1_send_ready=false & ((n1_state_ts_seq1_r0_n0!=INVALID&n1_state_ts_seq1_r0_n1!=INVALID)|(n1_state_ts_seq1_r0_n0!=INVALID&n1_state_ts_seq1_r0_n2!=INVALID)|(n1_state_ts_seq1_r0_n1!=INVALID&n1_state_ts_seq1_r0_n2!=INVALID)) & !((n1_state_ts_seq1_r0_n0!=INVALID&n1_state_ts_seq1_r0_n0=n1_state_ts_seq1_r0_n2)|(n1_state_ts_seq1_r0_n1!=INVALID&n1_state_ts_seq1_r0_n1=n1_state_ts_seq1_r0_n2)) ->         (n1_vote_ts_seq1_r0_n1'=QUES_VOTE)                              & (n1_stage_seq1'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=1) & (n1_send_round'=0) & (n1_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq1 assign the state using the proposal from node 0 for seq1 at round1.
    [n1_process_state_assign_vote_seq1_r1_using_n0] n1_stage_seq1=p2s_stage & n1_round_1=1 & n1_send_ready=false & ((n1_state_ts_seq1_r1_n0!=INVALID&n1_state_ts_seq1_r1_n1!=INVALID)|(n1_state_ts_seq1_r1_n0!=INVALID&n1_state_ts_seq1_r1_n2!=INVALID)|(n1_state_ts_seq1_r1_n1!=INVALID&n1_state_ts_seq1_r1_n2!=INVALID)) &  ((n1_state_ts_seq1_r1_n1!=INVALID&n1_state_ts_seq1_r1_n1=n1_state_ts_seq1_r1_n0)|(n1_state_ts_seq1_r1_n2!=INVALID&n1_state_ts_seq1_r1_n2=n1_state_ts_seq1_r1_n0)) ->         (n1_vote_ts_seq1_r1_n1'=n1_state_ts_seq1_r1_n0) & (n1_stage_seq1'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=1) & (n1_send_round'=1) & (n1_send_cmd_ts'=n1_state_ts_seq1_r1_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign QUES_VOTE.
    [n1_process_state_assign_vote_seq1_r1_using_n0] n1_stage_seq1=p2s_stage & n1_round_1=1 & n1_send_ready=false & ((n1_state_ts_seq1_r1_n0!=INVALID&n1_state_ts_seq1_r1_n1!=INVALID)|(n1_state_ts_seq1_r1_n0!=INVALID&n1_state_ts_seq1_r1_n2!=INVALID)|(n1_state_ts_seq1_r1_n1!=INVALID&n1_state_ts_seq1_r1_n2!=INVALID)) & !((n1_state_ts_seq1_r1_n1!=INVALID&n1_state_ts_seq1_r1_n1=n1_state_ts_seq1_r1_n0)|(n1_state_ts_seq1_r1_n2!=INVALID&n1_state_ts_seq1_r1_n2=n1_state_ts_seq1_r1_n0)) ->         (n1_vote_ts_seq1_r1_n1'=QUES_VOTE)                              & (n1_stage_seq1'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=1) & (n1_send_round'=1) & (n1_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq1 assign the state using the proposal from node 1 for seq1 at round1.
    [n1_process_state_assign_vote_seq1_r1_using_n1] n1_stage_seq1=p2s_stage & n1_round_1=1 & n1_send_ready=false & ((n1_state_ts_seq1_r1_n0!=INVALID&n1_state_ts_seq1_r1_n1!=INVALID)|(n1_state_ts_seq1_r1_n0!=INVALID&n1_state_ts_seq1_r1_n2!=INVALID)|(n1_state_ts_seq1_r1_n1!=INVALID&n1_state_ts_seq1_r1_n2!=INVALID)) &  ((n1_state_ts_seq1_r1_n0!=INVALID&n1_state_ts_seq1_r1_n0=n1_state_ts_seq1_r1_n1)|(n1_state_ts_seq1_r1_n2!=INVALID&n1_state_ts_seq1_r1_n2=n1_state_ts_seq1_r1_n1)) ->         (n1_vote_ts_seq1_r1_n1'=n1_state_ts_seq1_r1_n1) & (n1_stage_seq1'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=1) & (n1_send_round'=1) & (n1_send_cmd_ts'=n1_state_ts_seq1_r1_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign QUES_VOTE.
    [n1_process_state_assign_vote_seq1_r1_using_n1] n1_stage_seq1=p2s_stage & n1_round_1=1 & n1_send_ready=false & ((n1_state_ts_seq1_r1_n0!=INVALID&n1_state_ts_seq1_r1_n1!=INVALID)|(n1_state_ts_seq1_r1_n0!=INVALID&n1_state_ts_seq1_r1_n2!=INVALID)|(n1_state_ts_seq1_r1_n1!=INVALID&n1_state_ts_seq1_r1_n2!=INVALID)) & !((n1_state_ts_seq1_r1_n0!=INVALID&n1_state_ts_seq1_r1_n0=n1_state_ts_seq1_r1_n1)|(n1_state_ts_seq1_r1_n2!=INVALID&n1_state_ts_seq1_r1_n2=n1_state_ts_seq1_r1_n1)) ->         (n1_vote_ts_seq1_r1_n1'=QUES_VOTE)                              & (n1_stage_seq1'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=1) & (n1_send_round'=1) & (n1_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq1 assign the state using the proposal from node 2 for seq1 at round1.
    [n1_process_state_assign_vote_seq1_r1_using_n2] n1_stage_seq1=p2s_stage & n1_round_1=1 & n1_send_ready=false & ((n1_state_ts_seq1_r1_n0!=INVALID&n1_state_ts_seq1_r1_n1!=INVALID)|(n1_state_ts_seq1_r1_n0!=INVALID&n1_state_ts_seq1_r1_n2!=INVALID)|(n1_state_ts_seq1_r1_n1!=INVALID&n1_state_ts_seq1_r1_n2!=INVALID)) &  ((n1_state_ts_seq1_r1_n0!=INVALID&n1_state_ts_seq1_r1_n0=n1_state_ts_seq1_r1_n2)|(n1_state_ts_seq1_r1_n1!=INVALID&n1_state_ts_seq1_r1_n1=n1_state_ts_seq1_r1_n2)) ->         (n1_vote_ts_seq1_r1_n1'=n1_state_ts_seq1_r1_n2) & (n1_stage_seq1'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=1) & (n1_send_round'=1) & (n1_send_cmd_ts'=n1_state_ts_seq1_r1_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign QUES_VOTE.
    [n1_process_state_assign_vote_seq1_r1_using_n2] n1_stage_seq1=p2s_stage & n1_round_1=1 & n1_send_ready=false & ((n1_state_ts_seq1_r1_n0!=INVALID&n1_state_ts_seq1_r1_n1!=INVALID)|(n1_state_ts_seq1_r1_n0!=INVALID&n1_state_ts_seq1_r1_n2!=INVALID)|(n1_state_ts_seq1_r1_n1!=INVALID&n1_state_ts_seq1_r1_n2!=INVALID)) & !((n1_state_ts_seq1_r1_n0!=INVALID&n1_state_ts_seq1_r1_n0=n1_state_ts_seq1_r1_n2)|(n1_state_ts_seq1_r1_n1!=INVALID&n1_state_ts_seq1_r1_n1=n1_state_ts_seq1_r1_n2)) ->         (n1_vote_ts_seq1_r1_n1'=QUES_VOTE)                              & (n1_stage_seq1'=p2v_stage) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_vote) & (n1_send_seq'=1) & (n1_send_round'=1) & (n1_send_cmd_ts'=BOT);

    // Process when a Vote pkt is ready.
    // Received an old state for seq0, reply decided.
    [n1_receive_vote_from_old_seq0_reply_decided]   n1_recv_ready=true & n1_recv_type=cmd_vote & n1_recv_seq=0 & (n1_stage_seq0=decided) ->         (n1_recv_ready'=false) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_decided) & (n1_send_seq'=0) & (n1_send_cmd_ts'=n1_log_ts_seq0);
    // Received an old state for seq1, reply decided.
    [n1_receive_vote_from_old_seq1_reply_decided]   n1_recv_ready=true & n1_recv_type=cmd_vote & n1_recv_seq=1 & (n1_stage_seq1=decided) ->         (n1_recv_ready'=false) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_decided) & (n1_send_seq'=1) & (n1_send_cmd_ts'=n1_log_ts_seq1); 
    // Receive the vote from node 0 for non-decided seq0, round0.
    [n1_receive_vote_from_n0_for_seq0_r0] n1_recv_ready=true & n1_recv_from=0 & n1_recv_type=cmd_vote & n1_recv_seq=0 & n1_recv_round=0 & n1_stage_seq0!=decided ->         (n1_recv_ready'=false) & (n1_vote_ts_seq0_r0_n0'=n1_recv_cmd_ts); 
    // Receive the vote from node 1 for non-decided seq0, round0.
    [n1_receive_vote_from_n1_for_seq0_r0] n1_recv_ready=true & n1_recv_from=1 & n1_recv_type=cmd_vote & n1_recv_seq=0 & n1_recv_round=0 & n1_stage_seq0!=decided ->         (n1_recv_ready'=false) & (n1_vote_ts_seq0_r0_n1'=n1_recv_cmd_ts); 
    // Receive the vote from node 2 for non-decided seq0, round0.
    [n1_receive_vote_from_n2_for_seq0_r0] n1_recv_ready=true & n1_recv_from=2 & n1_recv_type=cmd_vote & n1_recv_seq=0 & n1_recv_round=0 & n1_stage_seq0!=decided ->         (n1_recv_ready'=false) & (n1_vote_ts_seq0_r0_n2'=n1_recv_cmd_ts); 
    // Receive the vote from node 0 for non-decided seq0, round1.
    [n1_receive_vote_from_n0_for_seq0_r1] n1_recv_ready=true & n1_recv_from=0 & n1_recv_type=cmd_vote & n1_recv_seq=0 & n1_recv_round=1 & n1_stage_seq0!=decided ->         (n1_recv_ready'=false) & (n1_vote_ts_seq0_r1_n0'=n1_recv_cmd_ts); 
    // Receive the vote from node 1 for non-decided seq0, round1.
    [n1_receive_vote_from_n1_for_seq0_r1] n1_recv_ready=true & n1_recv_from=1 & n1_recv_type=cmd_vote & n1_recv_seq=0 & n1_recv_round=1 & n1_stage_seq0!=decided ->         (n1_recv_ready'=false) & (n1_vote_ts_seq0_r1_n1'=n1_recv_cmd_ts); 
    // Receive the vote from node 2 for non-decided seq0, round1.
    [n1_receive_vote_from_n2_for_seq0_r1] n1_recv_ready=true & n1_recv_from=2 & n1_recv_type=cmd_vote & n1_recv_seq=0 & n1_recv_round=1 & n1_stage_seq0!=decided ->         (n1_recv_ready'=false) & (n1_vote_ts_seq0_r1_n2'=n1_recv_cmd_ts); 
    // Receive the vote from node 0 for non-decided seq1, round0.
    [n1_receive_vote_from_n0_for_seq1_r0] n1_recv_ready=true & n1_recv_from=0 & n1_recv_type=cmd_vote & n1_recv_seq=1 & n1_recv_round=0 & n1_stage_seq1!=decided ->         (n1_recv_ready'=false) & (n1_vote_ts_seq1_r0_n0'=n1_recv_cmd_ts); 
    // Receive the vote from node 1 for non-decided seq1, round0.
    [n1_receive_vote_from_n1_for_seq1_r0] n1_recv_ready=true & n1_recv_from=1 & n1_recv_type=cmd_vote & n1_recv_seq=1 & n1_recv_round=0 & n1_stage_seq1!=decided ->         (n1_recv_ready'=false) & (n1_vote_ts_seq1_r0_n1'=n1_recv_cmd_ts); 
    // Receive the vote from node 2 for non-decided seq1, round0.
    [n1_receive_vote_from_n2_for_seq1_r0] n1_recv_ready=true & n1_recv_from=2 & n1_recv_type=cmd_vote & n1_recv_seq=1 & n1_recv_round=0 & n1_stage_seq1!=decided ->         (n1_recv_ready'=false) & (n1_vote_ts_seq1_r0_n2'=n1_recv_cmd_ts); 
    // Receive the vote from node 0 for non-decided seq1, round1.
    [n1_receive_vote_from_n0_for_seq1_r1] n1_recv_ready=true & n1_recv_from=0 & n1_recv_type=cmd_vote & n1_recv_seq=1 & n1_recv_round=1 & n1_stage_seq1!=decided ->         (n1_recv_ready'=false) & (n1_vote_ts_seq1_r1_n0'=n1_recv_cmd_ts); 
    // Receive the vote from node 1 for non-decided seq1, round1.
    [n1_receive_vote_from_n1_for_seq1_r1] n1_recv_ready=true & n1_recv_from=1 & n1_recv_type=cmd_vote & n1_recv_seq=1 & n1_recv_round=1 & n1_stage_seq1!=decided ->         (n1_recv_ready'=false) & (n1_vote_ts_seq1_r1_n1'=n1_recv_cmd_ts); 
    // Receive the vote from node 2 for non-decided seq1, round1.
    [n1_receive_vote_from_n2_for_seq1_r1] n1_recv_ready=true & n1_recv_from=2 & n1_recv_type=cmd_vote & n1_recv_seq=1 & n1_recv_round=1 & n1_stage_seq1!=decided ->         (n1_recv_ready'=false) & (n1_vote_ts_seq1_r1_n2'=n1_recv_cmd_ts); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 0 for seq0 at round0.
    [n1_process_vote_for_seq0_r0_using_n0] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=0 & (n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n0!=QUES_VOTE) & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n1!=INVALID)|(n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)) & ((n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n1=n1_vote_ts_seq0_r0_n0)|(n1_vote_ts_seq0_r0_n2!=INVALID&n1_vote_ts_seq0_r0_n2=n1_vote_ts_seq0_r0_n0)) ->         (n1_log_ts_seq0'=n1_vote_ts_seq0_r0_n0) & (n1_stage_seq0'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 1 for seq0 at round0.
    [n1_process_vote_for_seq0_r0_using_n1] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=0 & (n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n1!=QUES_VOTE) & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n1!=INVALID)|(n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)) & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n0=n1_vote_ts_seq0_r0_n1)|(n1_vote_ts_seq0_r0_n2!=INVALID&n1_vote_ts_seq0_r0_n2=n1_vote_ts_seq0_r0_n1)) ->         (n1_log_ts_seq0'=n1_vote_ts_seq0_r0_n1) & (n1_stage_seq0'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 2 for seq0 at round0.
    [n1_process_vote_for_seq0_r0_using_n2] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=0 & (n1_vote_ts_seq0_r0_n2!=INVALID&n1_vote_ts_seq0_r0_n2!=QUES_VOTE) & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n1!=INVALID)|(n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)) & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n0=n1_vote_ts_seq0_r0_n2)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n1=n1_vote_ts_seq0_r0_n2)) ->         (n1_log_ts_seq0'=n1_vote_ts_seq0_r0_n2) & (n1_stage_seq0'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 0 for seq0 at round1.
    [n1_process_vote_for_seq0_r1_using_n0] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=1 & (n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n0!=QUES_VOTE) & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n1!=INVALID)|(n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)) & ((n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n1=n1_vote_ts_seq0_r1_n0)|(n1_vote_ts_seq0_r1_n2!=INVALID&n1_vote_ts_seq0_r1_n2=n1_vote_ts_seq0_r1_n0)) ->         (n1_log_ts_seq0'=n1_vote_ts_seq0_r1_n0) & (n1_stage_seq0'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 1 for seq0 at round1.
    [n1_process_vote_for_seq0_r1_using_n1] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=1 & (n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n1!=QUES_VOTE) & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n1!=INVALID)|(n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)) & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n0=n1_vote_ts_seq0_r1_n1)|(n1_vote_ts_seq0_r1_n2!=INVALID&n1_vote_ts_seq0_r1_n2=n1_vote_ts_seq0_r1_n1)) ->         (n1_log_ts_seq0'=n1_vote_ts_seq0_r1_n1) & (n1_stage_seq0'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 2 for seq0 at round1.
    [n1_process_vote_for_seq0_r1_using_n2] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=1 & (n1_vote_ts_seq0_r1_n2!=INVALID&n1_vote_ts_seq0_r1_n2!=QUES_VOTE) & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n1!=INVALID)|(n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)) & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n0=n1_vote_ts_seq0_r1_n2)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n1=n1_vote_ts_seq0_r1_n2)) ->         (n1_log_ts_seq0'=n1_vote_ts_seq0_r1_n2) & (n1_stage_seq0'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 0 for seq1 at round0.
    [n1_process_vote_for_seq1_r0_using_n0] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=0 & (n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n0!=QUES_VOTE) & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n1!=INVALID)|(n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)) & ((n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n1=n1_vote_ts_seq1_r0_n0)|(n1_vote_ts_seq1_r0_n2!=INVALID&n1_vote_ts_seq1_r0_n2=n1_vote_ts_seq1_r0_n0)) ->         (n1_log_ts_seq1'=n1_vote_ts_seq1_r0_n0) & (n1_stage_seq1'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 1 for seq1 at round0.
    [n1_process_vote_for_seq1_r0_using_n1] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=0 & (n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n1!=QUES_VOTE) & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n1!=INVALID)|(n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)) & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n0=n1_vote_ts_seq1_r0_n1)|(n1_vote_ts_seq1_r0_n2!=INVALID&n1_vote_ts_seq1_r0_n2=n1_vote_ts_seq1_r0_n1)) ->         (n1_log_ts_seq1'=n1_vote_ts_seq1_r0_n1) & (n1_stage_seq1'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 2 for seq1 at round0.
    [n1_process_vote_for_seq1_r0_using_n2] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=0 & (n1_vote_ts_seq1_r0_n2!=INVALID&n1_vote_ts_seq1_r0_n2!=QUES_VOTE) & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n1!=INVALID)|(n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)) & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n0=n1_vote_ts_seq1_r0_n2)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n1=n1_vote_ts_seq1_r0_n2)) ->         (n1_log_ts_seq1'=n1_vote_ts_seq1_r0_n2) & (n1_stage_seq1'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 0 for seq1 at round1.
    [n1_process_vote_for_seq1_r1_using_n0] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=1 & (n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n0!=QUES_VOTE) & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n1!=INVALID)|(n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)) & ((n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n1=n1_vote_ts_seq1_r1_n0)|(n1_vote_ts_seq1_r1_n2!=INVALID&n1_vote_ts_seq1_r1_n2=n1_vote_ts_seq1_r1_n0)) ->         (n1_log_ts_seq1'=n1_vote_ts_seq1_r1_n0) & (n1_stage_seq1'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 1 for seq1 at round1.
    [n1_process_vote_for_seq1_r1_using_n1] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=1 & (n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n1!=QUES_VOTE) & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n1!=INVALID)|(n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)) & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n0=n1_vote_ts_seq1_r1_n1)|(n1_vote_ts_seq1_r1_n2!=INVALID&n1_vote_ts_seq1_r1_n2=n1_vote_ts_seq1_r1_n1)) ->         (n1_log_ts_seq1'=n1_vote_ts_seq1_r1_n1) & (n1_stage_seq1'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 2 for seq1 at round1.
    [n1_process_vote_for_seq1_r1_using_n2] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=1 & (n1_vote_ts_seq1_r1_n2!=INVALID&n1_vote_ts_seq1_r1_n2!=QUES_VOTE) & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n1!=INVALID)|(n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)) & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n0=n1_vote_ts_seq1_r1_n2)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n1=n1_vote_ts_seq1_r1_n2)) ->         (n1_log_ts_seq1'=n1_vote_ts_seq1_r1_n2) & (n1_stage_seq1'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 0 for seq0 at round0.
    [n1_process_vote_for_seq0_r0_using_n0] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=0 & n1_round_0+1<MAX_ROUND & (n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n0!=QUES_VOTE) & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n1!=INVALID)|(n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)) & !((n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n1=n1_vote_ts_seq0_r0_n0)|(n1_vote_ts_seq0_r0_n2!=INVALID&n1_vote_ts_seq0_r0_n2=n1_vote_ts_seq0_r0_n0)) ->         (n1_state_ts_seq0_r0_n1'=n1_vote_ts_seq0_r0_n0) & (n1_vote_ts_seq0_r0_n1'=INVALID) & (n1_stage_seq0'=p2s_stage) & (n1_round_0'=n1_round_0+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=0+1) & (n1_send_cmd_ts'=n1_state_ts_seq0_r0_n0);
    //// 2.fail: Out of rounds
    [n1_process_vote_for_seq0_r0_using_n0] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=0 & n1_round_0+1=MAX_ROUND & (n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n0!=QUES_VOTE) & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n1!=INVALID)|(n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)) & !((n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n1=n1_vote_ts_seq0_r0_n0)|(n1_vote_ts_seq0_r0_n2!=INVALID&n1_vote_ts_seq0_r0_n2=n1_vote_ts_seq0_r0_n0)) ->         (n1_log_ts_seq0'=OUT_OF_ROUND) & (n1_stage_seq0'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n1_process_vote_for_seq0_r0_using_n0] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=0 & n1_round_0+1<MAX_ROUND & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n1!=INVALID)|(n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)) & n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n0=QUES_VOTE&n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n1=QUES_VOTE&n1_vote_ts_seq0_r0_n2!=INVALID&n1_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n1_state_ts_seq0_r0_n1'=BOT)                                    & (n1_vote_ts_seq0_r0_n1'=INVALID) & (n1_stage_seq0'=p2s_stage) & (n1_round_0'=n1_round_0+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=0+1) & (n1_send_cmd_ts'=BOT);
    [n1_process_vote_for_seq0_r0_using_n0] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=0 & n1_round_0+1<MAX_ROUND & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n1!=INVALID)|(n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)) & n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n0=QUES_VOTE&n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n1=QUES_VOTE&n1_vote_ts_seq0_r0_n2!=INVALID&n1_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n1_state_ts_seq0_r0_n1'=n1_state_ts_seq0_r0_n0) & (n1_vote_ts_seq0_r0_n1'=INVALID) & (n1_stage_seq0'=p2s_stage) & (n1_round_0'=n1_round_0+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=0+1) & (n1_send_cmd_ts'=n1_state_ts_seq0_r0_n0);
    //// 3.fail: Out of rounds
    [n1_process_vote_for_seq0_r0_using_n0] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=0 & n1_round_0+1=MAX_ROUND & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n1!=INVALID)|(n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)) & n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n0=QUES_VOTE&n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n1=QUES_VOTE&n1_vote_ts_seq0_r0_n2!=INVALID&n1_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n1_log_ts_seq0'=OUT_OF_ROUND) & (n1_stage_seq0'=pre_decided_stage);
    [n1_process_vote_for_seq0_r0_using_n0] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=0 & n1_round_0+1=MAX_ROUND & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n1!=INVALID)|(n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)) & n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n0=QUES_VOTE&n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n1=QUES_VOTE&n1_vote_ts_seq0_r0_n2!=INVALID&n1_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n1_log_ts_seq0'=OUT_OF_ROUND) & (n1_stage_seq0'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 1 for seq0 at round0.
    [n1_process_vote_for_seq0_r0_using_n1] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=0 & n1_round_0+1<MAX_ROUND & (n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n1!=QUES_VOTE) & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n1!=INVALID)|(n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)) & !((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n0=n1_vote_ts_seq0_r0_n1)|(n1_vote_ts_seq0_r0_n2!=INVALID&n1_vote_ts_seq0_r0_n2=n1_vote_ts_seq0_r0_n1)) ->         (n1_state_ts_seq0_r0_n1'=n1_vote_ts_seq0_r0_n1) & (n1_vote_ts_seq0_r0_n1'=INVALID) & (n1_stage_seq0'=p2s_stage) & (n1_round_0'=n1_round_0+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=0+1) & (n1_send_cmd_ts'=n1_state_ts_seq0_r0_n1);
    //// 2.fail: Out of rounds
    [n1_process_vote_for_seq0_r0_using_n1] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=0 & n1_round_0+1=MAX_ROUND & (n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n1!=QUES_VOTE) & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n1!=INVALID)|(n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)) & !((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n0=n1_vote_ts_seq0_r0_n1)|(n1_vote_ts_seq0_r0_n2!=INVALID&n1_vote_ts_seq0_r0_n2=n1_vote_ts_seq0_r0_n1)) ->         (n1_log_ts_seq0'=OUT_OF_ROUND) & (n1_stage_seq0'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n1_process_vote_for_seq0_r0_using_n1] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=0 & n1_round_0+1<MAX_ROUND & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n1!=INVALID)|(n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)) & n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n0=QUES_VOTE&n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n1=QUES_VOTE&n1_vote_ts_seq0_r0_n2!=INVALID&n1_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n1_state_ts_seq0_r0_n1'=BOT)                                    & (n1_vote_ts_seq0_r0_n1'=INVALID) & (n1_stage_seq0'=p2s_stage) & (n1_round_0'=n1_round_0+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=0+1) & (n1_send_cmd_ts'=BOT);
    [n1_process_vote_for_seq0_r0_using_n1] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=0 & n1_round_0+1<MAX_ROUND & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n1!=INVALID)|(n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)) & n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n0=QUES_VOTE&n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n1=QUES_VOTE&n1_vote_ts_seq0_r0_n2!=INVALID&n1_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n1_state_ts_seq0_r0_n1'=n1_state_ts_seq0_r0_n1) & (n1_vote_ts_seq0_r0_n1'=INVALID) & (n1_stage_seq0'=p2s_stage) & (n1_round_0'=n1_round_0+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=0+1) & (n1_send_cmd_ts'=n1_state_ts_seq0_r0_n1);
    //// 3.fail: Out of rounds
    [n1_process_vote_for_seq0_r0_using_n1] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=0 & n1_round_0+1=MAX_ROUND & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n1!=INVALID)|(n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)) & n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n0=QUES_VOTE&n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n1=QUES_VOTE&n1_vote_ts_seq0_r0_n2!=INVALID&n1_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n1_log_ts_seq0'=OUT_OF_ROUND) & (n1_stage_seq0'=pre_decided_stage);
    [n1_process_vote_for_seq0_r0_using_n1] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=0 & n1_round_0+1=MAX_ROUND & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n1!=INVALID)|(n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)) & n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n0=QUES_VOTE&n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n1=QUES_VOTE&n1_vote_ts_seq0_r0_n2!=INVALID&n1_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n1_log_ts_seq0'=OUT_OF_ROUND) & (n1_stage_seq0'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 2 for seq0 at round0.
    [n1_process_vote_for_seq0_r0_using_n2] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=0 & n1_round_0+1<MAX_ROUND & (n1_vote_ts_seq0_r0_n2!=INVALID&n1_vote_ts_seq0_r0_n2!=QUES_VOTE) & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n1!=INVALID)|(n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)) & !((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n0=n1_vote_ts_seq0_r0_n2)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n1=n1_vote_ts_seq0_r0_n2)) ->         (n1_state_ts_seq0_r0_n1'=n1_vote_ts_seq0_r0_n2) & (n1_vote_ts_seq0_r0_n1'=INVALID) & (n1_stage_seq0'=p2s_stage) & (n1_round_0'=n1_round_0+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=0+1) & (n1_send_cmd_ts'=n1_state_ts_seq0_r0_n2);
    //// 2.fail: Out of rounds
    [n1_process_vote_for_seq0_r0_using_n2] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=0 & n1_round_0+1=MAX_ROUND & (n1_vote_ts_seq0_r0_n2!=INVALID&n1_vote_ts_seq0_r0_n2!=QUES_VOTE) & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n1!=INVALID)|(n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)) & !((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n0=n1_vote_ts_seq0_r0_n2)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n1=n1_vote_ts_seq0_r0_n2)) ->         (n1_log_ts_seq0'=OUT_OF_ROUND) & (n1_stage_seq0'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n1_process_vote_for_seq0_r0_using_n2] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=0 & n1_round_0+1<MAX_ROUND & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n1!=INVALID)|(n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)) & n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n0=QUES_VOTE&n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n1=QUES_VOTE&n1_vote_ts_seq0_r0_n2!=INVALID&n1_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n1_state_ts_seq0_r0_n1'=BOT)                                    & (n1_vote_ts_seq0_r0_n1'=INVALID) & (n1_stage_seq0'=p2s_stage) & (n1_round_0'=n1_round_0+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=0+1) & (n1_send_cmd_ts'=BOT);
    [n1_process_vote_for_seq0_r0_using_n2] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=0 & n1_round_0+1<MAX_ROUND & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n1!=INVALID)|(n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)) & n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n0=QUES_VOTE&n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n1=QUES_VOTE&n1_vote_ts_seq0_r0_n2!=INVALID&n1_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n1_state_ts_seq0_r0_n1'=n1_state_ts_seq0_r0_n2) & (n1_vote_ts_seq0_r0_n1'=INVALID) & (n1_stage_seq0'=p2s_stage) & (n1_round_0'=n1_round_0+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=0+1) & (n1_send_cmd_ts'=n1_state_ts_seq0_r0_n2);
    //// 3.fail: Out of rounds
    [n1_process_vote_for_seq0_r0_using_n2] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=0 & n1_round_0+1=MAX_ROUND & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n1!=INVALID)|(n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)) & n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n0=QUES_VOTE&n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n1=QUES_VOTE&n1_vote_ts_seq0_r0_n2!=INVALID&n1_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n1_log_ts_seq0'=OUT_OF_ROUND) & (n1_stage_seq0'=pre_decided_stage);
    [n1_process_vote_for_seq0_r0_using_n2] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=0 & n1_round_0+1=MAX_ROUND & ((n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n1!=INVALID)|(n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)|(n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n2!=INVALID)) & n1_vote_ts_seq0_r0_n0!=INVALID&n1_vote_ts_seq0_r0_n0=QUES_VOTE&n1_vote_ts_seq0_r0_n1!=INVALID&n1_vote_ts_seq0_r0_n1=QUES_VOTE&n1_vote_ts_seq0_r0_n2!=INVALID&n1_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n1_log_ts_seq0'=OUT_OF_ROUND) & (n1_stage_seq0'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 0 for seq0 at round1.
    [n1_process_vote_for_seq0_r1_using_n0] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=1 & n1_round_0+1<MAX_ROUND & (n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n0!=QUES_VOTE) & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n1!=INVALID)|(n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)) & !((n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n1=n1_vote_ts_seq0_r1_n0)|(n1_vote_ts_seq0_r1_n2!=INVALID&n1_vote_ts_seq0_r1_n2=n1_vote_ts_seq0_r1_n0)) ->         (n1_state_ts_seq0_r1_n1'=n1_vote_ts_seq0_r1_n0) & (n1_vote_ts_seq0_r1_n1'=INVALID) & (n1_stage_seq0'=p2s_stage) & (n1_round_0'=n1_round_0+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=1+1) & (n1_send_cmd_ts'=n1_state_ts_seq0_r1_n0);
    //// 2.fail: Out of rounds
    [n1_process_vote_for_seq0_r1_using_n0] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=1 & n1_round_0+1=MAX_ROUND & (n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n0!=QUES_VOTE) & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n1!=INVALID)|(n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)) & !((n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n1=n1_vote_ts_seq0_r1_n0)|(n1_vote_ts_seq0_r1_n2!=INVALID&n1_vote_ts_seq0_r1_n2=n1_vote_ts_seq0_r1_n0)) ->         (n1_log_ts_seq0'=OUT_OF_ROUND) & (n1_stage_seq0'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n1_process_vote_for_seq0_r1_using_n0] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=1 & n1_round_0+1<MAX_ROUND & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n1!=INVALID)|(n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)) & n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n0=QUES_VOTE&n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n1=QUES_VOTE&n1_vote_ts_seq0_r1_n2!=INVALID&n1_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n1_state_ts_seq0_r1_n1'=BOT)                                    & (n1_vote_ts_seq0_r1_n1'=INVALID) & (n1_stage_seq0'=p2s_stage) & (n1_round_0'=n1_round_0+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=1+1) & (n1_send_cmd_ts'=BOT);
    [n1_process_vote_for_seq0_r1_using_n0] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=1 & n1_round_0+1<MAX_ROUND & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n1!=INVALID)|(n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)) & n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n0=QUES_VOTE&n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n1=QUES_VOTE&n1_vote_ts_seq0_r1_n2!=INVALID&n1_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n1_state_ts_seq0_r1_n1'=n1_state_ts_seq0_r1_n0) & (n1_vote_ts_seq0_r1_n1'=INVALID) & (n1_stage_seq0'=p2s_stage) & (n1_round_0'=n1_round_0+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=1+1) & (n1_send_cmd_ts'=n1_state_ts_seq0_r1_n0);
    //// 3.fail: Out of rounds
    [n1_process_vote_for_seq0_r1_using_n0] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=1 & n1_round_0+1=MAX_ROUND & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n1!=INVALID)|(n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)) & n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n0=QUES_VOTE&n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n1=QUES_VOTE&n1_vote_ts_seq0_r1_n2!=INVALID&n1_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n1_log_ts_seq0'=OUT_OF_ROUND) & (n1_stage_seq0'=pre_decided_stage);
    [n1_process_vote_for_seq0_r1_using_n0] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=1 & n1_round_0+1=MAX_ROUND & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n1!=INVALID)|(n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)) & n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n0=QUES_VOTE&n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n1=QUES_VOTE&n1_vote_ts_seq0_r1_n2!=INVALID&n1_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n1_log_ts_seq0'=OUT_OF_ROUND) & (n1_stage_seq0'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 1 for seq0 at round1.
    [n1_process_vote_for_seq0_r1_using_n1] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=1 & n1_round_0+1<MAX_ROUND & (n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n1!=QUES_VOTE) & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n1!=INVALID)|(n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)) & !((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n0=n1_vote_ts_seq0_r1_n1)|(n1_vote_ts_seq0_r1_n2!=INVALID&n1_vote_ts_seq0_r1_n2=n1_vote_ts_seq0_r1_n1)) ->         (n1_state_ts_seq0_r1_n1'=n1_vote_ts_seq0_r1_n1) & (n1_vote_ts_seq0_r1_n1'=INVALID) & (n1_stage_seq0'=p2s_stage) & (n1_round_0'=n1_round_0+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=1+1) & (n1_send_cmd_ts'=n1_state_ts_seq0_r1_n1);
    //// 2.fail: Out of rounds
    [n1_process_vote_for_seq0_r1_using_n1] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=1 & n1_round_0+1=MAX_ROUND & (n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n1!=QUES_VOTE) & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n1!=INVALID)|(n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)) & !((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n0=n1_vote_ts_seq0_r1_n1)|(n1_vote_ts_seq0_r1_n2!=INVALID&n1_vote_ts_seq0_r1_n2=n1_vote_ts_seq0_r1_n1)) ->         (n1_log_ts_seq0'=OUT_OF_ROUND) & (n1_stage_seq0'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n1_process_vote_for_seq0_r1_using_n1] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=1 & n1_round_0+1<MAX_ROUND & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n1!=INVALID)|(n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)) & n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n0=QUES_VOTE&n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n1=QUES_VOTE&n1_vote_ts_seq0_r1_n2!=INVALID&n1_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n1_state_ts_seq0_r1_n1'=BOT)                                    & (n1_vote_ts_seq0_r1_n1'=INVALID) & (n1_stage_seq0'=p2s_stage) & (n1_round_0'=n1_round_0+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=1+1) & (n1_send_cmd_ts'=BOT);
    [n1_process_vote_for_seq0_r1_using_n1] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=1 & n1_round_0+1<MAX_ROUND & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n1!=INVALID)|(n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)) & n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n0=QUES_VOTE&n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n1=QUES_VOTE&n1_vote_ts_seq0_r1_n2!=INVALID&n1_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n1_state_ts_seq0_r1_n1'=n1_state_ts_seq0_r1_n1) & (n1_vote_ts_seq0_r1_n1'=INVALID) & (n1_stage_seq0'=p2s_stage) & (n1_round_0'=n1_round_0+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=1+1) & (n1_send_cmd_ts'=n1_state_ts_seq0_r1_n1);
    //// 3.fail: Out of rounds
    [n1_process_vote_for_seq0_r1_using_n1] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=1 & n1_round_0+1=MAX_ROUND & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n1!=INVALID)|(n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)) & n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n0=QUES_VOTE&n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n1=QUES_VOTE&n1_vote_ts_seq0_r1_n2!=INVALID&n1_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n1_log_ts_seq0'=OUT_OF_ROUND) & (n1_stage_seq0'=pre_decided_stage);
    [n1_process_vote_for_seq0_r1_using_n1] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=1 & n1_round_0+1=MAX_ROUND & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n1!=INVALID)|(n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)) & n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n0=QUES_VOTE&n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n1=QUES_VOTE&n1_vote_ts_seq0_r1_n2!=INVALID&n1_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n1_log_ts_seq0'=OUT_OF_ROUND) & (n1_stage_seq0'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 2 for seq0 at round1.
    [n1_process_vote_for_seq0_r1_using_n2] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=1 & n1_round_0+1<MAX_ROUND & (n1_vote_ts_seq0_r1_n2!=INVALID&n1_vote_ts_seq0_r1_n2!=QUES_VOTE) & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n1!=INVALID)|(n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)) & !((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n0=n1_vote_ts_seq0_r1_n2)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n1=n1_vote_ts_seq0_r1_n2)) ->         (n1_state_ts_seq0_r1_n1'=n1_vote_ts_seq0_r1_n2) & (n1_vote_ts_seq0_r1_n1'=INVALID) & (n1_stage_seq0'=p2s_stage) & (n1_round_0'=n1_round_0+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=1+1) & (n1_send_cmd_ts'=n1_state_ts_seq0_r1_n2);
    //// 2.fail: Out of rounds
    [n1_process_vote_for_seq0_r1_using_n2] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=1 & n1_round_0+1=MAX_ROUND & (n1_vote_ts_seq0_r1_n2!=INVALID&n1_vote_ts_seq0_r1_n2!=QUES_VOTE) & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n1!=INVALID)|(n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)) & !((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n0=n1_vote_ts_seq0_r1_n2)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n1=n1_vote_ts_seq0_r1_n2)) ->         (n1_log_ts_seq0'=OUT_OF_ROUND) & (n1_stage_seq0'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n1_process_vote_for_seq0_r1_using_n2] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=1 & n1_round_0+1<MAX_ROUND & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n1!=INVALID)|(n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)) & n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n0=QUES_VOTE&n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n1=QUES_VOTE&n1_vote_ts_seq0_r1_n2!=INVALID&n1_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n1_state_ts_seq0_r1_n1'=BOT)                                    & (n1_vote_ts_seq0_r1_n1'=INVALID) & (n1_stage_seq0'=p2s_stage) & (n1_round_0'=n1_round_0+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=1+1) & (n1_send_cmd_ts'=BOT);
    [n1_process_vote_for_seq0_r1_using_n2] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=1 & n1_round_0+1<MAX_ROUND & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n1!=INVALID)|(n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)) & n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n0=QUES_VOTE&n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n1=QUES_VOTE&n1_vote_ts_seq0_r1_n2!=INVALID&n1_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n1_state_ts_seq0_r1_n1'=n1_state_ts_seq0_r1_n2) & (n1_vote_ts_seq0_r1_n1'=INVALID) & (n1_stage_seq0'=p2s_stage) & (n1_round_0'=n1_round_0+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=0) & (n1_send_round'=1+1) & (n1_send_cmd_ts'=n1_state_ts_seq0_r1_n2);
    //// 3.fail: Out of rounds
    [n1_process_vote_for_seq0_r1_using_n2] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=1 & n1_round_0+1=MAX_ROUND & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n1!=INVALID)|(n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)) & n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n0=QUES_VOTE&n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n1=QUES_VOTE&n1_vote_ts_seq0_r1_n2!=INVALID&n1_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n1_log_ts_seq0'=OUT_OF_ROUND) & (n1_stage_seq0'=pre_decided_stage);
    [n1_process_vote_for_seq0_r1_using_n2] n1_stage_seq0=p2v_stage & n1_send_ready=false & n1_round_0=1 & n1_round_0+1=MAX_ROUND & ((n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n1!=INVALID)|(n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)|(n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n2!=INVALID)) & n1_vote_ts_seq0_r1_n0!=INVALID&n1_vote_ts_seq0_r1_n0=QUES_VOTE&n1_vote_ts_seq0_r1_n1!=INVALID&n1_vote_ts_seq0_r1_n1=QUES_VOTE&n1_vote_ts_seq0_r1_n2!=INVALID&n1_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n1_log_ts_seq0'=OUT_OF_ROUND) & (n1_stage_seq0'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 0 for seq1 at round0.
    [n1_process_vote_for_seq1_r0_using_n0] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=0 & n1_round_1+1<MAX_ROUND & (n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n0!=QUES_VOTE) & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n1!=INVALID)|(n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)) & !((n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n1=n1_vote_ts_seq1_r0_n0)|(n1_vote_ts_seq1_r0_n2!=INVALID&n1_vote_ts_seq1_r0_n2=n1_vote_ts_seq1_r0_n0)) ->         (n1_state_ts_seq1_r0_n1'=n1_vote_ts_seq1_r0_n0) & (n1_vote_ts_seq1_r0_n1'=INVALID) & (n1_stage_seq1'=p2s_stage) & (n1_round_1'=n1_round_1+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=0+1) & (n1_send_cmd_ts'=n1_state_ts_seq1_r0_n0);
    //// 2.fail: Out of rounds
    [n1_process_vote_for_seq1_r0_using_n0] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=0 & n1_round_1+1=MAX_ROUND & (n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n0!=QUES_VOTE) & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n1!=INVALID)|(n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)) & !((n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n1=n1_vote_ts_seq1_r0_n0)|(n1_vote_ts_seq1_r0_n2!=INVALID&n1_vote_ts_seq1_r0_n2=n1_vote_ts_seq1_r0_n0)) ->         (n1_log_ts_seq1'=OUT_OF_ROUND) & (n1_stage_seq1'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n1_process_vote_for_seq1_r0_using_n0] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=0 & n1_round_1+1<MAX_ROUND & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n1!=INVALID)|(n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)) & n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n0=QUES_VOTE&n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n1=QUES_VOTE&n1_vote_ts_seq1_r0_n2!=INVALID&n1_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n1_state_ts_seq1_r0_n1'=BOT)                                    & (n1_vote_ts_seq1_r0_n1'=INVALID) & (n1_stage_seq1'=p2s_stage) & (n1_round_1'=n1_round_1+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=0+1) & (n1_send_cmd_ts'=BOT);
    [n1_process_vote_for_seq1_r0_using_n0] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=0 & n1_round_1+1<MAX_ROUND & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n1!=INVALID)|(n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)) & n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n0=QUES_VOTE&n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n1=QUES_VOTE&n1_vote_ts_seq1_r0_n2!=INVALID&n1_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n1_state_ts_seq1_r0_n1'=n1_state_ts_seq1_r0_n0) & (n1_vote_ts_seq1_r0_n1'=INVALID) & (n1_stage_seq1'=p2s_stage) & (n1_round_1'=n1_round_1+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=0+1) & (n1_send_cmd_ts'=n1_state_ts_seq1_r0_n0);
    //// 3.fail: Out of rounds
    [n1_process_vote_for_seq1_r0_using_n0] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=0 & n1_round_1+1=MAX_ROUND & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n1!=INVALID)|(n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)) & n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n0=QUES_VOTE&n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n1=QUES_VOTE&n1_vote_ts_seq1_r0_n2!=INVALID&n1_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n1_log_ts_seq1'=OUT_OF_ROUND) & (n1_stage_seq1'=pre_decided_stage);
    [n1_process_vote_for_seq1_r0_using_n0] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=0 & n1_round_1+1=MAX_ROUND & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n1!=INVALID)|(n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)) & n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n0=QUES_VOTE&n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n1=QUES_VOTE&n1_vote_ts_seq1_r0_n2!=INVALID&n1_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n1_log_ts_seq1'=OUT_OF_ROUND) & (n1_stage_seq1'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 1 for seq1 at round0.
    [n1_process_vote_for_seq1_r0_using_n1] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=0 & n1_round_1+1<MAX_ROUND & (n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n1!=QUES_VOTE) & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n1!=INVALID)|(n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)) & !((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n0=n1_vote_ts_seq1_r0_n1)|(n1_vote_ts_seq1_r0_n2!=INVALID&n1_vote_ts_seq1_r0_n2=n1_vote_ts_seq1_r0_n1)) ->         (n1_state_ts_seq1_r0_n1'=n1_vote_ts_seq1_r0_n1) & (n1_vote_ts_seq1_r0_n1'=INVALID) & (n1_stage_seq1'=p2s_stage) & (n1_round_1'=n1_round_1+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=0+1) & (n1_send_cmd_ts'=n1_state_ts_seq1_r0_n1);
    //// 2.fail: Out of rounds
    [n1_process_vote_for_seq1_r0_using_n1] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=0 & n1_round_1+1=MAX_ROUND & (n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n1!=QUES_VOTE) & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n1!=INVALID)|(n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)) & !((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n0=n1_vote_ts_seq1_r0_n1)|(n1_vote_ts_seq1_r0_n2!=INVALID&n1_vote_ts_seq1_r0_n2=n1_vote_ts_seq1_r0_n1)) ->         (n1_log_ts_seq1'=OUT_OF_ROUND) & (n1_stage_seq1'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n1_process_vote_for_seq1_r0_using_n1] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=0 & n1_round_1+1<MAX_ROUND & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n1!=INVALID)|(n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)) & n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n0=QUES_VOTE&n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n1=QUES_VOTE&n1_vote_ts_seq1_r0_n2!=INVALID&n1_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n1_state_ts_seq1_r0_n1'=BOT)                                    & (n1_vote_ts_seq1_r0_n1'=INVALID) & (n1_stage_seq1'=p2s_stage) & (n1_round_1'=n1_round_1+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=0+1) & (n1_send_cmd_ts'=BOT);
    [n1_process_vote_for_seq1_r0_using_n1] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=0 & n1_round_1+1<MAX_ROUND & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n1!=INVALID)|(n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)) & n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n0=QUES_VOTE&n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n1=QUES_VOTE&n1_vote_ts_seq1_r0_n2!=INVALID&n1_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n1_state_ts_seq1_r0_n1'=n1_state_ts_seq1_r0_n1) & (n1_vote_ts_seq1_r0_n1'=INVALID) & (n1_stage_seq1'=p2s_stage) & (n1_round_1'=n1_round_1+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=0+1) & (n1_send_cmd_ts'=n1_state_ts_seq1_r0_n1);
    //// 3.fail: Out of rounds
    [n1_process_vote_for_seq1_r0_using_n1] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=0 & n1_round_1+1=MAX_ROUND & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n1!=INVALID)|(n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)) & n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n0=QUES_VOTE&n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n1=QUES_VOTE&n1_vote_ts_seq1_r0_n2!=INVALID&n1_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n1_log_ts_seq1'=OUT_OF_ROUND) & (n1_stage_seq1'=pre_decided_stage);
    [n1_process_vote_for_seq1_r0_using_n1] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=0 & n1_round_1+1=MAX_ROUND & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n1!=INVALID)|(n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)) & n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n0=QUES_VOTE&n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n1=QUES_VOTE&n1_vote_ts_seq1_r0_n2!=INVALID&n1_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n1_log_ts_seq1'=OUT_OF_ROUND) & (n1_stage_seq1'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 2 for seq1 at round0.
    [n1_process_vote_for_seq1_r0_using_n2] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=0 & n1_round_1+1<MAX_ROUND & (n1_vote_ts_seq1_r0_n2!=INVALID&n1_vote_ts_seq1_r0_n2!=QUES_VOTE) & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n1!=INVALID)|(n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)) & !((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n0=n1_vote_ts_seq1_r0_n2)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n1=n1_vote_ts_seq1_r0_n2)) ->         (n1_state_ts_seq1_r0_n1'=n1_vote_ts_seq1_r0_n2) & (n1_vote_ts_seq1_r0_n1'=INVALID) & (n1_stage_seq1'=p2s_stage) & (n1_round_1'=n1_round_1+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=0+1) & (n1_send_cmd_ts'=n1_state_ts_seq1_r0_n2);
    //// 2.fail: Out of rounds
    [n1_process_vote_for_seq1_r0_using_n2] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=0 & n1_round_1+1=MAX_ROUND & (n1_vote_ts_seq1_r0_n2!=INVALID&n1_vote_ts_seq1_r0_n2!=QUES_VOTE) & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n1!=INVALID)|(n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)) & !((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n0=n1_vote_ts_seq1_r0_n2)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n1=n1_vote_ts_seq1_r0_n2)) ->         (n1_log_ts_seq1'=OUT_OF_ROUND) & (n1_stage_seq1'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n1_process_vote_for_seq1_r0_using_n2] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=0 & n1_round_1+1<MAX_ROUND & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n1!=INVALID)|(n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)) & n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n0=QUES_VOTE&n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n1=QUES_VOTE&n1_vote_ts_seq1_r0_n2!=INVALID&n1_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n1_state_ts_seq1_r0_n1'=BOT)                                    & (n1_vote_ts_seq1_r0_n1'=INVALID) & (n1_stage_seq1'=p2s_stage) & (n1_round_1'=n1_round_1+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=0+1) & (n1_send_cmd_ts'=BOT);
    [n1_process_vote_for_seq1_r0_using_n2] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=0 & n1_round_1+1<MAX_ROUND & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n1!=INVALID)|(n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)) & n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n0=QUES_VOTE&n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n1=QUES_VOTE&n1_vote_ts_seq1_r0_n2!=INVALID&n1_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n1_state_ts_seq1_r0_n1'=n1_state_ts_seq1_r0_n2) & (n1_vote_ts_seq1_r0_n1'=INVALID) & (n1_stage_seq1'=p2s_stage) & (n1_round_1'=n1_round_1+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=0+1) & (n1_send_cmd_ts'=n1_state_ts_seq1_r0_n2);
    //// 3.fail: Out of rounds
    [n1_process_vote_for_seq1_r0_using_n2] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=0 & n1_round_1+1=MAX_ROUND & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n1!=INVALID)|(n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)) & n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n0=QUES_VOTE&n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n1=QUES_VOTE&n1_vote_ts_seq1_r0_n2!=INVALID&n1_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n1_log_ts_seq1'=OUT_OF_ROUND) & (n1_stage_seq1'=pre_decided_stage);
    [n1_process_vote_for_seq1_r0_using_n2] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=0 & n1_round_1+1=MAX_ROUND & ((n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n1!=INVALID)|(n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)|(n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n2!=INVALID)) & n1_vote_ts_seq1_r0_n0!=INVALID&n1_vote_ts_seq1_r0_n0=QUES_VOTE&n1_vote_ts_seq1_r0_n1!=INVALID&n1_vote_ts_seq1_r0_n1=QUES_VOTE&n1_vote_ts_seq1_r0_n2!=INVALID&n1_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n1_log_ts_seq1'=OUT_OF_ROUND) & (n1_stage_seq1'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 0 for seq1 at round1.
    [n1_process_vote_for_seq1_r1_using_n0] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=1 & n1_round_1+1<MAX_ROUND & (n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n0!=QUES_VOTE) & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n1!=INVALID)|(n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)) & !((n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n1=n1_vote_ts_seq1_r1_n0)|(n1_vote_ts_seq1_r1_n2!=INVALID&n1_vote_ts_seq1_r1_n2=n1_vote_ts_seq1_r1_n0)) ->         (n1_state_ts_seq1_r1_n1'=n1_vote_ts_seq1_r1_n0) & (n1_vote_ts_seq1_r1_n1'=INVALID) & (n1_stage_seq1'=p2s_stage) & (n1_round_1'=n1_round_1+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=1+1) & (n1_send_cmd_ts'=n1_state_ts_seq1_r1_n0);
    //// 2.fail: Out of rounds
    [n1_process_vote_for_seq1_r1_using_n0] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=1 & n1_round_1+1=MAX_ROUND & (n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n0!=QUES_VOTE) & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n1!=INVALID)|(n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)) & !((n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n1=n1_vote_ts_seq1_r1_n0)|(n1_vote_ts_seq1_r1_n2!=INVALID&n1_vote_ts_seq1_r1_n2=n1_vote_ts_seq1_r1_n0)) ->         (n1_log_ts_seq1'=OUT_OF_ROUND) & (n1_stage_seq1'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n1_process_vote_for_seq1_r1_using_n0] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=1 & n1_round_1+1<MAX_ROUND & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n1!=INVALID)|(n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)) & n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n0=QUES_VOTE&n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n1=QUES_VOTE&n1_vote_ts_seq1_r1_n2!=INVALID&n1_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n1_state_ts_seq1_r1_n1'=BOT)                                    & (n1_vote_ts_seq1_r1_n1'=INVALID) & (n1_stage_seq1'=p2s_stage) & (n1_round_1'=n1_round_1+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=1+1) & (n1_send_cmd_ts'=BOT);
    [n1_process_vote_for_seq1_r1_using_n0] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=1 & n1_round_1+1<MAX_ROUND & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n1!=INVALID)|(n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)) & n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n0=QUES_VOTE&n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n1=QUES_VOTE&n1_vote_ts_seq1_r1_n2!=INVALID&n1_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n1_state_ts_seq1_r1_n1'=n1_state_ts_seq1_r1_n0) & (n1_vote_ts_seq1_r1_n1'=INVALID) & (n1_stage_seq1'=p2s_stage) & (n1_round_1'=n1_round_1+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=1+1) & (n1_send_cmd_ts'=n1_state_ts_seq1_r1_n0);
    //// 3.fail: Out of rounds
    [n1_process_vote_for_seq1_r1_using_n0] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=1 & n1_round_1+1=MAX_ROUND & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n1!=INVALID)|(n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)) & n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n0=QUES_VOTE&n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n1=QUES_VOTE&n1_vote_ts_seq1_r1_n2!=INVALID&n1_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n1_log_ts_seq1'=OUT_OF_ROUND) & (n1_stage_seq1'=pre_decided_stage);
    [n1_process_vote_for_seq1_r1_using_n0] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=1 & n1_round_1+1=MAX_ROUND & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n1!=INVALID)|(n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)) & n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n0=QUES_VOTE&n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n1=QUES_VOTE&n1_vote_ts_seq1_r1_n2!=INVALID&n1_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n1_log_ts_seq1'=OUT_OF_ROUND) & (n1_stage_seq1'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 1 for seq1 at round1.
    [n1_process_vote_for_seq1_r1_using_n1] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=1 & n1_round_1+1<MAX_ROUND & (n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n1!=QUES_VOTE) & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n1!=INVALID)|(n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)) & !((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n0=n1_vote_ts_seq1_r1_n1)|(n1_vote_ts_seq1_r1_n2!=INVALID&n1_vote_ts_seq1_r1_n2=n1_vote_ts_seq1_r1_n1)) ->         (n1_state_ts_seq1_r1_n1'=n1_vote_ts_seq1_r1_n1) & (n1_vote_ts_seq1_r1_n1'=INVALID) & (n1_stage_seq1'=p2s_stage) & (n1_round_1'=n1_round_1+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=1+1) & (n1_send_cmd_ts'=n1_state_ts_seq1_r1_n1);
    //// 2.fail: Out of rounds
    [n1_process_vote_for_seq1_r1_using_n1] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=1 & n1_round_1+1=MAX_ROUND & (n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n1!=QUES_VOTE) & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n1!=INVALID)|(n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)) & !((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n0=n1_vote_ts_seq1_r1_n1)|(n1_vote_ts_seq1_r1_n2!=INVALID&n1_vote_ts_seq1_r1_n2=n1_vote_ts_seq1_r1_n1)) ->         (n1_log_ts_seq1'=OUT_OF_ROUND) & (n1_stage_seq1'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n1_process_vote_for_seq1_r1_using_n1] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=1 & n1_round_1+1<MAX_ROUND & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n1!=INVALID)|(n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)) & n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n0=QUES_VOTE&n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n1=QUES_VOTE&n1_vote_ts_seq1_r1_n2!=INVALID&n1_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n1_state_ts_seq1_r1_n1'=BOT)                                    & (n1_vote_ts_seq1_r1_n1'=INVALID) & (n1_stage_seq1'=p2s_stage) & (n1_round_1'=n1_round_1+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=1+1) & (n1_send_cmd_ts'=BOT);
    [n1_process_vote_for_seq1_r1_using_n1] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=1 & n1_round_1+1<MAX_ROUND & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n1!=INVALID)|(n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)) & n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n0=QUES_VOTE&n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n1=QUES_VOTE&n1_vote_ts_seq1_r1_n2!=INVALID&n1_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n1_state_ts_seq1_r1_n1'=n1_state_ts_seq1_r1_n1) & (n1_vote_ts_seq1_r1_n1'=INVALID) & (n1_stage_seq1'=p2s_stage) & (n1_round_1'=n1_round_1+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=1+1) & (n1_send_cmd_ts'=n1_state_ts_seq1_r1_n1);
    //// 3.fail: Out of rounds
    [n1_process_vote_for_seq1_r1_using_n1] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=1 & n1_round_1+1=MAX_ROUND & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n1!=INVALID)|(n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)) & n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n0=QUES_VOTE&n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n1=QUES_VOTE&n1_vote_ts_seq1_r1_n2!=INVALID&n1_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n1_log_ts_seq1'=OUT_OF_ROUND) & (n1_stage_seq1'=pre_decided_stage);
    [n1_process_vote_for_seq1_r1_using_n1] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=1 & n1_round_1+1=MAX_ROUND & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n1!=INVALID)|(n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)) & n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n0=QUES_VOTE&n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n1=QUES_VOTE&n1_vote_ts_seq1_r1_n2!=INVALID&n1_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n1_log_ts_seq1'=OUT_OF_ROUND) & (n1_stage_seq1'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 2 for seq1 at round1.
    [n1_process_vote_for_seq1_r1_using_n2] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=1 & n1_round_1+1<MAX_ROUND & (n1_vote_ts_seq1_r1_n2!=INVALID&n1_vote_ts_seq1_r1_n2!=QUES_VOTE) & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n1!=INVALID)|(n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)) & !((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n0=n1_vote_ts_seq1_r1_n2)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n1=n1_vote_ts_seq1_r1_n2)) ->         (n1_state_ts_seq1_r1_n1'=n1_vote_ts_seq1_r1_n2) & (n1_vote_ts_seq1_r1_n1'=INVALID) & (n1_stage_seq1'=p2s_stage) & (n1_round_1'=n1_round_1+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=1+1) & (n1_send_cmd_ts'=n1_state_ts_seq1_r1_n2);
    //// 2.fail: Out of rounds
    [n1_process_vote_for_seq1_r1_using_n2] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=1 & n1_round_1+1=MAX_ROUND & (n1_vote_ts_seq1_r1_n2!=INVALID&n1_vote_ts_seq1_r1_n2!=QUES_VOTE) & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n1!=INVALID)|(n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)) & !((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n0=n1_vote_ts_seq1_r1_n2)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n1=n1_vote_ts_seq1_r1_n2)) ->         (n1_log_ts_seq1'=OUT_OF_ROUND) & (n1_stage_seq1'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n1_process_vote_for_seq1_r1_using_n2] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=1 & n1_round_1+1<MAX_ROUND & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n1!=INVALID)|(n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)) & n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n0=QUES_VOTE&n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n1=QUES_VOTE&n1_vote_ts_seq1_r1_n2!=INVALID&n1_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n1_state_ts_seq1_r1_n1'=BOT)                                    & (n1_vote_ts_seq1_r1_n1'=INVALID) & (n1_stage_seq1'=p2s_stage) & (n1_round_1'=n1_round_1+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=1+1) & (n1_send_cmd_ts'=BOT);
    [n1_process_vote_for_seq1_r1_using_n2] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=1 & n1_round_1+1<MAX_ROUND & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n1!=INVALID)|(n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)) & n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n0=QUES_VOTE&n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n1=QUES_VOTE&n1_vote_ts_seq1_r1_n2!=INVALID&n1_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n1_state_ts_seq1_r1_n1'=n1_state_ts_seq1_r1_n2) & (n1_vote_ts_seq1_r1_n1'=INVALID) & (n1_stage_seq1'=p2s_stage) & (n1_round_1'=n1_round_1+1) & (n1_send_ready'=true) & (n1_send_is_broadcast'=true) & (n1_send_type'=cmd_state) & (n1_send_seq'=1) & (n1_send_round'=1+1) & (n1_send_cmd_ts'=n1_state_ts_seq1_r1_n2);
    //// 3.fail: Out of rounds
    [n1_process_vote_for_seq1_r1_using_n2] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=1 & n1_round_1+1=MAX_ROUND & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n1!=INVALID)|(n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)) & n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n0=QUES_VOTE&n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n1=QUES_VOTE&n1_vote_ts_seq1_r1_n2!=INVALID&n1_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n1_log_ts_seq1'=OUT_OF_ROUND) & (n1_stage_seq1'=pre_decided_stage);
    [n1_process_vote_for_seq1_r1_using_n2] n1_stage_seq1=p2v_stage & n1_send_ready=false & n1_round_1=1 & n1_round_1+1=MAX_ROUND & ((n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n1!=INVALID)|(n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)|(n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n2!=INVALID)) & n1_vote_ts_seq1_r1_n0!=INVALID&n1_vote_ts_seq1_r1_n0=QUES_VOTE&n1_vote_ts_seq1_r1_n1!=INVALID&n1_vote_ts_seq1_r1_n1=QUES_VOTE&n1_vote_ts_seq1_r1_n2!=INVALID&n1_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n1_log_ts_seq1'=OUT_OF_ROUND) & (n1_stage_seq1'=pre_decided_stage);

    // Pre-decided 
    // Success case, directly go to decided 
    [n1_pre_decided_stage_seq0] n1_stage_seq0=pre_decided_stage & n1_log_ts_seq0!=OUT_OF_ROUND & n1_seq+1<LOG_SIZE -> (n1_stage_seq0'=decided) & (n1_seq'=n1_seq+1);
    [n1_pre_decided_stage_seq0] n1_stage_seq0=pre_decided_stage & n1_log_ts_seq0!=OUT_OF_ROUND & n1_seq+1=LOG_SIZE -> (n1_stage_seq0'=decided);
    // Success case, directly go to decided 
    [n1_pre_decided_stage_seq1] n1_stage_seq1=pre_decided_stage & n1_log_ts_seq1!=OUT_OF_ROUND & n1_seq+1<LOG_SIZE -> (n1_stage_seq1'=decided) & (n1_seq'=n1_seq+1);
    [n1_pre_decided_stage_seq1] n1_stage_seq1=pre_decided_stage & n1_log_ts_seq1!=OUT_OF_ROUND & n1_seq+1=LOG_SIZE -> (n1_stage_seq1'=decided);
    // Failed case, put my proposal back to q0
    [n1_pre_decided_stage_seq0_using_q0] n1_stage_seq0=pre_decided_stage & n1_log_ts_seq0=OUT_OF_ROUND & n1_pq_valid_0=false & n1_seq+1<LOG_SIZE -> (n1_stage_seq0'=decided) & (n1_pq_valid_0'=true) & (n1_pq_ts_0'=n1_proposal_seq0_r0_n1) & (n1_seq'=n1_seq+1);
    [n1_pre_decided_stage_seq0_using_q0] n1_stage_seq0=pre_decided_stage & n1_log_ts_seq0=OUT_OF_ROUND & n1_pq_valid_0=false & n1_seq+1=LOG_SIZE -> (n1_stage_seq0'=decided) & (n1_pq_valid_0'=true) & (n1_pq_ts_0'=n1_proposal_seq0_r0_n1);
    // Failed case, put my proposal back to q1
    [n1_pre_decided_stage_seq0_using_q1] n1_stage_seq0=pre_decided_stage & n1_log_ts_seq0=OUT_OF_ROUND & n1_pq_valid_1=false & n1_seq+1<LOG_SIZE -> (n1_stage_seq0'=decided) & (n1_pq_valid_1'=true) & (n1_pq_ts_1'=n1_proposal_seq0_r0_n1) & (n1_seq'=n1_seq+1);
    [n1_pre_decided_stage_seq0_using_q1] n1_stage_seq0=pre_decided_stage & n1_log_ts_seq0=OUT_OF_ROUND & n1_pq_valid_1=false & n1_seq+1=LOG_SIZE -> (n1_stage_seq0'=decided) & (n1_pq_valid_1'=true) & (n1_pq_ts_1'=n1_proposal_seq0_r0_n1);
    // Failed case, put my proposal back to q0
    [n1_pre_decided_stage_seq1_using_q0] n1_stage_seq1=pre_decided_stage & n1_log_ts_seq1=OUT_OF_ROUND & n1_pq_valid_0=false & n1_seq+1<LOG_SIZE -> (n1_stage_seq1'=decided) & (n1_pq_valid_0'=true) & (n1_pq_ts_0'=n1_proposal_seq1_r0_n1) & (n1_seq'=n1_seq+1);
    [n1_pre_decided_stage_seq1_using_q0] n1_stage_seq1=pre_decided_stage & n1_log_ts_seq1=OUT_OF_ROUND & n1_pq_valid_0=false & n1_seq+1=LOG_SIZE -> (n1_stage_seq1'=decided) & (n1_pq_valid_0'=true) & (n1_pq_ts_0'=n1_proposal_seq1_r0_n1);
    // Failed case, put my proposal back to q1
    [n1_pre_decided_stage_seq1_using_q1] n1_stage_seq1=pre_decided_stage & n1_log_ts_seq1=OUT_OF_ROUND & n1_pq_valid_1=false & n1_seq+1<LOG_SIZE -> (n1_stage_seq1'=decided) & (n1_pq_valid_1'=true) & (n1_pq_ts_1'=n1_proposal_seq1_r0_n1) & (n1_seq'=n1_seq+1);
    [n1_pre_decided_stage_seq1_using_q1] n1_stage_seq1=pre_decided_stage & n1_log_ts_seq1=OUT_OF_ROUND & n1_pq_valid_1=false & n1_seq+1=LOG_SIZE -> (n1_stage_seq1'=decided) & (n1_pq_valid_1'=true) & (n1_pq_ts_1'=n1_proposal_seq1_r0_n1);
                                                                                                                                                                                                                                                                           
    // Receive and process_decided
    [n1_receive_and_process_decided_for_seq0] n1_recv_ready=true & n1_recv_type=cmd_decided & n1_recv_seq=0 & n1_stage_seq0!=decided & n1_seq+1<LOG_SIZE -> (n1_recv_ready'=false) & (n1_log_ts_seq0'=n1_recv_cmd_ts) & (n1_stage_seq0'=decided) & (n1_seq'=n1_seq+1);
    [n1_receive_and_process_decided_for_seq0] n1_recv_ready=true & n1_recv_type=cmd_decided & n1_recv_seq=0 & n1_stage_seq0!=decided & n1_seq+1=LOG_SIZE -> (n1_recv_ready'=false) & (n1_log_ts_seq0'=n1_recv_cmd_ts) & (n1_stage_seq0'=decided);
    [n1_receive_and_process_decided_for_seq0] n1_recv_ready=true & n1_recv_type=cmd_decided & n1_recv_seq=0 & n1_stage_seq0=decided  -> (n1_recv_ready'=false);
                                                                                                                                                                                                                                                                           
    // Receive and process_decided
    [n1_receive_and_process_decided_for_seq1] n1_recv_ready=true & n1_recv_type=cmd_decided & n1_recv_seq=1 & n1_stage_seq1!=decided & n1_seq+1<LOG_SIZE -> (n1_recv_ready'=false) & (n1_log_ts_seq1'=n1_recv_cmd_ts) & (n1_stage_seq1'=decided) & (n1_seq'=n1_seq+1);
    [n1_receive_and_process_decided_for_seq1] n1_recv_ready=true & n1_recv_type=cmd_decided & n1_recv_seq=1 & n1_stage_seq1!=decided & n1_seq+1=LOG_SIZE -> (n1_recv_ready'=false) & (n1_log_ts_seq1'=n1_recv_cmd_ts) & (n1_stage_seq1'=decided);
    [n1_receive_and_process_decided_for_seq1] n1_recv_ready=true & n1_recv_type=cmd_decided & n1_recv_seq=1 & n1_stage_seq1=decided  -> (n1_recv_ready'=false);

    // Send when a pkt is ready; Recv when a pkt is ready.
    [recv_01_0] n1_recv_ready=false ->         (n1_recv_ready'=true) & (n1_recv_from'=0) & (n1_recv_type'=w01_pkt_type_0) & (n1_recv_seq'=w01_pkt_seq_0) & (n1_recv_round'=w01_pkt_round_0) & (n1_recv_cmd_ts'=w01_pkt_cmd_ts_0);
    [send_10_0] n1_send_ready=true & n1_send_is_broadcast=false -> (n1_send_ready'=false);
    [recv_21_0] n1_recv_ready=false ->         (n1_recv_ready'=true) & (n1_recv_from'=2) & (n1_recv_type'=w21_pkt_type_0) & (n1_recv_seq'=w21_pkt_seq_0) & (n1_recv_round'=w21_pkt_round_0) & (n1_recv_cmd_ts'=w21_pkt_cmd_ts_0);
    [send_12_0] n1_send_ready=true & n1_send_is_broadcast=false -> (n1_send_ready'=false);
    [recv_01_1] n1_recv_ready=false ->         (n1_recv_ready'=true) & (n1_recv_from'=0) & (n1_recv_type'=w01_pkt_type_1) & (n1_recv_seq'=w01_pkt_seq_1) & (n1_recv_round'=w01_pkt_round_1) & (n1_recv_cmd_ts'=w01_pkt_cmd_ts_1);
    [send_10_1] n1_send_ready=true & n1_send_is_broadcast=false -> (n1_send_ready'=false);
    [recv_21_1] n1_recv_ready=false ->         (n1_recv_ready'=true) & (n1_recv_from'=2) & (n1_recv_type'=w21_pkt_type_1) & (n1_recv_seq'=w21_pkt_seq_1) & (n1_recv_round'=w21_pkt_round_1) & (n1_recv_cmd_ts'=w21_pkt_cmd_ts_1);
    [send_12_1] n1_send_ready=true & n1_send_is_broadcast=false -> (n1_send_ready'=false);
    [n1_send_broadcast] n1_send_ready=true & n1_send_is_broadcast=true -> (n1_send_ready'=false);

endmodule


module node2
    // states
    n2_seq : [0..LOG_SIZE] init 0;
    /// p1 stage
    n2_pq_valid_0 : bool init true;
    n2_pq_ts_0 : [MIN_TS_VALUE..MAX_TS] init 1;
    n2_pq_valid_1 : bool init false;
    n2_pq_ts_1 : [MIN_TS_VALUE..MAX_TS] init 0;
    n2_stage_seq0 : [0..NUM_STATES] init p0_bc_cmd_stage;
    n2_log_ts_seq0 : [MIN_TS_VALUE..MAX_TS] init INVALID; 
    n2_stage_seq1 : [0..NUM_STATES] init p0_bc_cmd_stage;
    n2_log_ts_seq1 : [MIN_TS_VALUE..MAX_TS] init INVALID; 
    /// p2 stage
    n2_round_0 : [0..MAX_ROUND] init 0; 
    n2_round_1 : [0..MAX_ROUND] init 0; 
    n2_proposal_seq0_r0_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_state_ts_seq0_r0_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_vote_ts_seq0_r0_n0 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n2_proposal_seq0_r0_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_state_ts_seq0_r0_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_vote_ts_seq0_r0_n1 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n2_proposal_seq0_r0_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_state_ts_seq0_r0_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_vote_ts_seq0_r0_n2 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n2_proposal_seq0_r1_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_state_ts_seq0_r1_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_vote_ts_seq0_r1_n0 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n2_proposal_seq0_r1_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_state_ts_seq0_r1_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_vote_ts_seq0_r1_n1 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n2_proposal_seq0_r1_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_state_ts_seq0_r1_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_vote_ts_seq0_r1_n2 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n2_proposal_seq1_r0_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_state_ts_seq1_r0_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_vote_ts_seq1_r0_n0 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n2_proposal_seq1_r0_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_state_ts_seq1_r0_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_vote_ts_seq1_r0_n1 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n2_proposal_seq1_r0_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_state_ts_seq1_r0_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_vote_ts_seq1_r0_n2 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n2_proposal_seq1_r1_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_state_ts_seq1_r1_n0 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_vote_ts_seq1_r1_n0 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n2_proposal_seq1_r1_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_state_ts_seq1_r1_n1 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_vote_ts_seq1_r1_n1 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;
    n2_proposal_seq1_r1_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_state_ts_seq1_r1_n2 : [MIN_TS_VALUE..MAX_TS] init INVALID;
    n2_vote_ts_seq1_r1_n2 : [MIN_VOTE_VALUE..MAX_TS] init INVALID;

    // pkt to send
    n2_send_ready : bool init false; // ready means not yet sent
    n2_send_is_broadcast : bool init false;
    n2_send_type : [0..NUM_CMD_TYPES] init 0;
    n2_send_seq : [0..LOG_SIZE] init 0;
    n2_send_round : [0..MAX_ROUND] init 0;
    n2_send_cmd_ts : [MIN_TS_VALUE..MAX_TS] init 0;

    // pkt received
    n2_recv_ready : bool init false; // ready means received
    n2_recv_from : [0..NUM_NODES] init 0;
    n2_recv_type : [0..NUM_CMD_TYPES] init 0;
    n2_recv_seq : [0..LOG_SIZE] init 0;
    n2_recv_round : [0..MAX_ROUND] init 0;
    n2_recv_cmd_ts : [MIN_TS_VALUE..MAX_TS] init 0;
    
    // Try on each queue slot and execute if the slot has min ts
    [n2_propose_next_command_for_seq0_using_q0] n2_stage_seq0=p0_bc_cmd_stage & n2_send_ready=false & n2_seq=0 & n2_pq_valid_0=true & (!n2_pq_valid_0|n2_pq_ts_0>=n2_pq_ts_0)&(!n2_pq_valid_1|n2_pq_ts_1>=n2_pq_ts_0) ->         (n2_stage_seq0'=p1_stage) & (n2_round_0'=0) & (n2_proposal_seq0_r0_n2'=n2_pq_ts_0) & (n2_pq_valid_0'=false) & (n2_pq_ts_0'=0) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_proposal) & (n2_send_seq'=0) & (n2_send_round'=0) & (n2_send_cmd_ts'=n2_pq_ts_0);
    [n2_propose_next_command_for_seq1_using_q0] n2_stage_seq1=p0_bc_cmd_stage & n2_send_ready=false & n2_seq=1 & n2_pq_valid_0=true & (!n2_pq_valid_0|n2_pq_ts_0>=n2_pq_ts_0)&(!n2_pq_valid_1|n2_pq_ts_1>=n2_pq_ts_0) ->         (n2_stage_seq1'=p1_stage) & (n2_round_1'=0) & (n2_proposal_seq1_r0_n2'=n2_pq_ts_0) & (n2_pq_valid_0'=false) & (n2_pq_ts_0'=0) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_proposal) & (n2_send_seq'=1) & (n2_send_round'=0) & (n2_send_cmd_ts'=n2_pq_ts_0);
    [n2_propose_next_command_for_seq0_using_q1] n2_stage_seq0=p0_bc_cmd_stage & n2_send_ready=false & n2_seq=0 & n2_pq_valid_1=true & (!n2_pq_valid_0|n2_pq_ts_0>=n2_pq_ts_1)&(!n2_pq_valid_1|n2_pq_ts_1>=n2_pq_ts_1) ->         (n2_stage_seq0'=p1_stage) & (n2_round_0'=0) & (n2_proposal_seq0_r0_n2'=n2_pq_ts_1) & (n2_pq_valid_1'=false) & (n2_pq_ts_1'=0) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_proposal) & (n2_send_seq'=0) & (n2_send_round'=0) & (n2_send_cmd_ts'=n2_pq_ts_1);
    [n2_propose_next_command_for_seq1_using_q1] n2_stage_seq1=p0_bc_cmd_stage & n2_send_ready=false & n2_seq=1 & n2_pq_valid_1=true & (!n2_pq_valid_0|n2_pq_ts_0>=n2_pq_ts_1)&(!n2_pq_valid_1|n2_pq_ts_1>=n2_pq_ts_1) ->         (n2_stage_seq1'=p1_stage) & (n2_round_1'=0) & (n2_proposal_seq1_r0_n2'=n2_pq_ts_1) & (n2_pq_valid_1'=false) & (n2_pq_ts_1'=0) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_proposal) & (n2_send_seq'=1) & (n2_send_round'=0) & (n2_send_cmd_ts'=n2_pq_ts_1);
    
    // Process when a Proposal pkt is ready.
    // Received an old proposal for seq0, reply decided.
    [n2_receive_proposal_from_old_seq0_reply_decided]   n2_recv_ready=true & n2_recv_type=cmd_proposal & n2_recv_seq=0 & (n2_stage_seq0=decided) ->         (n2_recv_ready'=false) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_decided) & (n2_send_seq'=0) & (n2_send_cmd_ts'=n2_log_ts_seq0);
    // Received an old proposal for seq1, reply decided.
    [n2_receive_proposal_from_old_seq1_reply_decided]   n2_recv_ready=true & n2_recv_type=cmd_proposal & n2_recv_seq=1 & (n2_stage_seq1=decided) ->         (n2_recv_ready'=false) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_decided) & (n2_send_seq'=1) & (n2_send_cmd_ts'=n2_log_ts_seq1); 
    // Receive the proposal from node 0 for non-decided seq0, round0. (TODO: update this, proposal can actually from round0)
    [n2_receive_proposal_from_n0_for_seq0_r0] n2_recv_ready=true & n2_recv_from=0 & n2_recv_type=cmd_proposal & n2_recv_seq=0 & n2_recv_round=0 & (n2_stage_seq0!=decided) ->         (n2_recv_ready'=false) & (n2_proposal_seq0_r0_n0'=n2_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq0, round0. (TODO: update this, proposal can actually from round0)
    [n2_receive_proposal_from_n1_for_seq0_r0] n2_recv_ready=true & n2_recv_from=1 & n2_recv_type=cmd_proposal & n2_recv_seq=0 & n2_recv_round=0 & (n2_stage_seq0!=decided) ->         (n2_recv_ready'=false) & (n2_proposal_seq0_r0_n1'=n2_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq0, round0. (TODO: update this, proposal can actually from round0)
    [n2_receive_proposal_from_n2_for_seq0_r0] n2_recv_ready=true & n2_recv_from=2 & n2_recv_type=cmd_proposal & n2_recv_seq=0 & n2_recv_round=0 & (n2_stage_seq0!=decided) ->         (n2_recv_ready'=false) & (n2_proposal_seq0_r0_n2'=n2_recv_cmd_ts); 
    // Receive the proposal from node 0 for non-decided seq0, round1. (TODO: update this, proposal can actually from round0)
    [n2_receive_proposal_from_n0_for_seq0_r1] n2_recv_ready=true & n2_recv_from=0 & n2_recv_type=cmd_proposal & n2_recv_seq=0 & n2_recv_round=1 & (n2_stage_seq0!=decided) ->         (n2_recv_ready'=false) & (n2_proposal_seq0_r1_n0'=n2_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq0, round1. (TODO: update this, proposal can actually from round0)
    [n2_receive_proposal_from_n1_for_seq0_r1] n2_recv_ready=true & n2_recv_from=1 & n2_recv_type=cmd_proposal & n2_recv_seq=0 & n2_recv_round=1 & (n2_stage_seq0!=decided) ->         (n2_recv_ready'=false) & (n2_proposal_seq0_r1_n1'=n2_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq0, round1. (TODO: update this, proposal can actually from round0)
    [n2_receive_proposal_from_n2_for_seq0_r1] n2_recv_ready=true & n2_recv_from=2 & n2_recv_type=cmd_proposal & n2_recv_seq=0 & n2_recv_round=1 & (n2_stage_seq0!=decided) ->         (n2_recv_ready'=false) & (n2_proposal_seq0_r1_n2'=n2_recv_cmd_ts); 
    // Receive the proposal from node 0 for non-decided seq1, round0. (TODO: update this, proposal can actually from round0)
    [n2_receive_proposal_from_n0_for_seq1_r0] n2_recv_ready=true & n2_recv_from=0 & n2_recv_type=cmd_proposal & n2_recv_seq=1 & n2_recv_round=0 & (n2_stage_seq1!=decided) ->         (n2_recv_ready'=false) & (n2_proposal_seq1_r0_n0'=n2_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq1, round0. (TODO: update this, proposal can actually from round0)
    [n2_receive_proposal_from_n1_for_seq1_r0] n2_recv_ready=true & n2_recv_from=1 & n2_recv_type=cmd_proposal & n2_recv_seq=1 & n2_recv_round=0 & (n2_stage_seq1!=decided) ->         (n2_recv_ready'=false) & (n2_proposal_seq1_r0_n1'=n2_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq1, round0. (TODO: update this, proposal can actually from round0)
    [n2_receive_proposal_from_n2_for_seq1_r0] n2_recv_ready=true & n2_recv_from=2 & n2_recv_type=cmd_proposal & n2_recv_seq=1 & n2_recv_round=0 & (n2_stage_seq1!=decided) ->         (n2_recv_ready'=false) & (n2_proposal_seq1_r0_n2'=n2_recv_cmd_ts); 
    // Receive the proposal from node 0 for non-decided seq1, round1. (TODO: update this, proposal can actually from round0)
    [n2_receive_proposal_from_n0_for_seq1_r1] n2_recv_ready=true & n2_recv_from=0 & n2_recv_type=cmd_proposal & n2_recv_seq=1 & n2_recv_round=1 & (n2_stage_seq1!=decided) ->         (n2_recv_ready'=false) & (n2_proposal_seq1_r1_n0'=n2_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq1, round1. (TODO: update this, proposal can actually from round0)
    [n2_receive_proposal_from_n1_for_seq1_r1] n2_recv_ready=true & n2_recv_from=1 & n2_recv_type=cmd_proposal & n2_recv_seq=1 & n2_recv_round=1 & (n2_stage_seq1!=decided) ->         (n2_recv_ready'=false) & (n2_proposal_seq1_r1_n1'=n2_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq1, round1. (TODO: update this, proposal can actually from round0)
    [n2_receive_proposal_from_n2_for_seq1_r1] n2_recv_ready=true & n2_recv_from=2 & n2_recv_type=cmd_proposal & n2_recv_seq=1 & n2_recv_round=1 & (n2_stage_seq1!=decided) ->         (n2_recv_ready'=false) & (n2_proposal_seq1_r1_n2'=n2_recv_cmd_ts); 

    // 1. When we have enough proposals, assign the state using the proposal from node 0 for seq0 at round0.
    [n2_process_proposal_assign_state_seq0_r0_using_n0] n2_stage_seq0=p1_stage & n2_round_0=0 & n2_send_ready=false & ((n2_proposal_seq0_r0_n0!=INVALID&n2_proposal_seq0_r0_n1!=INVALID)|(n2_proposal_seq0_r0_n0!=INVALID&n2_proposal_seq0_r0_n2!=INVALID)|(n2_proposal_seq0_r0_n1!=INVALID&n2_proposal_seq0_r0_n2!=INVALID)) & ((n2_proposal_seq0_r0_n1!=INVALID&n2_proposal_seq0_r0_n1=n2_proposal_seq0_r0_n0)|(n2_proposal_seq0_r0_n2!=INVALID&n2_proposal_seq0_r0_n2=n2_proposal_seq0_r0_n0)) ->         (n2_state_ts_seq0_r0_n2'=n2_proposal_seq0_r0_n0) & (n2_stage_seq0'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=0) & (n2_send_cmd_ts'=n2_proposal_seq0_r0_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign BOT.
    [n2_process_proposal_assign_state_seq0_r0_using_n0] n2_stage_seq0=p1_stage & n2_round_0=0 & n2_send_ready=false & ((n2_proposal_seq0_r0_n0!=INVALID&n2_proposal_seq0_r0_n1!=INVALID)|(n2_proposal_seq0_r0_n0!=INVALID&n2_proposal_seq0_r0_n2!=INVALID)|(n2_proposal_seq0_r0_n1!=INVALID&n2_proposal_seq0_r0_n2!=INVALID)) & !((n2_proposal_seq0_r0_n1!=INVALID&n2_proposal_seq0_r0_n1=n2_proposal_seq0_r0_n0)|(n2_proposal_seq0_r0_n2!=INVALID&n2_proposal_seq0_r0_n2=n2_proposal_seq0_r0_n0)) ->         (n2_state_ts_seq0_r0_n2'=BOT)                                    & (n2_stage_seq0'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=0) & (n2_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 1 for seq0 at round0.
    [n2_process_proposal_assign_state_seq0_r0_using_n1] n2_stage_seq0=p1_stage & n2_round_0=0 & n2_send_ready=false & ((n2_proposal_seq0_r0_n0!=INVALID&n2_proposal_seq0_r0_n1!=INVALID)|(n2_proposal_seq0_r0_n0!=INVALID&n2_proposal_seq0_r0_n2!=INVALID)|(n2_proposal_seq0_r0_n1!=INVALID&n2_proposal_seq0_r0_n2!=INVALID)) & ((n2_proposal_seq0_r0_n0!=INVALID&n2_proposal_seq0_r0_n0=n2_proposal_seq0_r0_n1)|(n2_proposal_seq0_r0_n2!=INVALID&n2_proposal_seq0_r0_n2=n2_proposal_seq0_r0_n1)) ->         (n2_state_ts_seq0_r0_n2'=n2_proposal_seq0_r0_n1) & (n2_stage_seq0'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=0) & (n2_send_cmd_ts'=n2_proposal_seq0_r0_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign BOT.
    [n2_process_proposal_assign_state_seq0_r0_using_n1] n2_stage_seq0=p1_stage & n2_round_0=0 & n2_send_ready=false & ((n2_proposal_seq0_r0_n0!=INVALID&n2_proposal_seq0_r0_n1!=INVALID)|(n2_proposal_seq0_r0_n0!=INVALID&n2_proposal_seq0_r0_n2!=INVALID)|(n2_proposal_seq0_r0_n1!=INVALID&n2_proposal_seq0_r0_n2!=INVALID)) & !((n2_proposal_seq0_r0_n0!=INVALID&n2_proposal_seq0_r0_n0=n2_proposal_seq0_r0_n1)|(n2_proposal_seq0_r0_n2!=INVALID&n2_proposal_seq0_r0_n2=n2_proposal_seq0_r0_n1)) ->         (n2_state_ts_seq0_r0_n2'=BOT)                                    & (n2_stage_seq0'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=0) & (n2_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 2 for seq0 at round0.
    [n2_process_proposal_assign_state_seq0_r0_using_n2] n2_stage_seq0=p1_stage & n2_round_0=0 & n2_send_ready=false & ((n2_proposal_seq0_r0_n0!=INVALID&n2_proposal_seq0_r0_n1!=INVALID)|(n2_proposal_seq0_r0_n0!=INVALID&n2_proposal_seq0_r0_n2!=INVALID)|(n2_proposal_seq0_r0_n1!=INVALID&n2_proposal_seq0_r0_n2!=INVALID)) & ((n2_proposal_seq0_r0_n0!=INVALID&n2_proposal_seq0_r0_n0=n2_proposal_seq0_r0_n2)|(n2_proposal_seq0_r0_n1!=INVALID&n2_proposal_seq0_r0_n1=n2_proposal_seq0_r0_n2)) ->         (n2_state_ts_seq0_r0_n2'=n2_proposal_seq0_r0_n2) & (n2_stage_seq0'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=0) & (n2_send_cmd_ts'=n2_proposal_seq0_r0_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign BOT.
    [n2_process_proposal_assign_state_seq0_r0_using_n2] n2_stage_seq0=p1_stage & n2_round_0=0 & n2_send_ready=false & ((n2_proposal_seq0_r0_n0!=INVALID&n2_proposal_seq0_r0_n1!=INVALID)|(n2_proposal_seq0_r0_n0!=INVALID&n2_proposal_seq0_r0_n2!=INVALID)|(n2_proposal_seq0_r0_n1!=INVALID&n2_proposal_seq0_r0_n2!=INVALID)) & !((n2_proposal_seq0_r0_n0!=INVALID&n2_proposal_seq0_r0_n0=n2_proposal_seq0_r0_n2)|(n2_proposal_seq0_r0_n1!=INVALID&n2_proposal_seq0_r0_n1=n2_proposal_seq0_r0_n2)) ->         (n2_state_ts_seq0_r0_n2'=BOT)                                    & (n2_stage_seq0'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=0) & (n2_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 0 for seq0 at round1.
    [n2_process_proposal_assign_state_seq0_r1_using_n0] n2_stage_seq0=p1_stage & n2_round_0=1 & n2_send_ready=false & ((n2_proposal_seq0_r1_n0!=INVALID&n2_proposal_seq0_r1_n1!=INVALID)|(n2_proposal_seq0_r1_n0!=INVALID&n2_proposal_seq0_r1_n2!=INVALID)|(n2_proposal_seq0_r1_n1!=INVALID&n2_proposal_seq0_r1_n2!=INVALID)) & ((n2_proposal_seq0_r1_n1!=INVALID&n2_proposal_seq0_r1_n1=n2_proposal_seq0_r1_n0)|(n2_proposal_seq0_r1_n2!=INVALID&n2_proposal_seq0_r1_n2=n2_proposal_seq0_r1_n0)) ->         (n2_state_ts_seq0_r1_n2'=n2_proposal_seq0_r1_n0) & (n2_stage_seq0'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=1) & (n2_send_cmd_ts'=n2_proposal_seq0_r1_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign BOT.
    [n2_process_proposal_assign_state_seq0_r1_using_n0] n2_stage_seq0=p1_stage & n2_round_0=1 & n2_send_ready=false & ((n2_proposal_seq0_r1_n0!=INVALID&n2_proposal_seq0_r1_n1!=INVALID)|(n2_proposal_seq0_r1_n0!=INVALID&n2_proposal_seq0_r1_n2!=INVALID)|(n2_proposal_seq0_r1_n1!=INVALID&n2_proposal_seq0_r1_n2!=INVALID)) & !((n2_proposal_seq0_r1_n1!=INVALID&n2_proposal_seq0_r1_n1=n2_proposal_seq0_r1_n0)|(n2_proposal_seq0_r1_n2!=INVALID&n2_proposal_seq0_r1_n2=n2_proposal_seq0_r1_n0)) ->         (n2_state_ts_seq0_r1_n2'=BOT)                                    & (n2_stage_seq0'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=1) & (n2_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 1 for seq0 at round1.
    [n2_process_proposal_assign_state_seq0_r1_using_n1] n2_stage_seq0=p1_stage & n2_round_0=1 & n2_send_ready=false & ((n2_proposal_seq0_r1_n0!=INVALID&n2_proposal_seq0_r1_n1!=INVALID)|(n2_proposal_seq0_r1_n0!=INVALID&n2_proposal_seq0_r1_n2!=INVALID)|(n2_proposal_seq0_r1_n1!=INVALID&n2_proposal_seq0_r1_n2!=INVALID)) & ((n2_proposal_seq0_r1_n0!=INVALID&n2_proposal_seq0_r1_n0=n2_proposal_seq0_r1_n1)|(n2_proposal_seq0_r1_n2!=INVALID&n2_proposal_seq0_r1_n2=n2_proposal_seq0_r1_n1)) ->         (n2_state_ts_seq0_r1_n2'=n2_proposal_seq0_r1_n1) & (n2_stage_seq0'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=1) & (n2_send_cmd_ts'=n2_proposal_seq0_r1_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign BOT.
    [n2_process_proposal_assign_state_seq0_r1_using_n1] n2_stage_seq0=p1_stage & n2_round_0=1 & n2_send_ready=false & ((n2_proposal_seq0_r1_n0!=INVALID&n2_proposal_seq0_r1_n1!=INVALID)|(n2_proposal_seq0_r1_n0!=INVALID&n2_proposal_seq0_r1_n2!=INVALID)|(n2_proposal_seq0_r1_n1!=INVALID&n2_proposal_seq0_r1_n2!=INVALID)) & !((n2_proposal_seq0_r1_n0!=INVALID&n2_proposal_seq0_r1_n0=n2_proposal_seq0_r1_n1)|(n2_proposal_seq0_r1_n2!=INVALID&n2_proposal_seq0_r1_n2=n2_proposal_seq0_r1_n1)) ->         (n2_state_ts_seq0_r1_n2'=BOT)                                    & (n2_stage_seq0'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=1) & (n2_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 2 for seq0 at round1.
    [n2_process_proposal_assign_state_seq0_r1_using_n2] n2_stage_seq0=p1_stage & n2_round_0=1 & n2_send_ready=false & ((n2_proposal_seq0_r1_n0!=INVALID&n2_proposal_seq0_r1_n1!=INVALID)|(n2_proposal_seq0_r1_n0!=INVALID&n2_proposal_seq0_r1_n2!=INVALID)|(n2_proposal_seq0_r1_n1!=INVALID&n2_proposal_seq0_r1_n2!=INVALID)) & ((n2_proposal_seq0_r1_n0!=INVALID&n2_proposal_seq0_r1_n0=n2_proposal_seq0_r1_n2)|(n2_proposal_seq0_r1_n1!=INVALID&n2_proposal_seq0_r1_n1=n2_proposal_seq0_r1_n2)) ->         (n2_state_ts_seq0_r1_n2'=n2_proposal_seq0_r1_n2) & (n2_stage_seq0'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=1) & (n2_send_cmd_ts'=n2_proposal_seq0_r1_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign BOT.
    [n2_process_proposal_assign_state_seq0_r1_using_n2] n2_stage_seq0=p1_stage & n2_round_0=1 & n2_send_ready=false & ((n2_proposal_seq0_r1_n0!=INVALID&n2_proposal_seq0_r1_n1!=INVALID)|(n2_proposal_seq0_r1_n0!=INVALID&n2_proposal_seq0_r1_n2!=INVALID)|(n2_proposal_seq0_r1_n1!=INVALID&n2_proposal_seq0_r1_n2!=INVALID)) & !((n2_proposal_seq0_r1_n0!=INVALID&n2_proposal_seq0_r1_n0=n2_proposal_seq0_r1_n2)|(n2_proposal_seq0_r1_n1!=INVALID&n2_proposal_seq0_r1_n1=n2_proposal_seq0_r1_n2)) ->         (n2_state_ts_seq0_r1_n2'=BOT)                                    & (n2_stage_seq0'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=1) & (n2_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 0 for seq1 at round0.
    [n2_process_proposal_assign_state_seq1_r0_using_n0] n2_stage_seq1=p1_stage & n2_round_1=0 & n2_send_ready=false & ((n2_proposal_seq1_r0_n0!=INVALID&n2_proposal_seq1_r0_n1!=INVALID)|(n2_proposal_seq1_r0_n0!=INVALID&n2_proposal_seq1_r0_n2!=INVALID)|(n2_proposal_seq1_r0_n1!=INVALID&n2_proposal_seq1_r0_n2!=INVALID)) & ((n2_proposal_seq1_r0_n1!=INVALID&n2_proposal_seq1_r0_n1=n2_proposal_seq1_r0_n0)|(n2_proposal_seq1_r0_n2!=INVALID&n2_proposal_seq1_r0_n2=n2_proposal_seq1_r0_n0)) ->         (n2_state_ts_seq1_r0_n2'=n2_proposal_seq1_r0_n0) & (n2_stage_seq1'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=0) & (n2_send_cmd_ts'=n2_proposal_seq1_r0_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign BOT.
    [n2_process_proposal_assign_state_seq1_r0_using_n0] n2_stage_seq1=p1_stage & n2_round_1=0 & n2_send_ready=false & ((n2_proposal_seq1_r0_n0!=INVALID&n2_proposal_seq1_r0_n1!=INVALID)|(n2_proposal_seq1_r0_n0!=INVALID&n2_proposal_seq1_r0_n2!=INVALID)|(n2_proposal_seq1_r0_n1!=INVALID&n2_proposal_seq1_r0_n2!=INVALID)) & !((n2_proposal_seq1_r0_n1!=INVALID&n2_proposal_seq1_r0_n1=n2_proposal_seq1_r0_n0)|(n2_proposal_seq1_r0_n2!=INVALID&n2_proposal_seq1_r0_n2=n2_proposal_seq1_r0_n0)) ->         (n2_state_ts_seq1_r0_n2'=BOT)                                    & (n2_stage_seq1'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=0) & (n2_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 1 for seq1 at round0.
    [n2_process_proposal_assign_state_seq1_r0_using_n1] n2_stage_seq1=p1_stage & n2_round_1=0 & n2_send_ready=false & ((n2_proposal_seq1_r0_n0!=INVALID&n2_proposal_seq1_r0_n1!=INVALID)|(n2_proposal_seq1_r0_n0!=INVALID&n2_proposal_seq1_r0_n2!=INVALID)|(n2_proposal_seq1_r0_n1!=INVALID&n2_proposal_seq1_r0_n2!=INVALID)) & ((n2_proposal_seq1_r0_n0!=INVALID&n2_proposal_seq1_r0_n0=n2_proposal_seq1_r0_n1)|(n2_proposal_seq1_r0_n2!=INVALID&n2_proposal_seq1_r0_n2=n2_proposal_seq1_r0_n1)) ->         (n2_state_ts_seq1_r0_n2'=n2_proposal_seq1_r0_n1) & (n2_stage_seq1'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=0) & (n2_send_cmd_ts'=n2_proposal_seq1_r0_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign BOT.
    [n2_process_proposal_assign_state_seq1_r0_using_n1] n2_stage_seq1=p1_stage & n2_round_1=0 & n2_send_ready=false & ((n2_proposal_seq1_r0_n0!=INVALID&n2_proposal_seq1_r0_n1!=INVALID)|(n2_proposal_seq1_r0_n0!=INVALID&n2_proposal_seq1_r0_n2!=INVALID)|(n2_proposal_seq1_r0_n1!=INVALID&n2_proposal_seq1_r0_n2!=INVALID)) & !((n2_proposal_seq1_r0_n0!=INVALID&n2_proposal_seq1_r0_n0=n2_proposal_seq1_r0_n1)|(n2_proposal_seq1_r0_n2!=INVALID&n2_proposal_seq1_r0_n2=n2_proposal_seq1_r0_n1)) ->         (n2_state_ts_seq1_r0_n2'=BOT)                                    & (n2_stage_seq1'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=0) & (n2_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 2 for seq1 at round0.
    [n2_process_proposal_assign_state_seq1_r0_using_n2] n2_stage_seq1=p1_stage & n2_round_1=0 & n2_send_ready=false & ((n2_proposal_seq1_r0_n0!=INVALID&n2_proposal_seq1_r0_n1!=INVALID)|(n2_proposal_seq1_r0_n0!=INVALID&n2_proposal_seq1_r0_n2!=INVALID)|(n2_proposal_seq1_r0_n1!=INVALID&n2_proposal_seq1_r0_n2!=INVALID)) & ((n2_proposal_seq1_r0_n0!=INVALID&n2_proposal_seq1_r0_n0=n2_proposal_seq1_r0_n2)|(n2_proposal_seq1_r0_n1!=INVALID&n2_proposal_seq1_r0_n1=n2_proposal_seq1_r0_n2)) ->         (n2_state_ts_seq1_r0_n2'=n2_proposal_seq1_r0_n2) & (n2_stage_seq1'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=0) & (n2_send_cmd_ts'=n2_proposal_seq1_r0_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign BOT.
    [n2_process_proposal_assign_state_seq1_r0_using_n2] n2_stage_seq1=p1_stage & n2_round_1=0 & n2_send_ready=false & ((n2_proposal_seq1_r0_n0!=INVALID&n2_proposal_seq1_r0_n1!=INVALID)|(n2_proposal_seq1_r0_n0!=INVALID&n2_proposal_seq1_r0_n2!=INVALID)|(n2_proposal_seq1_r0_n1!=INVALID&n2_proposal_seq1_r0_n2!=INVALID)) & !((n2_proposal_seq1_r0_n0!=INVALID&n2_proposal_seq1_r0_n0=n2_proposal_seq1_r0_n2)|(n2_proposal_seq1_r0_n1!=INVALID&n2_proposal_seq1_r0_n1=n2_proposal_seq1_r0_n2)) ->         (n2_state_ts_seq1_r0_n2'=BOT)                                    & (n2_stage_seq1'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=0) & (n2_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 0 for seq1 at round1.
    [n2_process_proposal_assign_state_seq1_r1_using_n0] n2_stage_seq1=p1_stage & n2_round_1=1 & n2_send_ready=false & ((n2_proposal_seq1_r1_n0!=INVALID&n2_proposal_seq1_r1_n1!=INVALID)|(n2_proposal_seq1_r1_n0!=INVALID&n2_proposal_seq1_r1_n2!=INVALID)|(n2_proposal_seq1_r1_n1!=INVALID&n2_proposal_seq1_r1_n2!=INVALID)) & ((n2_proposal_seq1_r1_n1!=INVALID&n2_proposal_seq1_r1_n1=n2_proposal_seq1_r1_n0)|(n2_proposal_seq1_r1_n2!=INVALID&n2_proposal_seq1_r1_n2=n2_proposal_seq1_r1_n0)) ->         (n2_state_ts_seq1_r1_n2'=n2_proposal_seq1_r1_n0) & (n2_stage_seq1'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=1) & (n2_send_cmd_ts'=n2_proposal_seq1_r1_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign BOT.
    [n2_process_proposal_assign_state_seq1_r1_using_n0] n2_stage_seq1=p1_stage & n2_round_1=1 & n2_send_ready=false & ((n2_proposal_seq1_r1_n0!=INVALID&n2_proposal_seq1_r1_n1!=INVALID)|(n2_proposal_seq1_r1_n0!=INVALID&n2_proposal_seq1_r1_n2!=INVALID)|(n2_proposal_seq1_r1_n1!=INVALID&n2_proposal_seq1_r1_n2!=INVALID)) & !((n2_proposal_seq1_r1_n1!=INVALID&n2_proposal_seq1_r1_n1=n2_proposal_seq1_r1_n0)|(n2_proposal_seq1_r1_n2!=INVALID&n2_proposal_seq1_r1_n2=n2_proposal_seq1_r1_n0)) ->         (n2_state_ts_seq1_r1_n2'=BOT)                                    & (n2_stage_seq1'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=1) & (n2_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 1 for seq1 at round1.
    [n2_process_proposal_assign_state_seq1_r1_using_n1] n2_stage_seq1=p1_stage & n2_round_1=1 & n2_send_ready=false & ((n2_proposal_seq1_r1_n0!=INVALID&n2_proposal_seq1_r1_n1!=INVALID)|(n2_proposal_seq1_r1_n0!=INVALID&n2_proposal_seq1_r1_n2!=INVALID)|(n2_proposal_seq1_r1_n1!=INVALID&n2_proposal_seq1_r1_n2!=INVALID)) & ((n2_proposal_seq1_r1_n0!=INVALID&n2_proposal_seq1_r1_n0=n2_proposal_seq1_r1_n1)|(n2_proposal_seq1_r1_n2!=INVALID&n2_proposal_seq1_r1_n2=n2_proposal_seq1_r1_n1)) ->         (n2_state_ts_seq1_r1_n2'=n2_proposal_seq1_r1_n1) & (n2_stage_seq1'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=1) & (n2_send_cmd_ts'=n2_proposal_seq1_r1_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign BOT.
    [n2_process_proposal_assign_state_seq1_r1_using_n1] n2_stage_seq1=p1_stage & n2_round_1=1 & n2_send_ready=false & ((n2_proposal_seq1_r1_n0!=INVALID&n2_proposal_seq1_r1_n1!=INVALID)|(n2_proposal_seq1_r1_n0!=INVALID&n2_proposal_seq1_r1_n2!=INVALID)|(n2_proposal_seq1_r1_n1!=INVALID&n2_proposal_seq1_r1_n2!=INVALID)) & !((n2_proposal_seq1_r1_n0!=INVALID&n2_proposal_seq1_r1_n0=n2_proposal_seq1_r1_n1)|(n2_proposal_seq1_r1_n2!=INVALID&n2_proposal_seq1_r1_n2=n2_proposal_seq1_r1_n1)) ->         (n2_state_ts_seq1_r1_n2'=BOT)                                    & (n2_stage_seq1'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=1) & (n2_send_cmd_ts'=BOT); 

    // 1. When we have enough proposals, assign the state using the proposal from node 2 for seq1 at round1.
    [n2_process_proposal_assign_state_seq1_r1_using_n2] n2_stage_seq1=p1_stage & n2_round_1=1 & n2_send_ready=false & ((n2_proposal_seq1_r1_n0!=INVALID&n2_proposal_seq1_r1_n1!=INVALID)|(n2_proposal_seq1_r1_n0!=INVALID&n2_proposal_seq1_r1_n2!=INVALID)|(n2_proposal_seq1_r1_n1!=INVALID&n2_proposal_seq1_r1_n2!=INVALID)) & ((n2_proposal_seq1_r1_n0!=INVALID&n2_proposal_seq1_r1_n0=n2_proposal_seq1_r1_n2)|(n2_proposal_seq1_r1_n1!=INVALID&n2_proposal_seq1_r1_n1=n2_proposal_seq1_r1_n2)) ->         (n2_state_ts_seq1_r1_n2'=n2_proposal_seq1_r1_n2) & (n2_stage_seq1'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=1) & (n2_send_cmd_ts'=n2_proposal_seq1_r1_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign BOT.
    [n2_process_proposal_assign_state_seq1_r1_using_n2] n2_stage_seq1=p1_stage & n2_round_1=1 & n2_send_ready=false & ((n2_proposal_seq1_r1_n0!=INVALID&n2_proposal_seq1_r1_n1!=INVALID)|(n2_proposal_seq1_r1_n0!=INVALID&n2_proposal_seq1_r1_n2!=INVALID)|(n2_proposal_seq1_r1_n1!=INVALID&n2_proposal_seq1_r1_n2!=INVALID)) & !((n2_proposal_seq1_r1_n0!=INVALID&n2_proposal_seq1_r1_n0=n2_proposal_seq1_r1_n2)|(n2_proposal_seq1_r1_n1!=INVALID&n2_proposal_seq1_r1_n1=n2_proposal_seq1_r1_n2)) ->         (n2_state_ts_seq1_r1_n2'=BOT)                                    & (n2_stage_seq1'=p2s_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=1) & (n2_send_cmd_ts'=BOT);

        
    // Process when a State pkt is ready.
    // Received an old state for seq0, reply decided.
    [n2_receive_state_from_old_seq0_reply_decided]   n2_recv_ready=true & n2_recv_type=cmd_state & (n2_stage_seq0=decided) & n2_recv_seq=0 ->         (n2_recv_ready'=false) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_decided) & (n2_send_seq'=0) & (n2_send_cmd_ts'=n2_log_ts_seq0);
    // Received an old state for seq1, reply decided.
    [n2_receive_state_from_old_seq1_reply_decided]   n2_recv_ready=true & n2_recv_type=cmd_state & (n2_stage_seq1=decided) & n2_recv_seq=1 ->         (n2_recv_ready'=false) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_decided) & (n2_send_seq'=1) & (n2_send_cmd_ts'=n2_log_ts_seq1); 
    // Receive the proposal from node 0 for non-decided seq0, round0.
    [n2_receive_state_from_n0_for_seq0_r0] n2_recv_ready=true & n2_recv_from=0 & n2_recv_type=cmd_state & n2_recv_seq=0 & n2_recv_round=0 & (n2_stage_seq0!=decided) ->         (n2_recv_ready'=false) & (n2_state_ts_seq0_r0_n0'=n2_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq0, round0.
    [n2_receive_state_from_n1_for_seq0_r0] n2_recv_ready=true & n2_recv_from=1 & n2_recv_type=cmd_state & n2_recv_seq=0 & n2_recv_round=0 & (n2_stage_seq0!=decided) ->         (n2_recv_ready'=false) & (n2_state_ts_seq0_r0_n1'=n2_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq0, round0.
    [n2_receive_state_from_n2_for_seq0_r0] n2_recv_ready=true & n2_recv_from=2 & n2_recv_type=cmd_state & n2_recv_seq=0 & n2_recv_round=0 & (n2_stage_seq0!=decided) ->         (n2_recv_ready'=false) & (n2_state_ts_seq0_r0_n2'=n2_recv_cmd_ts); 
    // Receive the proposal from node 0 for non-decided seq0, round1.
    [n2_receive_state_from_n0_for_seq0_r1] n2_recv_ready=true & n2_recv_from=0 & n2_recv_type=cmd_state & n2_recv_seq=0 & n2_recv_round=1 & (n2_stage_seq0!=decided) ->         (n2_recv_ready'=false) & (n2_state_ts_seq0_r1_n0'=n2_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq0, round1.
    [n2_receive_state_from_n1_for_seq0_r1] n2_recv_ready=true & n2_recv_from=1 & n2_recv_type=cmd_state & n2_recv_seq=0 & n2_recv_round=1 & (n2_stage_seq0!=decided) ->         (n2_recv_ready'=false) & (n2_state_ts_seq0_r1_n1'=n2_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq0, round1.
    [n2_receive_state_from_n2_for_seq0_r1] n2_recv_ready=true & n2_recv_from=2 & n2_recv_type=cmd_state & n2_recv_seq=0 & n2_recv_round=1 & (n2_stage_seq0!=decided) ->         (n2_recv_ready'=false) & (n2_state_ts_seq0_r1_n2'=n2_recv_cmd_ts); 
    // Receive the proposal from node 0 for non-decided seq1, round0.
    [n2_receive_state_from_n0_for_seq1_r0] n2_recv_ready=true & n2_recv_from=0 & n2_recv_type=cmd_state & n2_recv_seq=1 & n2_recv_round=0 & (n2_stage_seq1!=decided) ->         (n2_recv_ready'=false) & (n2_state_ts_seq1_r0_n0'=n2_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq1, round0.
    [n2_receive_state_from_n1_for_seq1_r0] n2_recv_ready=true & n2_recv_from=1 & n2_recv_type=cmd_state & n2_recv_seq=1 & n2_recv_round=0 & (n2_stage_seq1!=decided) ->         (n2_recv_ready'=false) & (n2_state_ts_seq1_r0_n1'=n2_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq1, round0.
    [n2_receive_state_from_n2_for_seq1_r0] n2_recv_ready=true & n2_recv_from=2 & n2_recv_type=cmd_state & n2_recv_seq=1 & n2_recv_round=0 & (n2_stage_seq1!=decided) ->         (n2_recv_ready'=false) & (n2_state_ts_seq1_r0_n2'=n2_recv_cmd_ts); 
    // Receive the proposal from node 0 for non-decided seq1, round1.
    [n2_receive_state_from_n0_for_seq1_r1] n2_recv_ready=true & n2_recv_from=0 & n2_recv_type=cmd_state & n2_recv_seq=1 & n2_recv_round=1 & (n2_stage_seq1!=decided) ->         (n2_recv_ready'=false) & (n2_state_ts_seq1_r1_n0'=n2_recv_cmd_ts); 
    // Receive the proposal from node 1 for non-decided seq1, round1.
    [n2_receive_state_from_n1_for_seq1_r1] n2_recv_ready=true & n2_recv_from=1 & n2_recv_type=cmd_state & n2_recv_seq=1 & n2_recv_round=1 & (n2_stage_seq1!=decided) ->         (n2_recv_ready'=false) & (n2_state_ts_seq1_r1_n1'=n2_recv_cmd_ts); 
    // Receive the proposal from node 2 for non-decided seq1, round1.
    [n2_receive_state_from_n2_for_seq1_r1] n2_recv_ready=true & n2_recv_from=2 & n2_recv_type=cmd_state & n2_recv_seq=1 & n2_recv_round=1 & (n2_stage_seq1!=decided) ->         (n2_recv_ready'=false) & (n2_state_ts_seq1_r1_n2'=n2_recv_cmd_ts); 

    // 1. When we have enough states, seq0 assign the state using the proposal from node 0 for seq0 at round0.
    [n2_process_state_assign_vote_seq0_r0_using_n0] n2_stage_seq0=p2s_stage & n2_round_0=0 & n2_send_ready=false & ((n2_state_ts_seq0_r0_n0!=INVALID&n2_state_ts_seq0_r0_n1!=INVALID)|(n2_state_ts_seq0_r0_n0!=INVALID&n2_state_ts_seq0_r0_n2!=INVALID)|(n2_state_ts_seq0_r0_n1!=INVALID&n2_state_ts_seq0_r0_n2!=INVALID)) &  ((n2_state_ts_seq0_r0_n1!=INVALID&n2_state_ts_seq0_r0_n1=n2_state_ts_seq0_r0_n0)|(n2_state_ts_seq0_r0_n2!=INVALID&n2_state_ts_seq0_r0_n2=n2_state_ts_seq0_r0_n0)) ->         (n2_vote_ts_seq0_r0_n2'=n2_state_ts_seq0_r0_n0) & (n2_stage_seq0'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=0) & (n2_send_round'=0) & (n2_send_cmd_ts'=n2_state_ts_seq0_r0_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign QUES_VOTE.
    [n2_process_state_assign_vote_seq0_r0_using_n0] n2_stage_seq0=p2s_stage & n2_round_0=0 & n2_send_ready=false & ((n2_state_ts_seq0_r0_n0!=INVALID&n2_state_ts_seq0_r0_n1!=INVALID)|(n2_state_ts_seq0_r0_n0!=INVALID&n2_state_ts_seq0_r0_n2!=INVALID)|(n2_state_ts_seq0_r0_n1!=INVALID&n2_state_ts_seq0_r0_n2!=INVALID)) & !((n2_state_ts_seq0_r0_n1!=INVALID&n2_state_ts_seq0_r0_n1=n2_state_ts_seq0_r0_n0)|(n2_state_ts_seq0_r0_n2!=INVALID&n2_state_ts_seq0_r0_n2=n2_state_ts_seq0_r0_n0)) ->         (n2_vote_ts_seq0_r0_n2'=QUES_VOTE)                              & (n2_stage_seq0'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=0) & (n2_send_round'=0) & (n2_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq0 assign the state using the proposal from node 1 for seq0 at round0.
    [n2_process_state_assign_vote_seq0_r0_using_n1] n2_stage_seq0=p2s_stage & n2_round_0=0 & n2_send_ready=false & ((n2_state_ts_seq0_r0_n0!=INVALID&n2_state_ts_seq0_r0_n1!=INVALID)|(n2_state_ts_seq0_r0_n0!=INVALID&n2_state_ts_seq0_r0_n2!=INVALID)|(n2_state_ts_seq0_r0_n1!=INVALID&n2_state_ts_seq0_r0_n2!=INVALID)) &  ((n2_state_ts_seq0_r0_n0!=INVALID&n2_state_ts_seq0_r0_n0=n2_state_ts_seq0_r0_n1)|(n2_state_ts_seq0_r0_n2!=INVALID&n2_state_ts_seq0_r0_n2=n2_state_ts_seq0_r0_n1)) ->         (n2_vote_ts_seq0_r0_n2'=n2_state_ts_seq0_r0_n1) & (n2_stage_seq0'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=0) & (n2_send_round'=0) & (n2_send_cmd_ts'=n2_state_ts_seq0_r0_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign QUES_VOTE.
    [n2_process_state_assign_vote_seq0_r0_using_n1] n2_stage_seq0=p2s_stage & n2_round_0=0 & n2_send_ready=false & ((n2_state_ts_seq0_r0_n0!=INVALID&n2_state_ts_seq0_r0_n1!=INVALID)|(n2_state_ts_seq0_r0_n0!=INVALID&n2_state_ts_seq0_r0_n2!=INVALID)|(n2_state_ts_seq0_r0_n1!=INVALID&n2_state_ts_seq0_r0_n2!=INVALID)) & !((n2_state_ts_seq0_r0_n0!=INVALID&n2_state_ts_seq0_r0_n0=n2_state_ts_seq0_r0_n1)|(n2_state_ts_seq0_r0_n2!=INVALID&n2_state_ts_seq0_r0_n2=n2_state_ts_seq0_r0_n1)) ->         (n2_vote_ts_seq0_r0_n2'=QUES_VOTE)                              & (n2_stage_seq0'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=0) & (n2_send_round'=0) & (n2_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq0 assign the state using the proposal from node 2 for seq0 at round0.
    [n2_process_state_assign_vote_seq0_r0_using_n2] n2_stage_seq0=p2s_stage & n2_round_0=0 & n2_send_ready=false & ((n2_state_ts_seq0_r0_n0!=INVALID&n2_state_ts_seq0_r0_n1!=INVALID)|(n2_state_ts_seq0_r0_n0!=INVALID&n2_state_ts_seq0_r0_n2!=INVALID)|(n2_state_ts_seq0_r0_n1!=INVALID&n2_state_ts_seq0_r0_n2!=INVALID)) &  ((n2_state_ts_seq0_r0_n0!=INVALID&n2_state_ts_seq0_r0_n0=n2_state_ts_seq0_r0_n2)|(n2_state_ts_seq0_r0_n1!=INVALID&n2_state_ts_seq0_r0_n1=n2_state_ts_seq0_r0_n2)) ->         (n2_vote_ts_seq0_r0_n2'=n2_state_ts_seq0_r0_n2) & (n2_stage_seq0'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=0) & (n2_send_round'=0) & (n2_send_cmd_ts'=n2_state_ts_seq0_r0_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign QUES_VOTE.
    [n2_process_state_assign_vote_seq0_r0_using_n2] n2_stage_seq0=p2s_stage & n2_round_0=0 & n2_send_ready=false & ((n2_state_ts_seq0_r0_n0!=INVALID&n2_state_ts_seq0_r0_n1!=INVALID)|(n2_state_ts_seq0_r0_n0!=INVALID&n2_state_ts_seq0_r0_n2!=INVALID)|(n2_state_ts_seq0_r0_n1!=INVALID&n2_state_ts_seq0_r0_n2!=INVALID)) & !((n2_state_ts_seq0_r0_n0!=INVALID&n2_state_ts_seq0_r0_n0=n2_state_ts_seq0_r0_n2)|(n2_state_ts_seq0_r0_n1!=INVALID&n2_state_ts_seq0_r0_n1=n2_state_ts_seq0_r0_n2)) ->         (n2_vote_ts_seq0_r0_n2'=QUES_VOTE)                              & (n2_stage_seq0'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=0) & (n2_send_round'=0) & (n2_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq0 assign the state using the proposal from node 0 for seq0 at round1.
    [n2_process_state_assign_vote_seq0_r1_using_n0] n2_stage_seq0=p2s_stage & n2_round_0=1 & n2_send_ready=false & ((n2_state_ts_seq0_r1_n0!=INVALID&n2_state_ts_seq0_r1_n1!=INVALID)|(n2_state_ts_seq0_r1_n0!=INVALID&n2_state_ts_seq0_r1_n2!=INVALID)|(n2_state_ts_seq0_r1_n1!=INVALID&n2_state_ts_seq0_r1_n2!=INVALID)) &  ((n2_state_ts_seq0_r1_n1!=INVALID&n2_state_ts_seq0_r1_n1=n2_state_ts_seq0_r1_n0)|(n2_state_ts_seq0_r1_n2!=INVALID&n2_state_ts_seq0_r1_n2=n2_state_ts_seq0_r1_n0)) ->         (n2_vote_ts_seq0_r1_n2'=n2_state_ts_seq0_r1_n0) & (n2_stage_seq0'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=0) & (n2_send_round'=1) & (n2_send_cmd_ts'=n2_state_ts_seq0_r1_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign QUES_VOTE.
    [n2_process_state_assign_vote_seq0_r1_using_n0] n2_stage_seq0=p2s_stage & n2_round_0=1 & n2_send_ready=false & ((n2_state_ts_seq0_r1_n0!=INVALID&n2_state_ts_seq0_r1_n1!=INVALID)|(n2_state_ts_seq0_r1_n0!=INVALID&n2_state_ts_seq0_r1_n2!=INVALID)|(n2_state_ts_seq0_r1_n1!=INVALID&n2_state_ts_seq0_r1_n2!=INVALID)) & !((n2_state_ts_seq0_r1_n1!=INVALID&n2_state_ts_seq0_r1_n1=n2_state_ts_seq0_r1_n0)|(n2_state_ts_seq0_r1_n2!=INVALID&n2_state_ts_seq0_r1_n2=n2_state_ts_seq0_r1_n0)) ->         (n2_vote_ts_seq0_r1_n2'=QUES_VOTE)                              & (n2_stage_seq0'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=0) & (n2_send_round'=1) & (n2_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq0 assign the state using the proposal from node 1 for seq0 at round1.
    [n2_process_state_assign_vote_seq0_r1_using_n1] n2_stage_seq0=p2s_stage & n2_round_0=1 & n2_send_ready=false & ((n2_state_ts_seq0_r1_n0!=INVALID&n2_state_ts_seq0_r1_n1!=INVALID)|(n2_state_ts_seq0_r1_n0!=INVALID&n2_state_ts_seq0_r1_n2!=INVALID)|(n2_state_ts_seq0_r1_n1!=INVALID&n2_state_ts_seq0_r1_n2!=INVALID)) &  ((n2_state_ts_seq0_r1_n0!=INVALID&n2_state_ts_seq0_r1_n0=n2_state_ts_seq0_r1_n1)|(n2_state_ts_seq0_r1_n2!=INVALID&n2_state_ts_seq0_r1_n2=n2_state_ts_seq0_r1_n1)) ->         (n2_vote_ts_seq0_r1_n2'=n2_state_ts_seq0_r1_n1) & (n2_stage_seq0'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=0) & (n2_send_round'=1) & (n2_send_cmd_ts'=n2_state_ts_seq0_r1_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign QUES_VOTE.
    [n2_process_state_assign_vote_seq0_r1_using_n1] n2_stage_seq0=p2s_stage & n2_round_0=1 & n2_send_ready=false & ((n2_state_ts_seq0_r1_n0!=INVALID&n2_state_ts_seq0_r1_n1!=INVALID)|(n2_state_ts_seq0_r1_n0!=INVALID&n2_state_ts_seq0_r1_n2!=INVALID)|(n2_state_ts_seq0_r1_n1!=INVALID&n2_state_ts_seq0_r1_n2!=INVALID)) & !((n2_state_ts_seq0_r1_n0!=INVALID&n2_state_ts_seq0_r1_n0=n2_state_ts_seq0_r1_n1)|(n2_state_ts_seq0_r1_n2!=INVALID&n2_state_ts_seq0_r1_n2=n2_state_ts_seq0_r1_n1)) ->         (n2_vote_ts_seq0_r1_n2'=QUES_VOTE)                              & (n2_stage_seq0'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=0) & (n2_send_round'=1) & (n2_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq0 assign the state using the proposal from node 2 for seq0 at round1.
    [n2_process_state_assign_vote_seq0_r1_using_n2] n2_stage_seq0=p2s_stage & n2_round_0=1 & n2_send_ready=false & ((n2_state_ts_seq0_r1_n0!=INVALID&n2_state_ts_seq0_r1_n1!=INVALID)|(n2_state_ts_seq0_r1_n0!=INVALID&n2_state_ts_seq0_r1_n2!=INVALID)|(n2_state_ts_seq0_r1_n1!=INVALID&n2_state_ts_seq0_r1_n2!=INVALID)) &  ((n2_state_ts_seq0_r1_n0!=INVALID&n2_state_ts_seq0_r1_n0=n2_state_ts_seq0_r1_n2)|(n2_state_ts_seq0_r1_n1!=INVALID&n2_state_ts_seq0_r1_n1=n2_state_ts_seq0_r1_n2)) ->         (n2_vote_ts_seq0_r1_n2'=n2_state_ts_seq0_r1_n2) & (n2_stage_seq0'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=0) & (n2_send_round'=1) & (n2_send_cmd_ts'=n2_state_ts_seq0_r1_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign QUES_VOTE.
    [n2_process_state_assign_vote_seq0_r1_using_n2] n2_stage_seq0=p2s_stage & n2_round_0=1 & n2_send_ready=false & ((n2_state_ts_seq0_r1_n0!=INVALID&n2_state_ts_seq0_r1_n1!=INVALID)|(n2_state_ts_seq0_r1_n0!=INVALID&n2_state_ts_seq0_r1_n2!=INVALID)|(n2_state_ts_seq0_r1_n1!=INVALID&n2_state_ts_seq0_r1_n2!=INVALID)) & !((n2_state_ts_seq0_r1_n0!=INVALID&n2_state_ts_seq0_r1_n0=n2_state_ts_seq0_r1_n2)|(n2_state_ts_seq0_r1_n1!=INVALID&n2_state_ts_seq0_r1_n1=n2_state_ts_seq0_r1_n2)) ->         (n2_vote_ts_seq0_r1_n2'=QUES_VOTE)                              & (n2_stage_seq0'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=0) & (n2_send_round'=1) & (n2_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq1 assign the state using the proposal from node 0 for seq1 at round0.
    [n2_process_state_assign_vote_seq1_r0_using_n0] n2_stage_seq1=p2s_stage & n2_round_1=0 & n2_send_ready=false & ((n2_state_ts_seq1_r0_n0!=INVALID&n2_state_ts_seq1_r0_n1!=INVALID)|(n2_state_ts_seq1_r0_n0!=INVALID&n2_state_ts_seq1_r0_n2!=INVALID)|(n2_state_ts_seq1_r0_n1!=INVALID&n2_state_ts_seq1_r0_n2!=INVALID)) &  ((n2_state_ts_seq1_r0_n1!=INVALID&n2_state_ts_seq1_r0_n1=n2_state_ts_seq1_r0_n0)|(n2_state_ts_seq1_r0_n2!=INVALID&n2_state_ts_seq1_r0_n2=n2_state_ts_seq1_r0_n0)) ->         (n2_vote_ts_seq1_r0_n2'=n2_state_ts_seq1_r0_n0) & (n2_stage_seq1'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=1) & (n2_send_round'=0) & (n2_send_cmd_ts'=n2_state_ts_seq1_r0_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign QUES_VOTE.
    [n2_process_state_assign_vote_seq1_r0_using_n0] n2_stage_seq1=p2s_stage & n2_round_1=0 & n2_send_ready=false & ((n2_state_ts_seq1_r0_n0!=INVALID&n2_state_ts_seq1_r0_n1!=INVALID)|(n2_state_ts_seq1_r0_n0!=INVALID&n2_state_ts_seq1_r0_n2!=INVALID)|(n2_state_ts_seq1_r0_n1!=INVALID&n2_state_ts_seq1_r0_n2!=INVALID)) & !((n2_state_ts_seq1_r0_n1!=INVALID&n2_state_ts_seq1_r0_n1=n2_state_ts_seq1_r0_n0)|(n2_state_ts_seq1_r0_n2!=INVALID&n2_state_ts_seq1_r0_n2=n2_state_ts_seq1_r0_n0)) ->         (n2_vote_ts_seq1_r0_n2'=QUES_VOTE)                              & (n2_stage_seq1'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=1) & (n2_send_round'=0) & (n2_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq1 assign the state using the proposal from node 1 for seq1 at round0.
    [n2_process_state_assign_vote_seq1_r0_using_n1] n2_stage_seq1=p2s_stage & n2_round_1=0 & n2_send_ready=false & ((n2_state_ts_seq1_r0_n0!=INVALID&n2_state_ts_seq1_r0_n1!=INVALID)|(n2_state_ts_seq1_r0_n0!=INVALID&n2_state_ts_seq1_r0_n2!=INVALID)|(n2_state_ts_seq1_r0_n1!=INVALID&n2_state_ts_seq1_r0_n2!=INVALID)) &  ((n2_state_ts_seq1_r0_n0!=INVALID&n2_state_ts_seq1_r0_n0=n2_state_ts_seq1_r0_n1)|(n2_state_ts_seq1_r0_n2!=INVALID&n2_state_ts_seq1_r0_n2=n2_state_ts_seq1_r0_n1)) ->         (n2_vote_ts_seq1_r0_n2'=n2_state_ts_seq1_r0_n1) & (n2_stage_seq1'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=1) & (n2_send_round'=0) & (n2_send_cmd_ts'=n2_state_ts_seq1_r0_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign QUES_VOTE.
    [n2_process_state_assign_vote_seq1_r0_using_n1] n2_stage_seq1=p2s_stage & n2_round_1=0 & n2_send_ready=false & ((n2_state_ts_seq1_r0_n0!=INVALID&n2_state_ts_seq1_r0_n1!=INVALID)|(n2_state_ts_seq1_r0_n0!=INVALID&n2_state_ts_seq1_r0_n2!=INVALID)|(n2_state_ts_seq1_r0_n1!=INVALID&n2_state_ts_seq1_r0_n2!=INVALID)) & !((n2_state_ts_seq1_r0_n0!=INVALID&n2_state_ts_seq1_r0_n0=n2_state_ts_seq1_r0_n1)|(n2_state_ts_seq1_r0_n2!=INVALID&n2_state_ts_seq1_r0_n2=n2_state_ts_seq1_r0_n1)) ->         (n2_vote_ts_seq1_r0_n2'=QUES_VOTE)                              & (n2_stage_seq1'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=1) & (n2_send_round'=0) & (n2_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq1 assign the state using the proposal from node 2 for seq1 at round0.
    [n2_process_state_assign_vote_seq1_r0_using_n2] n2_stage_seq1=p2s_stage & n2_round_1=0 & n2_send_ready=false & ((n2_state_ts_seq1_r0_n0!=INVALID&n2_state_ts_seq1_r0_n1!=INVALID)|(n2_state_ts_seq1_r0_n0!=INVALID&n2_state_ts_seq1_r0_n2!=INVALID)|(n2_state_ts_seq1_r0_n1!=INVALID&n2_state_ts_seq1_r0_n2!=INVALID)) &  ((n2_state_ts_seq1_r0_n0!=INVALID&n2_state_ts_seq1_r0_n0=n2_state_ts_seq1_r0_n2)|(n2_state_ts_seq1_r0_n1!=INVALID&n2_state_ts_seq1_r0_n1=n2_state_ts_seq1_r0_n2)) ->         (n2_vote_ts_seq1_r0_n2'=n2_state_ts_seq1_r0_n2) & (n2_stage_seq1'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=1) & (n2_send_round'=0) & (n2_send_cmd_ts'=n2_state_ts_seq1_r0_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign QUES_VOTE.
    [n2_process_state_assign_vote_seq1_r0_using_n2] n2_stage_seq1=p2s_stage & n2_round_1=0 & n2_send_ready=false & ((n2_state_ts_seq1_r0_n0!=INVALID&n2_state_ts_seq1_r0_n1!=INVALID)|(n2_state_ts_seq1_r0_n0!=INVALID&n2_state_ts_seq1_r0_n2!=INVALID)|(n2_state_ts_seq1_r0_n1!=INVALID&n2_state_ts_seq1_r0_n2!=INVALID)) & !((n2_state_ts_seq1_r0_n0!=INVALID&n2_state_ts_seq1_r0_n0=n2_state_ts_seq1_r0_n2)|(n2_state_ts_seq1_r0_n1!=INVALID&n2_state_ts_seq1_r0_n1=n2_state_ts_seq1_r0_n2)) ->         (n2_vote_ts_seq1_r0_n2'=QUES_VOTE)                              & (n2_stage_seq1'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=1) & (n2_send_round'=0) & (n2_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq1 assign the state using the proposal from node 0 for seq1 at round1.
    [n2_process_state_assign_vote_seq1_r1_using_n0] n2_stage_seq1=p2s_stage & n2_round_1=1 & n2_send_ready=false & ((n2_state_ts_seq1_r1_n0!=INVALID&n2_state_ts_seq1_r1_n1!=INVALID)|(n2_state_ts_seq1_r1_n0!=INVALID&n2_state_ts_seq1_r1_n2!=INVALID)|(n2_state_ts_seq1_r1_n1!=INVALID&n2_state_ts_seq1_r1_n2!=INVALID)) &  ((n2_state_ts_seq1_r1_n1!=INVALID&n2_state_ts_seq1_r1_n1=n2_state_ts_seq1_r1_n0)|(n2_state_ts_seq1_r1_n2!=INVALID&n2_state_ts_seq1_r1_n2=n2_state_ts_seq1_r1_n0)) ->         (n2_vote_ts_seq1_r1_n2'=n2_state_ts_seq1_r1_n0) & (n2_stage_seq1'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=1) & (n2_send_round'=1) & (n2_send_cmd_ts'=n2_state_ts_seq1_r1_n0);
    // 2. When we have enough proposals, but no enough same state as node0, we assign QUES_VOTE.
    [n2_process_state_assign_vote_seq1_r1_using_n0] n2_stage_seq1=p2s_stage & n2_round_1=1 & n2_send_ready=false & ((n2_state_ts_seq1_r1_n0!=INVALID&n2_state_ts_seq1_r1_n1!=INVALID)|(n2_state_ts_seq1_r1_n0!=INVALID&n2_state_ts_seq1_r1_n2!=INVALID)|(n2_state_ts_seq1_r1_n1!=INVALID&n2_state_ts_seq1_r1_n2!=INVALID)) & !((n2_state_ts_seq1_r1_n1!=INVALID&n2_state_ts_seq1_r1_n1=n2_state_ts_seq1_r1_n0)|(n2_state_ts_seq1_r1_n2!=INVALID&n2_state_ts_seq1_r1_n2=n2_state_ts_seq1_r1_n0)) ->         (n2_vote_ts_seq1_r1_n2'=QUES_VOTE)                              & (n2_stage_seq1'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=1) & (n2_send_round'=1) & (n2_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq1 assign the state using the proposal from node 1 for seq1 at round1.
    [n2_process_state_assign_vote_seq1_r1_using_n1] n2_stage_seq1=p2s_stage & n2_round_1=1 & n2_send_ready=false & ((n2_state_ts_seq1_r1_n0!=INVALID&n2_state_ts_seq1_r1_n1!=INVALID)|(n2_state_ts_seq1_r1_n0!=INVALID&n2_state_ts_seq1_r1_n2!=INVALID)|(n2_state_ts_seq1_r1_n1!=INVALID&n2_state_ts_seq1_r1_n2!=INVALID)) &  ((n2_state_ts_seq1_r1_n0!=INVALID&n2_state_ts_seq1_r1_n0=n2_state_ts_seq1_r1_n1)|(n2_state_ts_seq1_r1_n2!=INVALID&n2_state_ts_seq1_r1_n2=n2_state_ts_seq1_r1_n1)) ->         (n2_vote_ts_seq1_r1_n2'=n2_state_ts_seq1_r1_n1) & (n2_stage_seq1'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=1) & (n2_send_round'=1) & (n2_send_cmd_ts'=n2_state_ts_seq1_r1_n1);
    // 2. When we have enough proposals, but no enough same state as node1, we assign QUES_VOTE.
    [n2_process_state_assign_vote_seq1_r1_using_n1] n2_stage_seq1=p2s_stage & n2_round_1=1 & n2_send_ready=false & ((n2_state_ts_seq1_r1_n0!=INVALID&n2_state_ts_seq1_r1_n1!=INVALID)|(n2_state_ts_seq1_r1_n0!=INVALID&n2_state_ts_seq1_r1_n2!=INVALID)|(n2_state_ts_seq1_r1_n1!=INVALID&n2_state_ts_seq1_r1_n2!=INVALID)) & !((n2_state_ts_seq1_r1_n0!=INVALID&n2_state_ts_seq1_r1_n0=n2_state_ts_seq1_r1_n1)|(n2_state_ts_seq1_r1_n2!=INVALID&n2_state_ts_seq1_r1_n2=n2_state_ts_seq1_r1_n1)) ->         (n2_vote_ts_seq1_r1_n2'=QUES_VOTE)                              & (n2_stage_seq1'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=1) & (n2_send_round'=1) & (n2_send_cmd_ts'=BOT); 

    // 1. When we have enough states, seq1 assign the state using the proposal from node 2 for seq1 at round1.
    [n2_process_state_assign_vote_seq1_r1_using_n2] n2_stage_seq1=p2s_stage & n2_round_1=1 & n2_send_ready=false & ((n2_state_ts_seq1_r1_n0!=INVALID&n2_state_ts_seq1_r1_n1!=INVALID)|(n2_state_ts_seq1_r1_n0!=INVALID&n2_state_ts_seq1_r1_n2!=INVALID)|(n2_state_ts_seq1_r1_n1!=INVALID&n2_state_ts_seq1_r1_n2!=INVALID)) &  ((n2_state_ts_seq1_r1_n0!=INVALID&n2_state_ts_seq1_r1_n0=n2_state_ts_seq1_r1_n2)|(n2_state_ts_seq1_r1_n1!=INVALID&n2_state_ts_seq1_r1_n1=n2_state_ts_seq1_r1_n2)) ->         (n2_vote_ts_seq1_r1_n2'=n2_state_ts_seq1_r1_n2) & (n2_stage_seq1'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=1) & (n2_send_round'=1) & (n2_send_cmd_ts'=n2_state_ts_seq1_r1_n2);
    // 2. When we have enough proposals, but no enough same state as node2, we assign QUES_VOTE.
    [n2_process_state_assign_vote_seq1_r1_using_n2] n2_stage_seq1=p2s_stage & n2_round_1=1 & n2_send_ready=false & ((n2_state_ts_seq1_r1_n0!=INVALID&n2_state_ts_seq1_r1_n1!=INVALID)|(n2_state_ts_seq1_r1_n0!=INVALID&n2_state_ts_seq1_r1_n2!=INVALID)|(n2_state_ts_seq1_r1_n1!=INVALID&n2_state_ts_seq1_r1_n2!=INVALID)) & !((n2_state_ts_seq1_r1_n0!=INVALID&n2_state_ts_seq1_r1_n0=n2_state_ts_seq1_r1_n2)|(n2_state_ts_seq1_r1_n1!=INVALID&n2_state_ts_seq1_r1_n1=n2_state_ts_seq1_r1_n2)) ->         (n2_vote_ts_seq1_r1_n2'=QUES_VOTE)                              & (n2_stage_seq1'=p2v_stage) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_vote) & (n2_send_seq'=1) & (n2_send_round'=1) & (n2_send_cmd_ts'=BOT);

    // Process when a Vote pkt is ready.
    // Received an old state for seq0, reply decided.
    [n2_receive_vote_from_old_seq0_reply_decided]   n2_recv_ready=true & n2_recv_type=cmd_vote & n2_recv_seq=0 & (n2_stage_seq0=decided) ->         (n2_recv_ready'=false) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_decided) & (n2_send_seq'=0) & (n2_send_cmd_ts'=n2_log_ts_seq0);
    // Received an old state for seq1, reply decided.
    [n2_receive_vote_from_old_seq1_reply_decided]   n2_recv_ready=true & n2_recv_type=cmd_vote & n2_recv_seq=1 & (n2_stage_seq1=decided) ->         (n2_recv_ready'=false) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_decided) & (n2_send_seq'=1) & (n2_send_cmd_ts'=n2_log_ts_seq1); 
    // Receive the vote from node 0 for non-decided seq0, round0.
    [n2_receive_vote_from_n0_for_seq0_r0] n2_recv_ready=true & n2_recv_from=0 & n2_recv_type=cmd_vote & n2_recv_seq=0 & n2_recv_round=0 & n2_stage_seq0!=decided ->         (n2_recv_ready'=false) & (n2_vote_ts_seq0_r0_n0'=n2_recv_cmd_ts); 
    // Receive the vote from node 1 for non-decided seq0, round0.
    [n2_receive_vote_from_n1_for_seq0_r0] n2_recv_ready=true & n2_recv_from=1 & n2_recv_type=cmd_vote & n2_recv_seq=0 & n2_recv_round=0 & n2_stage_seq0!=decided ->         (n2_recv_ready'=false) & (n2_vote_ts_seq0_r0_n1'=n2_recv_cmd_ts); 
    // Receive the vote from node 2 for non-decided seq0, round0.
    [n2_receive_vote_from_n2_for_seq0_r0] n2_recv_ready=true & n2_recv_from=2 & n2_recv_type=cmd_vote & n2_recv_seq=0 & n2_recv_round=0 & n2_stage_seq0!=decided ->         (n2_recv_ready'=false) & (n2_vote_ts_seq0_r0_n2'=n2_recv_cmd_ts); 
    // Receive the vote from node 0 for non-decided seq0, round1.
    [n2_receive_vote_from_n0_for_seq0_r1] n2_recv_ready=true & n2_recv_from=0 & n2_recv_type=cmd_vote & n2_recv_seq=0 & n2_recv_round=1 & n2_stage_seq0!=decided ->         (n2_recv_ready'=false) & (n2_vote_ts_seq0_r1_n0'=n2_recv_cmd_ts); 
    // Receive the vote from node 1 for non-decided seq0, round1.
    [n2_receive_vote_from_n1_for_seq0_r1] n2_recv_ready=true & n2_recv_from=1 & n2_recv_type=cmd_vote & n2_recv_seq=0 & n2_recv_round=1 & n2_stage_seq0!=decided ->         (n2_recv_ready'=false) & (n2_vote_ts_seq0_r1_n1'=n2_recv_cmd_ts); 
    // Receive the vote from node 2 for non-decided seq0, round1.
    [n2_receive_vote_from_n2_for_seq0_r1] n2_recv_ready=true & n2_recv_from=2 & n2_recv_type=cmd_vote & n2_recv_seq=0 & n2_recv_round=1 & n2_stage_seq0!=decided ->         (n2_recv_ready'=false) & (n2_vote_ts_seq0_r1_n2'=n2_recv_cmd_ts); 
    // Receive the vote from node 0 for non-decided seq1, round0.
    [n2_receive_vote_from_n0_for_seq1_r0] n2_recv_ready=true & n2_recv_from=0 & n2_recv_type=cmd_vote & n2_recv_seq=1 & n2_recv_round=0 & n2_stage_seq1!=decided ->         (n2_recv_ready'=false) & (n2_vote_ts_seq1_r0_n0'=n2_recv_cmd_ts); 
    // Receive the vote from node 1 for non-decided seq1, round0.
    [n2_receive_vote_from_n1_for_seq1_r0] n2_recv_ready=true & n2_recv_from=1 & n2_recv_type=cmd_vote & n2_recv_seq=1 & n2_recv_round=0 & n2_stage_seq1!=decided ->         (n2_recv_ready'=false) & (n2_vote_ts_seq1_r0_n1'=n2_recv_cmd_ts); 
    // Receive the vote from node 2 for non-decided seq1, round0.
    [n2_receive_vote_from_n2_for_seq1_r0] n2_recv_ready=true & n2_recv_from=2 & n2_recv_type=cmd_vote & n2_recv_seq=1 & n2_recv_round=0 & n2_stage_seq1!=decided ->         (n2_recv_ready'=false) & (n2_vote_ts_seq1_r0_n2'=n2_recv_cmd_ts); 
    // Receive the vote from node 0 for non-decided seq1, round1.
    [n2_receive_vote_from_n0_for_seq1_r1] n2_recv_ready=true & n2_recv_from=0 & n2_recv_type=cmd_vote & n2_recv_seq=1 & n2_recv_round=1 & n2_stage_seq1!=decided ->         (n2_recv_ready'=false) & (n2_vote_ts_seq1_r1_n0'=n2_recv_cmd_ts); 
    // Receive the vote from node 1 for non-decided seq1, round1.
    [n2_receive_vote_from_n1_for_seq1_r1] n2_recv_ready=true & n2_recv_from=1 & n2_recv_type=cmd_vote & n2_recv_seq=1 & n2_recv_round=1 & n2_stage_seq1!=decided ->         (n2_recv_ready'=false) & (n2_vote_ts_seq1_r1_n1'=n2_recv_cmd_ts); 
    // Receive the vote from node 2 for non-decided seq1, round1.
    [n2_receive_vote_from_n2_for_seq1_r1] n2_recv_ready=true & n2_recv_from=2 & n2_recv_type=cmd_vote & n2_recv_seq=1 & n2_recv_round=1 & n2_stage_seq1!=decided ->         (n2_recv_ready'=false) & (n2_vote_ts_seq1_r1_n2'=n2_recv_cmd_ts); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 0 for seq0 at round0.
    [n2_process_vote_for_seq0_r0_using_n0] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=0 & (n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n0!=QUES_VOTE) & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n1!=INVALID)|(n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)) & ((n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n1=n2_vote_ts_seq0_r0_n0)|(n2_vote_ts_seq0_r0_n2!=INVALID&n2_vote_ts_seq0_r0_n2=n2_vote_ts_seq0_r0_n0)) ->         (n2_log_ts_seq0'=n2_vote_ts_seq0_r0_n0) & (n2_stage_seq0'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 1 for seq0 at round0.
    [n2_process_vote_for_seq0_r0_using_n1] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=0 & (n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n1!=QUES_VOTE) & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n1!=INVALID)|(n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)) & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n0=n2_vote_ts_seq0_r0_n1)|(n2_vote_ts_seq0_r0_n2!=INVALID&n2_vote_ts_seq0_r0_n2=n2_vote_ts_seq0_r0_n1)) ->         (n2_log_ts_seq0'=n2_vote_ts_seq0_r0_n1) & (n2_stage_seq0'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 2 for seq0 at round0.
    [n2_process_vote_for_seq0_r0_using_n2] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=0 & (n2_vote_ts_seq0_r0_n2!=INVALID&n2_vote_ts_seq0_r0_n2!=QUES_VOTE) & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n1!=INVALID)|(n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)) & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n0=n2_vote_ts_seq0_r0_n2)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n1=n2_vote_ts_seq0_r0_n2)) ->         (n2_log_ts_seq0'=n2_vote_ts_seq0_r0_n2) & (n2_stage_seq0'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 0 for seq0 at round1.
    [n2_process_vote_for_seq0_r1_using_n0] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=1 & (n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n0!=QUES_VOTE) & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n1!=INVALID)|(n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)) & ((n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n1=n2_vote_ts_seq0_r1_n0)|(n2_vote_ts_seq0_r1_n2!=INVALID&n2_vote_ts_seq0_r1_n2=n2_vote_ts_seq0_r1_n0)) ->         (n2_log_ts_seq0'=n2_vote_ts_seq0_r1_n0) & (n2_stage_seq0'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 1 for seq0 at round1.
    [n2_process_vote_for_seq0_r1_using_n1] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=1 & (n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n1!=QUES_VOTE) & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n1!=INVALID)|(n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)) & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n0=n2_vote_ts_seq0_r1_n1)|(n2_vote_ts_seq0_r1_n2!=INVALID&n2_vote_ts_seq0_r1_n2=n2_vote_ts_seq0_r1_n1)) ->         (n2_log_ts_seq0'=n2_vote_ts_seq0_r1_n1) & (n2_stage_seq0'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 2 for seq0 at round1.
    [n2_process_vote_for_seq0_r1_using_n2] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=1 & (n2_vote_ts_seq0_r1_n2!=INVALID&n2_vote_ts_seq0_r1_n2!=QUES_VOTE) & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n1!=INVALID)|(n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)) & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n0=n2_vote_ts_seq0_r1_n2)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n1=n2_vote_ts_seq0_r1_n2)) ->         (n2_log_ts_seq0'=n2_vote_ts_seq0_r1_n2) & (n2_stage_seq0'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 0 for seq1 at round0.
    [n2_process_vote_for_seq1_r0_using_n0] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=0 & (n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n0!=QUES_VOTE) & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n1!=INVALID)|(n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)) & ((n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n1=n2_vote_ts_seq1_r0_n0)|(n2_vote_ts_seq1_r0_n2!=INVALID&n2_vote_ts_seq1_r0_n2=n2_vote_ts_seq1_r0_n0)) ->         (n2_log_ts_seq1'=n2_vote_ts_seq1_r0_n0) & (n2_stage_seq1'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 1 for seq1 at round0.
    [n2_process_vote_for_seq1_r0_using_n1] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=0 & (n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n1!=QUES_VOTE) & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n1!=INVALID)|(n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)) & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n0=n2_vote_ts_seq1_r0_n1)|(n2_vote_ts_seq1_r0_n2!=INVALID&n2_vote_ts_seq1_r0_n2=n2_vote_ts_seq1_r0_n1)) ->         (n2_log_ts_seq1'=n2_vote_ts_seq1_r0_n1) & (n2_stage_seq1'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 2 for seq1 at round0.
    [n2_process_vote_for_seq1_r0_using_n2] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=0 & (n2_vote_ts_seq1_r0_n2!=INVALID&n2_vote_ts_seq1_r0_n2!=QUES_VOTE) & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n1!=INVALID)|(n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)) & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n0=n2_vote_ts_seq1_r0_n2)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n1=n2_vote_ts_seq1_r0_n2)) ->         (n2_log_ts_seq1'=n2_vote_ts_seq1_r0_n2) & (n2_stage_seq1'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 0 for seq1 at round1.
    [n2_process_vote_for_seq1_r1_using_n0] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=1 & (n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n0!=QUES_VOTE) & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n1!=INVALID)|(n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)) & ((n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n1=n2_vote_ts_seq1_r1_n0)|(n2_vote_ts_seq1_r1_n2!=INVALID&n2_vote_ts_seq1_r1_n2=n2_vote_ts_seq1_r1_n0)) ->         (n2_log_ts_seq1'=n2_vote_ts_seq1_r1_n0) & (n2_stage_seq1'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 1 for seq1 at round1.
    [n2_process_vote_for_seq1_r1_using_n1] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=1 & (n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n1!=QUES_VOTE) & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n1!=INVALID)|(n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)) & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n0=n2_vote_ts_seq1_r1_n1)|(n2_vote_ts_seq1_r1_n2!=INVALID&n2_vote_ts_seq1_r1_n2=n2_vote_ts_seq1_r1_n1)) ->         (n2_log_ts_seq1'=n2_vote_ts_seq1_r1_n1) & (n2_stage_seq1'=pre_decided_stage); 
        
    // 1. When we have enough same non-question votes, assign the log using the proposal from node 2 for seq1 at round1.
    [n2_process_vote_for_seq1_r1_using_n2] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=1 & (n2_vote_ts_seq1_r1_n2!=INVALID&n2_vote_ts_seq1_r1_n2!=QUES_VOTE) & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n1!=INVALID)|(n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)) & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n0=n2_vote_ts_seq1_r1_n2)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n1=n2_vote_ts_seq1_r1_n2)) ->         (n2_log_ts_seq1'=n2_vote_ts_seq1_r1_n2) & (n2_stage_seq1'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 0 for seq0 at round0.
    [n2_process_vote_for_seq0_r0_using_n0] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=0 & n2_round_0+1<MAX_ROUND & (n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n0!=QUES_VOTE) & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n1!=INVALID)|(n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)) & !((n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n1=n2_vote_ts_seq0_r0_n0)|(n2_vote_ts_seq0_r0_n2!=INVALID&n2_vote_ts_seq0_r0_n2=n2_vote_ts_seq0_r0_n0)) ->         (n2_state_ts_seq0_r0_n2'=n2_vote_ts_seq0_r0_n0) & (n2_vote_ts_seq0_r0_n2'=INVALID) & (n2_stage_seq0'=p2s_stage) & (n2_round_0'=n2_round_0+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=0+1) & (n2_send_cmd_ts'=n2_state_ts_seq0_r0_n0);
    //// 2.fail: Out of rounds
    [n2_process_vote_for_seq0_r0_using_n0] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=0 & n2_round_0+1=MAX_ROUND & (n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n0!=QUES_VOTE) & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n1!=INVALID)|(n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)) & !((n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n1=n2_vote_ts_seq0_r0_n0)|(n2_vote_ts_seq0_r0_n2!=INVALID&n2_vote_ts_seq0_r0_n2=n2_vote_ts_seq0_r0_n0)) ->         (n2_log_ts_seq0'=OUT_OF_ROUND) & (n2_stage_seq0'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n2_process_vote_for_seq0_r0_using_n0] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=0 & n2_round_0+1<MAX_ROUND & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n1!=INVALID)|(n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)) & n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n0=QUES_VOTE&n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n1=QUES_VOTE&n2_vote_ts_seq0_r0_n2!=INVALID&n2_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n2_state_ts_seq0_r0_n2'=BOT)                                    & (n2_vote_ts_seq0_r0_n2'=INVALID) & (n2_stage_seq0'=p2s_stage) & (n2_round_0'=n2_round_0+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=0+1) & (n2_send_cmd_ts'=BOT);
    [n2_process_vote_for_seq0_r0_using_n0] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=0 & n2_round_0+1<MAX_ROUND & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n1!=INVALID)|(n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)) & n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n0=QUES_VOTE&n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n1=QUES_VOTE&n2_vote_ts_seq0_r0_n2!=INVALID&n2_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n2_state_ts_seq0_r0_n2'=n2_state_ts_seq0_r0_n0) & (n2_vote_ts_seq0_r0_n2'=INVALID) & (n2_stage_seq0'=p2s_stage) & (n2_round_0'=n2_round_0+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=0+1) & (n2_send_cmd_ts'=n2_state_ts_seq0_r0_n0);
    //// 3.fail: Out of rounds
    [n2_process_vote_for_seq0_r0_using_n0] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=0 & n2_round_0+1=MAX_ROUND & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n1!=INVALID)|(n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)) & n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n0=QUES_VOTE&n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n1=QUES_VOTE&n2_vote_ts_seq0_r0_n2!=INVALID&n2_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n2_log_ts_seq0'=OUT_OF_ROUND) & (n2_stage_seq0'=pre_decided_stage);
    [n2_process_vote_for_seq0_r0_using_n0] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=0 & n2_round_0+1=MAX_ROUND & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n1!=INVALID)|(n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)) & n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n0=QUES_VOTE&n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n1=QUES_VOTE&n2_vote_ts_seq0_r0_n2!=INVALID&n2_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n2_log_ts_seq0'=OUT_OF_ROUND) & (n2_stage_seq0'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 1 for seq0 at round0.
    [n2_process_vote_for_seq0_r0_using_n1] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=0 & n2_round_0+1<MAX_ROUND & (n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n1!=QUES_VOTE) & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n1!=INVALID)|(n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)) & !((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n0=n2_vote_ts_seq0_r0_n1)|(n2_vote_ts_seq0_r0_n2!=INVALID&n2_vote_ts_seq0_r0_n2=n2_vote_ts_seq0_r0_n1)) ->         (n2_state_ts_seq0_r0_n2'=n2_vote_ts_seq0_r0_n1) & (n2_vote_ts_seq0_r0_n2'=INVALID) & (n2_stage_seq0'=p2s_stage) & (n2_round_0'=n2_round_0+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=0+1) & (n2_send_cmd_ts'=n2_state_ts_seq0_r0_n1);
    //// 2.fail: Out of rounds
    [n2_process_vote_for_seq0_r0_using_n1] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=0 & n2_round_0+1=MAX_ROUND & (n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n1!=QUES_VOTE) & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n1!=INVALID)|(n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)) & !((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n0=n2_vote_ts_seq0_r0_n1)|(n2_vote_ts_seq0_r0_n2!=INVALID&n2_vote_ts_seq0_r0_n2=n2_vote_ts_seq0_r0_n1)) ->         (n2_log_ts_seq0'=OUT_OF_ROUND) & (n2_stage_seq0'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n2_process_vote_for_seq0_r0_using_n1] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=0 & n2_round_0+1<MAX_ROUND & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n1!=INVALID)|(n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)) & n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n0=QUES_VOTE&n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n1=QUES_VOTE&n2_vote_ts_seq0_r0_n2!=INVALID&n2_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n2_state_ts_seq0_r0_n2'=BOT)                                    & (n2_vote_ts_seq0_r0_n2'=INVALID) & (n2_stage_seq0'=p2s_stage) & (n2_round_0'=n2_round_0+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=0+1) & (n2_send_cmd_ts'=BOT);
    [n2_process_vote_for_seq0_r0_using_n1] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=0 & n2_round_0+1<MAX_ROUND & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n1!=INVALID)|(n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)) & n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n0=QUES_VOTE&n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n1=QUES_VOTE&n2_vote_ts_seq0_r0_n2!=INVALID&n2_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n2_state_ts_seq0_r0_n2'=n2_state_ts_seq0_r0_n1) & (n2_vote_ts_seq0_r0_n2'=INVALID) & (n2_stage_seq0'=p2s_stage) & (n2_round_0'=n2_round_0+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=0+1) & (n2_send_cmd_ts'=n2_state_ts_seq0_r0_n1);
    //// 3.fail: Out of rounds
    [n2_process_vote_for_seq0_r0_using_n1] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=0 & n2_round_0+1=MAX_ROUND & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n1!=INVALID)|(n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)) & n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n0=QUES_VOTE&n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n1=QUES_VOTE&n2_vote_ts_seq0_r0_n2!=INVALID&n2_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n2_log_ts_seq0'=OUT_OF_ROUND) & (n2_stage_seq0'=pre_decided_stage);
    [n2_process_vote_for_seq0_r0_using_n1] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=0 & n2_round_0+1=MAX_ROUND & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n1!=INVALID)|(n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)) & n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n0=QUES_VOTE&n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n1=QUES_VOTE&n2_vote_ts_seq0_r0_n2!=INVALID&n2_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n2_log_ts_seq0'=OUT_OF_ROUND) & (n2_stage_seq0'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 2 for seq0 at round0.
    [n2_process_vote_for_seq0_r0_using_n2] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=0 & n2_round_0+1<MAX_ROUND & (n2_vote_ts_seq0_r0_n2!=INVALID&n2_vote_ts_seq0_r0_n2!=QUES_VOTE) & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n1!=INVALID)|(n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)) & !((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n0=n2_vote_ts_seq0_r0_n2)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n1=n2_vote_ts_seq0_r0_n2)) ->         (n2_state_ts_seq0_r0_n2'=n2_vote_ts_seq0_r0_n2) & (n2_vote_ts_seq0_r0_n2'=INVALID) & (n2_stage_seq0'=p2s_stage) & (n2_round_0'=n2_round_0+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=0+1) & (n2_send_cmd_ts'=n2_state_ts_seq0_r0_n2);
    //// 2.fail: Out of rounds
    [n2_process_vote_for_seq0_r0_using_n2] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=0 & n2_round_0+1=MAX_ROUND & (n2_vote_ts_seq0_r0_n2!=INVALID&n2_vote_ts_seq0_r0_n2!=QUES_VOTE) & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n1!=INVALID)|(n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)) & !((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n0=n2_vote_ts_seq0_r0_n2)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n1=n2_vote_ts_seq0_r0_n2)) ->         (n2_log_ts_seq0'=OUT_OF_ROUND) & (n2_stage_seq0'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n2_process_vote_for_seq0_r0_using_n2] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=0 & n2_round_0+1<MAX_ROUND & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n1!=INVALID)|(n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)) & n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n0=QUES_VOTE&n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n1=QUES_VOTE&n2_vote_ts_seq0_r0_n2!=INVALID&n2_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n2_state_ts_seq0_r0_n2'=BOT)                                    & (n2_vote_ts_seq0_r0_n2'=INVALID) & (n2_stage_seq0'=p2s_stage) & (n2_round_0'=n2_round_0+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=0+1) & (n2_send_cmd_ts'=BOT);
    [n2_process_vote_for_seq0_r0_using_n2] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=0 & n2_round_0+1<MAX_ROUND & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n1!=INVALID)|(n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)) & n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n0=QUES_VOTE&n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n1=QUES_VOTE&n2_vote_ts_seq0_r0_n2!=INVALID&n2_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n2_state_ts_seq0_r0_n2'=n2_state_ts_seq0_r0_n2) & (n2_vote_ts_seq0_r0_n2'=INVALID) & (n2_stage_seq0'=p2s_stage) & (n2_round_0'=n2_round_0+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=0+1) & (n2_send_cmd_ts'=n2_state_ts_seq0_r0_n2);
    //// 3.fail: Out of rounds
    [n2_process_vote_for_seq0_r0_using_n2] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=0 & n2_round_0+1=MAX_ROUND & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n1!=INVALID)|(n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)) & n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n0=QUES_VOTE&n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n1=QUES_VOTE&n2_vote_ts_seq0_r0_n2!=INVALID&n2_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n2_log_ts_seq0'=OUT_OF_ROUND) & (n2_stage_seq0'=pre_decided_stage);
    [n2_process_vote_for_seq0_r0_using_n2] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=0 & n2_round_0+1=MAX_ROUND & ((n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n1!=INVALID)|(n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)|(n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n2!=INVALID)) & n2_vote_ts_seq0_r0_n0!=INVALID&n2_vote_ts_seq0_r0_n0=QUES_VOTE&n2_vote_ts_seq0_r0_n1!=INVALID&n2_vote_ts_seq0_r0_n1=QUES_VOTE&n2_vote_ts_seq0_r0_n2!=INVALID&n2_vote_ts_seq0_r0_n2=QUES_VOTE ->         (n2_log_ts_seq0'=OUT_OF_ROUND) & (n2_stage_seq0'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 0 for seq0 at round1.
    [n2_process_vote_for_seq0_r1_using_n0] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=1 & n2_round_0+1<MAX_ROUND & (n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n0!=QUES_VOTE) & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n1!=INVALID)|(n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)) & !((n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n1=n2_vote_ts_seq0_r1_n0)|(n2_vote_ts_seq0_r1_n2!=INVALID&n2_vote_ts_seq0_r1_n2=n2_vote_ts_seq0_r1_n0)) ->         (n2_state_ts_seq0_r1_n2'=n2_vote_ts_seq0_r1_n0) & (n2_vote_ts_seq0_r1_n2'=INVALID) & (n2_stage_seq0'=p2s_stage) & (n2_round_0'=n2_round_0+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=1+1) & (n2_send_cmd_ts'=n2_state_ts_seq0_r1_n0);
    //// 2.fail: Out of rounds
    [n2_process_vote_for_seq0_r1_using_n0] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=1 & n2_round_0+1=MAX_ROUND & (n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n0!=QUES_VOTE) & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n1!=INVALID)|(n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)) & !((n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n1=n2_vote_ts_seq0_r1_n0)|(n2_vote_ts_seq0_r1_n2!=INVALID&n2_vote_ts_seq0_r1_n2=n2_vote_ts_seq0_r1_n0)) ->         (n2_log_ts_seq0'=OUT_OF_ROUND) & (n2_stage_seq0'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n2_process_vote_for_seq0_r1_using_n0] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=1 & n2_round_0+1<MAX_ROUND & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n1!=INVALID)|(n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)) & n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n0=QUES_VOTE&n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n1=QUES_VOTE&n2_vote_ts_seq0_r1_n2!=INVALID&n2_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n2_state_ts_seq0_r1_n2'=BOT)                                    & (n2_vote_ts_seq0_r1_n2'=INVALID) & (n2_stage_seq0'=p2s_stage) & (n2_round_0'=n2_round_0+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=1+1) & (n2_send_cmd_ts'=BOT);
    [n2_process_vote_for_seq0_r1_using_n0] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=1 & n2_round_0+1<MAX_ROUND & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n1!=INVALID)|(n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)) & n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n0=QUES_VOTE&n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n1=QUES_VOTE&n2_vote_ts_seq0_r1_n2!=INVALID&n2_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n2_state_ts_seq0_r1_n2'=n2_state_ts_seq0_r1_n0) & (n2_vote_ts_seq0_r1_n2'=INVALID) & (n2_stage_seq0'=p2s_stage) & (n2_round_0'=n2_round_0+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=1+1) & (n2_send_cmd_ts'=n2_state_ts_seq0_r1_n0);
    //// 3.fail: Out of rounds
    [n2_process_vote_for_seq0_r1_using_n0] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=1 & n2_round_0+1=MAX_ROUND & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n1!=INVALID)|(n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)) & n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n0=QUES_VOTE&n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n1=QUES_VOTE&n2_vote_ts_seq0_r1_n2!=INVALID&n2_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n2_log_ts_seq0'=OUT_OF_ROUND) & (n2_stage_seq0'=pre_decided_stage);
    [n2_process_vote_for_seq0_r1_using_n0] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=1 & n2_round_0+1=MAX_ROUND & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n1!=INVALID)|(n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)) & n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n0=QUES_VOTE&n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n1=QUES_VOTE&n2_vote_ts_seq0_r1_n2!=INVALID&n2_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n2_log_ts_seq0'=OUT_OF_ROUND) & (n2_stage_seq0'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 1 for seq0 at round1.
    [n2_process_vote_for_seq0_r1_using_n1] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=1 & n2_round_0+1<MAX_ROUND & (n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n1!=QUES_VOTE) & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n1!=INVALID)|(n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)) & !((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n0=n2_vote_ts_seq0_r1_n1)|(n2_vote_ts_seq0_r1_n2!=INVALID&n2_vote_ts_seq0_r1_n2=n2_vote_ts_seq0_r1_n1)) ->         (n2_state_ts_seq0_r1_n2'=n2_vote_ts_seq0_r1_n1) & (n2_vote_ts_seq0_r1_n2'=INVALID) & (n2_stage_seq0'=p2s_stage) & (n2_round_0'=n2_round_0+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=1+1) & (n2_send_cmd_ts'=n2_state_ts_seq0_r1_n1);
    //// 2.fail: Out of rounds
    [n2_process_vote_for_seq0_r1_using_n1] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=1 & n2_round_0+1=MAX_ROUND & (n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n1!=QUES_VOTE) & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n1!=INVALID)|(n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)) & !((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n0=n2_vote_ts_seq0_r1_n1)|(n2_vote_ts_seq0_r1_n2!=INVALID&n2_vote_ts_seq0_r1_n2=n2_vote_ts_seq0_r1_n1)) ->         (n2_log_ts_seq0'=OUT_OF_ROUND) & (n2_stage_seq0'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n2_process_vote_for_seq0_r1_using_n1] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=1 & n2_round_0+1<MAX_ROUND & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n1!=INVALID)|(n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)) & n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n0=QUES_VOTE&n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n1=QUES_VOTE&n2_vote_ts_seq0_r1_n2!=INVALID&n2_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n2_state_ts_seq0_r1_n2'=BOT)                                    & (n2_vote_ts_seq0_r1_n2'=INVALID) & (n2_stage_seq0'=p2s_stage) & (n2_round_0'=n2_round_0+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=1+1) & (n2_send_cmd_ts'=BOT);
    [n2_process_vote_for_seq0_r1_using_n1] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=1 & n2_round_0+1<MAX_ROUND & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n1!=INVALID)|(n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)) & n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n0=QUES_VOTE&n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n1=QUES_VOTE&n2_vote_ts_seq0_r1_n2!=INVALID&n2_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n2_state_ts_seq0_r1_n2'=n2_state_ts_seq0_r1_n1) & (n2_vote_ts_seq0_r1_n2'=INVALID) & (n2_stage_seq0'=p2s_stage) & (n2_round_0'=n2_round_0+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=1+1) & (n2_send_cmd_ts'=n2_state_ts_seq0_r1_n1);
    //// 3.fail: Out of rounds
    [n2_process_vote_for_seq0_r1_using_n1] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=1 & n2_round_0+1=MAX_ROUND & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n1!=INVALID)|(n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)) & n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n0=QUES_VOTE&n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n1=QUES_VOTE&n2_vote_ts_seq0_r1_n2!=INVALID&n2_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n2_log_ts_seq0'=OUT_OF_ROUND) & (n2_stage_seq0'=pre_decided_stage);
    [n2_process_vote_for_seq0_r1_using_n1] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=1 & n2_round_0+1=MAX_ROUND & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n1!=INVALID)|(n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)) & n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n0=QUES_VOTE&n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n1=QUES_VOTE&n2_vote_ts_seq0_r1_n2!=INVALID&n2_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n2_log_ts_seq0'=OUT_OF_ROUND) & (n2_stage_seq0'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 2 for seq0 at round1.
    [n2_process_vote_for_seq0_r1_using_n2] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=1 & n2_round_0+1<MAX_ROUND & (n2_vote_ts_seq0_r1_n2!=INVALID&n2_vote_ts_seq0_r1_n2!=QUES_VOTE) & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n1!=INVALID)|(n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)) & !((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n0=n2_vote_ts_seq0_r1_n2)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n1=n2_vote_ts_seq0_r1_n2)) ->         (n2_state_ts_seq0_r1_n2'=n2_vote_ts_seq0_r1_n2) & (n2_vote_ts_seq0_r1_n2'=INVALID) & (n2_stage_seq0'=p2s_stage) & (n2_round_0'=n2_round_0+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=1+1) & (n2_send_cmd_ts'=n2_state_ts_seq0_r1_n2);
    //// 2.fail: Out of rounds
    [n2_process_vote_for_seq0_r1_using_n2] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=1 & n2_round_0+1=MAX_ROUND & (n2_vote_ts_seq0_r1_n2!=INVALID&n2_vote_ts_seq0_r1_n2!=QUES_VOTE) & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n1!=INVALID)|(n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)) & !((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n0=n2_vote_ts_seq0_r1_n2)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n1=n2_vote_ts_seq0_r1_n2)) ->         (n2_log_ts_seq0'=OUT_OF_ROUND) & (n2_stage_seq0'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n2_process_vote_for_seq0_r1_using_n2] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=1 & n2_round_0+1<MAX_ROUND & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n1!=INVALID)|(n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)) & n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n0=QUES_VOTE&n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n1=QUES_VOTE&n2_vote_ts_seq0_r1_n2!=INVALID&n2_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n2_state_ts_seq0_r1_n2'=BOT)                                    & (n2_vote_ts_seq0_r1_n2'=INVALID) & (n2_stage_seq0'=p2s_stage) & (n2_round_0'=n2_round_0+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=1+1) & (n2_send_cmd_ts'=BOT);
    [n2_process_vote_for_seq0_r1_using_n2] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=1 & n2_round_0+1<MAX_ROUND & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n1!=INVALID)|(n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)) & n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n0=QUES_VOTE&n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n1=QUES_VOTE&n2_vote_ts_seq0_r1_n2!=INVALID&n2_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n2_state_ts_seq0_r1_n2'=n2_state_ts_seq0_r1_n2) & (n2_vote_ts_seq0_r1_n2'=INVALID) & (n2_stage_seq0'=p2s_stage) & (n2_round_0'=n2_round_0+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=0) & (n2_send_round'=1+1) & (n2_send_cmd_ts'=n2_state_ts_seq0_r1_n2);
    //// 3.fail: Out of rounds
    [n2_process_vote_for_seq0_r1_using_n2] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=1 & n2_round_0+1=MAX_ROUND & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n1!=INVALID)|(n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)) & n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n0=QUES_VOTE&n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n1=QUES_VOTE&n2_vote_ts_seq0_r1_n2!=INVALID&n2_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n2_log_ts_seq0'=OUT_OF_ROUND) & (n2_stage_seq0'=pre_decided_stage);
    [n2_process_vote_for_seq0_r1_using_n2] n2_stage_seq0=p2v_stage & n2_send_ready=false & n2_round_0=1 & n2_round_0+1=MAX_ROUND & ((n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n1!=INVALID)|(n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)|(n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n2!=INVALID)) & n2_vote_ts_seq0_r1_n0!=INVALID&n2_vote_ts_seq0_r1_n0=QUES_VOTE&n2_vote_ts_seq0_r1_n1!=INVALID&n2_vote_ts_seq0_r1_n1=QUES_VOTE&n2_vote_ts_seq0_r1_n2!=INVALID&n2_vote_ts_seq0_r1_n2=QUES_VOTE ->         (n2_log_ts_seq0'=OUT_OF_ROUND) & (n2_stage_seq0'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 0 for seq1 at round0.
    [n2_process_vote_for_seq1_r0_using_n0] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=0 & n2_round_1+1<MAX_ROUND & (n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n0!=QUES_VOTE) & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n1!=INVALID)|(n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)) & !((n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n1=n2_vote_ts_seq1_r0_n0)|(n2_vote_ts_seq1_r0_n2!=INVALID&n2_vote_ts_seq1_r0_n2=n2_vote_ts_seq1_r0_n0)) ->         (n2_state_ts_seq1_r0_n2'=n2_vote_ts_seq1_r0_n0) & (n2_vote_ts_seq1_r0_n2'=INVALID) & (n2_stage_seq1'=p2s_stage) & (n2_round_1'=n2_round_1+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=0+1) & (n2_send_cmd_ts'=n2_state_ts_seq1_r0_n0);
    //// 2.fail: Out of rounds
    [n2_process_vote_for_seq1_r0_using_n0] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=0 & n2_round_1+1=MAX_ROUND & (n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n0!=QUES_VOTE) & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n1!=INVALID)|(n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)) & !((n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n1=n2_vote_ts_seq1_r0_n0)|(n2_vote_ts_seq1_r0_n2!=INVALID&n2_vote_ts_seq1_r0_n2=n2_vote_ts_seq1_r0_n0)) ->         (n2_log_ts_seq1'=OUT_OF_ROUND) & (n2_stage_seq1'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n2_process_vote_for_seq1_r0_using_n0] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=0 & n2_round_1+1<MAX_ROUND & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n1!=INVALID)|(n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)) & n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n0=QUES_VOTE&n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n1=QUES_VOTE&n2_vote_ts_seq1_r0_n2!=INVALID&n2_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n2_state_ts_seq1_r0_n2'=BOT)                                    & (n2_vote_ts_seq1_r0_n2'=INVALID) & (n2_stage_seq1'=p2s_stage) & (n2_round_1'=n2_round_1+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=0+1) & (n2_send_cmd_ts'=BOT);
    [n2_process_vote_for_seq1_r0_using_n0] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=0 & n2_round_1+1<MAX_ROUND & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n1!=INVALID)|(n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)) & n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n0=QUES_VOTE&n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n1=QUES_VOTE&n2_vote_ts_seq1_r0_n2!=INVALID&n2_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n2_state_ts_seq1_r0_n2'=n2_state_ts_seq1_r0_n0) & (n2_vote_ts_seq1_r0_n2'=INVALID) & (n2_stage_seq1'=p2s_stage) & (n2_round_1'=n2_round_1+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=0+1) & (n2_send_cmd_ts'=n2_state_ts_seq1_r0_n0);
    //// 3.fail: Out of rounds
    [n2_process_vote_for_seq1_r0_using_n0] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=0 & n2_round_1+1=MAX_ROUND & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n1!=INVALID)|(n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)) & n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n0=QUES_VOTE&n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n1=QUES_VOTE&n2_vote_ts_seq1_r0_n2!=INVALID&n2_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n2_log_ts_seq1'=OUT_OF_ROUND) & (n2_stage_seq1'=pre_decided_stage);
    [n2_process_vote_for_seq1_r0_using_n0] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=0 & n2_round_1+1=MAX_ROUND & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n1!=INVALID)|(n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)) & n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n0=QUES_VOTE&n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n1=QUES_VOTE&n2_vote_ts_seq1_r0_n2!=INVALID&n2_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n2_log_ts_seq1'=OUT_OF_ROUND) & (n2_stage_seq1'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 1 for seq1 at round0.
    [n2_process_vote_for_seq1_r0_using_n1] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=0 & n2_round_1+1<MAX_ROUND & (n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n1!=QUES_VOTE) & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n1!=INVALID)|(n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)) & !((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n0=n2_vote_ts_seq1_r0_n1)|(n2_vote_ts_seq1_r0_n2!=INVALID&n2_vote_ts_seq1_r0_n2=n2_vote_ts_seq1_r0_n1)) ->         (n2_state_ts_seq1_r0_n2'=n2_vote_ts_seq1_r0_n1) & (n2_vote_ts_seq1_r0_n2'=INVALID) & (n2_stage_seq1'=p2s_stage) & (n2_round_1'=n2_round_1+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=0+1) & (n2_send_cmd_ts'=n2_state_ts_seq1_r0_n1);
    //// 2.fail: Out of rounds
    [n2_process_vote_for_seq1_r0_using_n1] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=0 & n2_round_1+1=MAX_ROUND & (n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n1!=QUES_VOTE) & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n1!=INVALID)|(n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)) & !((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n0=n2_vote_ts_seq1_r0_n1)|(n2_vote_ts_seq1_r0_n2!=INVALID&n2_vote_ts_seq1_r0_n2=n2_vote_ts_seq1_r0_n1)) ->         (n2_log_ts_seq1'=OUT_OF_ROUND) & (n2_stage_seq1'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n2_process_vote_for_seq1_r0_using_n1] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=0 & n2_round_1+1<MAX_ROUND & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n1!=INVALID)|(n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)) & n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n0=QUES_VOTE&n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n1=QUES_VOTE&n2_vote_ts_seq1_r0_n2!=INVALID&n2_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n2_state_ts_seq1_r0_n2'=BOT)                                    & (n2_vote_ts_seq1_r0_n2'=INVALID) & (n2_stage_seq1'=p2s_stage) & (n2_round_1'=n2_round_1+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=0+1) & (n2_send_cmd_ts'=BOT);
    [n2_process_vote_for_seq1_r0_using_n1] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=0 & n2_round_1+1<MAX_ROUND & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n1!=INVALID)|(n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)) & n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n0=QUES_VOTE&n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n1=QUES_VOTE&n2_vote_ts_seq1_r0_n2!=INVALID&n2_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n2_state_ts_seq1_r0_n2'=n2_state_ts_seq1_r0_n1) & (n2_vote_ts_seq1_r0_n2'=INVALID) & (n2_stage_seq1'=p2s_stage) & (n2_round_1'=n2_round_1+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=0+1) & (n2_send_cmd_ts'=n2_state_ts_seq1_r0_n1);
    //// 3.fail: Out of rounds
    [n2_process_vote_for_seq1_r0_using_n1] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=0 & n2_round_1+1=MAX_ROUND & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n1!=INVALID)|(n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)) & n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n0=QUES_VOTE&n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n1=QUES_VOTE&n2_vote_ts_seq1_r0_n2!=INVALID&n2_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n2_log_ts_seq1'=OUT_OF_ROUND) & (n2_stage_seq1'=pre_decided_stage);
    [n2_process_vote_for_seq1_r0_using_n1] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=0 & n2_round_1+1=MAX_ROUND & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n1!=INVALID)|(n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)) & n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n0=QUES_VOTE&n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n1=QUES_VOTE&n2_vote_ts_seq1_r0_n2!=INVALID&n2_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n2_log_ts_seq1'=OUT_OF_ROUND) & (n2_stage_seq1'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 2 for seq1 at round0.
    [n2_process_vote_for_seq1_r0_using_n2] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=0 & n2_round_1+1<MAX_ROUND & (n2_vote_ts_seq1_r0_n2!=INVALID&n2_vote_ts_seq1_r0_n2!=QUES_VOTE) & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n1!=INVALID)|(n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)) & !((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n0=n2_vote_ts_seq1_r0_n2)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n1=n2_vote_ts_seq1_r0_n2)) ->         (n2_state_ts_seq1_r0_n2'=n2_vote_ts_seq1_r0_n2) & (n2_vote_ts_seq1_r0_n2'=INVALID) & (n2_stage_seq1'=p2s_stage) & (n2_round_1'=n2_round_1+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=0+1) & (n2_send_cmd_ts'=n2_state_ts_seq1_r0_n2);
    //// 2.fail: Out of rounds
    [n2_process_vote_for_seq1_r0_using_n2] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=0 & n2_round_1+1=MAX_ROUND & (n2_vote_ts_seq1_r0_n2!=INVALID&n2_vote_ts_seq1_r0_n2!=QUES_VOTE) & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n1!=INVALID)|(n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)) & !((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n0=n2_vote_ts_seq1_r0_n2)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n1=n2_vote_ts_seq1_r0_n2)) ->         (n2_log_ts_seq1'=OUT_OF_ROUND) & (n2_stage_seq1'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n2_process_vote_for_seq1_r0_using_n2] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=0 & n2_round_1+1<MAX_ROUND & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n1!=INVALID)|(n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)) & n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n0=QUES_VOTE&n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n1=QUES_VOTE&n2_vote_ts_seq1_r0_n2!=INVALID&n2_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n2_state_ts_seq1_r0_n2'=BOT)                                    & (n2_vote_ts_seq1_r0_n2'=INVALID) & (n2_stage_seq1'=p2s_stage) & (n2_round_1'=n2_round_1+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=0+1) & (n2_send_cmd_ts'=BOT);
    [n2_process_vote_for_seq1_r0_using_n2] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=0 & n2_round_1+1<MAX_ROUND & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n1!=INVALID)|(n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)) & n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n0=QUES_VOTE&n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n1=QUES_VOTE&n2_vote_ts_seq1_r0_n2!=INVALID&n2_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n2_state_ts_seq1_r0_n2'=n2_state_ts_seq1_r0_n2) & (n2_vote_ts_seq1_r0_n2'=INVALID) & (n2_stage_seq1'=p2s_stage) & (n2_round_1'=n2_round_1+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=0+1) & (n2_send_cmd_ts'=n2_state_ts_seq1_r0_n2);
    //// 3.fail: Out of rounds
    [n2_process_vote_for_seq1_r0_using_n2] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=0 & n2_round_1+1=MAX_ROUND & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n1!=INVALID)|(n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)) & n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n0=QUES_VOTE&n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n1=QUES_VOTE&n2_vote_ts_seq1_r0_n2!=INVALID&n2_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n2_log_ts_seq1'=OUT_OF_ROUND) & (n2_stage_seq1'=pre_decided_stage);
    [n2_process_vote_for_seq1_r0_using_n2] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=0 & n2_round_1+1=MAX_ROUND & ((n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n1!=INVALID)|(n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)|(n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n2!=INVALID)) & n2_vote_ts_seq1_r0_n0!=INVALID&n2_vote_ts_seq1_r0_n0=QUES_VOTE&n2_vote_ts_seq1_r0_n1!=INVALID&n2_vote_ts_seq1_r0_n1=QUES_VOTE&n2_vote_ts_seq1_r0_n2!=INVALID&n2_vote_ts_seq1_r0_n2=QUES_VOTE ->         (n2_log_ts_seq1'=OUT_OF_ROUND) & (n2_stage_seq1'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 0 for seq1 at round1.
    [n2_process_vote_for_seq1_r1_using_n0] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=1 & n2_round_1+1<MAX_ROUND & (n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n0!=QUES_VOTE) & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n1!=INVALID)|(n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)) & !((n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n1=n2_vote_ts_seq1_r1_n0)|(n2_vote_ts_seq1_r1_n2!=INVALID&n2_vote_ts_seq1_r1_n2=n2_vote_ts_seq1_r1_n0)) ->         (n2_state_ts_seq1_r1_n2'=n2_vote_ts_seq1_r1_n0) & (n2_vote_ts_seq1_r1_n2'=INVALID) & (n2_stage_seq1'=p2s_stage) & (n2_round_1'=n2_round_1+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=1+1) & (n2_send_cmd_ts'=n2_state_ts_seq1_r1_n0);
    //// 2.fail: Out of rounds
    [n2_process_vote_for_seq1_r1_using_n0] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=1 & n2_round_1+1=MAX_ROUND & (n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n0!=QUES_VOTE) & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n1!=INVALID)|(n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)) & !((n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n1=n2_vote_ts_seq1_r1_n0)|(n2_vote_ts_seq1_r1_n2!=INVALID&n2_vote_ts_seq1_r1_n2=n2_vote_ts_seq1_r1_n0)) ->         (n2_log_ts_seq1'=OUT_OF_ROUND) & (n2_stage_seq1'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n2_process_vote_for_seq1_r1_using_n0] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=1 & n2_round_1+1<MAX_ROUND & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n1!=INVALID)|(n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)) & n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n0=QUES_VOTE&n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n1=QUES_VOTE&n2_vote_ts_seq1_r1_n2!=INVALID&n2_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n2_state_ts_seq1_r1_n2'=BOT)                                    & (n2_vote_ts_seq1_r1_n2'=INVALID) & (n2_stage_seq1'=p2s_stage) & (n2_round_1'=n2_round_1+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=1+1) & (n2_send_cmd_ts'=BOT);
    [n2_process_vote_for_seq1_r1_using_n0] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=1 & n2_round_1+1<MAX_ROUND & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n1!=INVALID)|(n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)) & n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n0=QUES_VOTE&n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n1=QUES_VOTE&n2_vote_ts_seq1_r1_n2!=INVALID&n2_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n2_state_ts_seq1_r1_n2'=n2_state_ts_seq1_r1_n0) & (n2_vote_ts_seq1_r1_n2'=INVALID) & (n2_stage_seq1'=p2s_stage) & (n2_round_1'=n2_round_1+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=1+1) & (n2_send_cmd_ts'=n2_state_ts_seq1_r1_n0);
    //// 3.fail: Out of rounds
    [n2_process_vote_for_seq1_r1_using_n0] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=1 & n2_round_1+1=MAX_ROUND & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n1!=INVALID)|(n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)) & n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n0=QUES_VOTE&n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n1=QUES_VOTE&n2_vote_ts_seq1_r1_n2!=INVALID&n2_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n2_log_ts_seq1'=OUT_OF_ROUND) & (n2_stage_seq1'=pre_decided_stage);
    [n2_process_vote_for_seq1_r1_using_n0] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=1 & n2_round_1+1=MAX_ROUND & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n1!=INVALID)|(n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)) & n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n0=QUES_VOTE&n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n1=QUES_VOTE&n2_vote_ts_seq1_r1_n2!=INVALID&n2_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n2_log_ts_seq1'=OUT_OF_ROUND) & (n2_stage_seq1'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 1 for seq1 at round1.
    [n2_process_vote_for_seq1_r1_using_n1] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=1 & n2_round_1+1<MAX_ROUND & (n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n1!=QUES_VOTE) & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n1!=INVALID)|(n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)) & !((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n0=n2_vote_ts_seq1_r1_n1)|(n2_vote_ts_seq1_r1_n2!=INVALID&n2_vote_ts_seq1_r1_n2=n2_vote_ts_seq1_r1_n1)) ->         (n2_state_ts_seq1_r1_n2'=n2_vote_ts_seq1_r1_n1) & (n2_vote_ts_seq1_r1_n2'=INVALID) & (n2_stage_seq1'=p2s_stage) & (n2_round_1'=n2_round_1+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=1+1) & (n2_send_cmd_ts'=n2_state_ts_seq1_r1_n1);
    //// 2.fail: Out of rounds
    [n2_process_vote_for_seq1_r1_using_n1] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=1 & n2_round_1+1=MAX_ROUND & (n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n1!=QUES_VOTE) & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n1!=INVALID)|(n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)) & !((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n0=n2_vote_ts_seq1_r1_n1)|(n2_vote_ts_seq1_r1_n2!=INVALID&n2_vote_ts_seq1_r1_n2=n2_vote_ts_seq1_r1_n1)) ->         (n2_log_ts_seq1'=OUT_OF_ROUND) & (n2_stage_seq1'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n2_process_vote_for_seq1_r1_using_n1] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=1 & n2_round_1+1<MAX_ROUND & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n1!=INVALID)|(n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)) & n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n0=QUES_VOTE&n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n1=QUES_VOTE&n2_vote_ts_seq1_r1_n2!=INVALID&n2_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n2_state_ts_seq1_r1_n2'=BOT)                                    & (n2_vote_ts_seq1_r1_n2'=INVALID) & (n2_stage_seq1'=p2s_stage) & (n2_round_1'=n2_round_1+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=1+1) & (n2_send_cmd_ts'=BOT);
    [n2_process_vote_for_seq1_r1_using_n1] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=1 & n2_round_1+1<MAX_ROUND & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n1!=INVALID)|(n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)) & n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n0=QUES_VOTE&n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n1=QUES_VOTE&n2_vote_ts_seq1_r1_n2!=INVALID&n2_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n2_state_ts_seq1_r1_n2'=n2_state_ts_seq1_r1_n1) & (n2_vote_ts_seq1_r1_n2'=INVALID) & (n2_stage_seq1'=p2s_stage) & (n2_round_1'=n2_round_1+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=1+1) & (n2_send_cmd_ts'=n2_state_ts_seq1_r1_n1);
    //// 3.fail: Out of rounds
    [n2_process_vote_for_seq1_r1_using_n1] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=1 & n2_round_1+1=MAX_ROUND & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n1!=INVALID)|(n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)) & n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n0=QUES_VOTE&n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n1=QUES_VOTE&n2_vote_ts_seq1_r1_n2!=INVALID&n2_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n2_log_ts_seq1'=OUT_OF_ROUND) & (n2_stage_seq1'=pre_decided_stage);
    [n2_process_vote_for_seq1_r1_using_n1] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=1 & n2_round_1+1=MAX_ROUND & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n1!=INVALID)|(n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)) & n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n0=QUES_VOTE&n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n1=QUES_VOTE&n2_vote_ts_seq1_r1_n2!=INVALID&n2_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n2_log_ts_seq1'=OUT_OF_ROUND) & (n2_stage_seq1'=pre_decided_stage);
                                                                                                                                                                                                                          
    // 2. When we have enough non-question votes, but not a quorum, then we assign any non-question vote using the proposal from node 2 for seq1 at round1.
    [n2_process_vote_for_seq1_r1_using_n2] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=1 & n2_round_1+1<MAX_ROUND & (n2_vote_ts_seq1_r1_n2!=INVALID&n2_vote_ts_seq1_r1_n2!=QUES_VOTE) & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n1!=INVALID)|(n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)) & !((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n0=n2_vote_ts_seq1_r1_n2)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n1=n2_vote_ts_seq1_r1_n2)) ->         (n2_state_ts_seq1_r1_n2'=n2_vote_ts_seq1_r1_n2) & (n2_vote_ts_seq1_r1_n2'=INVALID) & (n2_stage_seq1'=p2s_stage) & (n2_round_1'=n2_round_1+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=1+1) & (n2_send_cmd_ts'=n2_state_ts_seq1_r1_n2);
    //// 2.fail: Out of rounds
    [n2_process_vote_for_seq1_r1_using_n2] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=1 & n2_round_1+1=MAX_ROUND & (n2_vote_ts_seq1_r1_n2!=INVALID&n2_vote_ts_seq1_r1_n2!=QUES_VOTE) & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n1!=INVALID)|(n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)) & !((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n0=n2_vote_ts_seq1_r1_n2)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n1=n2_vote_ts_seq1_r1_n2)) ->         (n2_log_ts_seq1'=OUT_OF_ROUND) & (n2_stage_seq1'=pre_decided_stage);

    // 3. We only got QUES_VOTE, let god decides.
    [n2_process_vote_for_seq1_r1_using_n2] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=1 & n2_round_1+1<MAX_ROUND & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n1!=INVALID)|(n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)) & n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n0=QUES_VOTE&n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n1=QUES_VOTE&n2_vote_ts_seq1_r1_n2!=INVALID&n2_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n2_state_ts_seq1_r1_n2'=BOT)                                    & (n2_vote_ts_seq1_r1_n2'=INVALID) & (n2_stage_seq1'=p2s_stage) & (n2_round_1'=n2_round_1+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=1+1) & (n2_send_cmd_ts'=BOT);
    [n2_process_vote_for_seq1_r1_using_n2] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=1 & n2_round_1+1<MAX_ROUND & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n1!=INVALID)|(n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)) & n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n0=QUES_VOTE&n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n1=QUES_VOTE&n2_vote_ts_seq1_r1_n2!=INVALID&n2_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n2_state_ts_seq1_r1_n2'=n2_state_ts_seq1_r1_n2) & (n2_vote_ts_seq1_r1_n2'=INVALID) & (n2_stage_seq1'=p2s_stage) & (n2_round_1'=n2_round_1+1) & (n2_send_ready'=true) & (n2_send_is_broadcast'=true) & (n2_send_type'=cmd_state) & (n2_send_seq'=1) & (n2_send_round'=1+1) & (n2_send_cmd_ts'=n2_state_ts_seq1_r1_n2);
    //// 3.fail: Out of rounds
    [n2_process_vote_for_seq1_r1_using_n2] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=1 & n2_round_1+1=MAX_ROUND & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n1!=INVALID)|(n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)) & n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n0=QUES_VOTE&n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n1=QUES_VOTE&n2_vote_ts_seq1_r1_n2!=INVALID&n2_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n2_log_ts_seq1'=OUT_OF_ROUND) & (n2_stage_seq1'=pre_decided_stage);
    [n2_process_vote_for_seq1_r1_using_n2] n2_stage_seq1=p2v_stage & n2_send_ready=false & n2_round_1=1 & n2_round_1+1=MAX_ROUND & ((n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n1!=INVALID)|(n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)|(n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n2!=INVALID)) & n2_vote_ts_seq1_r1_n0!=INVALID&n2_vote_ts_seq1_r1_n0=QUES_VOTE&n2_vote_ts_seq1_r1_n1!=INVALID&n2_vote_ts_seq1_r1_n1=QUES_VOTE&n2_vote_ts_seq1_r1_n2!=INVALID&n2_vote_ts_seq1_r1_n2=QUES_VOTE ->         (n2_log_ts_seq1'=OUT_OF_ROUND) & (n2_stage_seq1'=pre_decided_stage);

    // Pre-decided 
    // Success case, directly go to decided 
    [n2_pre_decided_stage_seq0] n2_stage_seq0=pre_decided_stage & n2_log_ts_seq0!=OUT_OF_ROUND & n2_seq+1<LOG_SIZE -> (n2_stage_seq0'=decided) & (n2_seq'=n2_seq+1);
    [n2_pre_decided_stage_seq0] n2_stage_seq0=pre_decided_stage & n2_log_ts_seq0!=OUT_OF_ROUND & n2_seq+1=LOG_SIZE -> (n2_stage_seq0'=decided);
    // Success case, directly go to decided 
    [n2_pre_decided_stage_seq1] n2_stage_seq1=pre_decided_stage & n2_log_ts_seq1!=OUT_OF_ROUND & n2_seq+1<LOG_SIZE -> (n2_stage_seq1'=decided) & (n2_seq'=n2_seq+1);
    [n2_pre_decided_stage_seq1] n2_stage_seq1=pre_decided_stage & n2_log_ts_seq1!=OUT_OF_ROUND & n2_seq+1=LOG_SIZE -> (n2_stage_seq1'=decided);
    // Failed case, put my proposal back to q0
    [n2_pre_decided_stage_seq0_using_q0] n2_stage_seq0=pre_decided_stage & n2_log_ts_seq0=OUT_OF_ROUND & n2_pq_valid_0=false & n2_seq+1<LOG_SIZE -> (n2_stage_seq0'=decided) & (n2_pq_valid_0'=true) & (n2_pq_ts_0'=n2_proposal_seq0_r0_n2) & (n2_seq'=n2_seq+1);
    [n2_pre_decided_stage_seq0_using_q0] n2_stage_seq0=pre_decided_stage & n2_log_ts_seq0=OUT_OF_ROUND & n2_pq_valid_0=false & n2_seq+1=LOG_SIZE -> (n2_stage_seq0'=decided) & (n2_pq_valid_0'=true) & (n2_pq_ts_0'=n2_proposal_seq0_r0_n2);
    // Failed case, put my proposal back to q1
    [n2_pre_decided_stage_seq0_using_q1] n2_stage_seq0=pre_decided_stage & n2_log_ts_seq0=OUT_OF_ROUND & n2_pq_valid_1=false & n2_seq+1<LOG_SIZE -> (n2_stage_seq0'=decided) & (n2_pq_valid_1'=true) & (n2_pq_ts_1'=n2_proposal_seq0_r0_n2) & (n2_seq'=n2_seq+1);
    [n2_pre_decided_stage_seq0_using_q1] n2_stage_seq0=pre_decided_stage & n2_log_ts_seq0=OUT_OF_ROUND & n2_pq_valid_1=false & n2_seq+1=LOG_SIZE -> (n2_stage_seq0'=decided) & (n2_pq_valid_1'=true) & (n2_pq_ts_1'=n2_proposal_seq0_r0_n2);
    // Failed case, put my proposal back to q0
    [n2_pre_decided_stage_seq1_using_q0] n2_stage_seq1=pre_decided_stage & n2_log_ts_seq1=OUT_OF_ROUND & n2_pq_valid_0=false & n2_seq+1<LOG_SIZE -> (n2_stage_seq1'=decided) & (n2_pq_valid_0'=true) & (n2_pq_ts_0'=n2_proposal_seq1_r0_n2) & (n2_seq'=n2_seq+1);
    [n2_pre_decided_stage_seq1_using_q0] n2_stage_seq1=pre_decided_stage & n2_log_ts_seq1=OUT_OF_ROUND & n2_pq_valid_0=false & n2_seq+1=LOG_SIZE -> (n2_stage_seq1'=decided) & (n2_pq_valid_0'=true) & (n2_pq_ts_0'=n2_proposal_seq1_r0_n2);
    // Failed case, put my proposal back to q1
    [n2_pre_decided_stage_seq1_using_q1] n2_stage_seq1=pre_decided_stage & n2_log_ts_seq1=OUT_OF_ROUND & n2_pq_valid_1=false & n2_seq+1<LOG_SIZE -> (n2_stage_seq1'=decided) & (n2_pq_valid_1'=true) & (n2_pq_ts_1'=n2_proposal_seq1_r0_n2) & (n2_seq'=n2_seq+1);
    [n2_pre_decided_stage_seq1_using_q1] n2_stage_seq1=pre_decided_stage & n2_log_ts_seq1=OUT_OF_ROUND & n2_pq_valid_1=false & n2_seq+1=LOG_SIZE -> (n2_stage_seq1'=decided) & (n2_pq_valid_1'=true) & (n2_pq_ts_1'=n2_proposal_seq1_r0_n2);
                                                                                                                                                                                                                                                                           
    // Receive and process_decided
    [n2_receive_and_process_decided_for_seq0] n2_recv_ready=true & n2_recv_type=cmd_decided & n2_recv_seq=0 & n2_stage_seq0!=decided & n2_seq+1<LOG_SIZE -> (n2_recv_ready'=false) & (n2_log_ts_seq0'=n2_recv_cmd_ts) & (n2_stage_seq0'=decided) & (n2_seq'=n2_seq+1);
    [n2_receive_and_process_decided_for_seq0] n2_recv_ready=true & n2_recv_type=cmd_decided & n2_recv_seq=0 & n2_stage_seq0!=decided & n2_seq+1=LOG_SIZE -> (n2_recv_ready'=false) & (n2_log_ts_seq0'=n2_recv_cmd_ts) & (n2_stage_seq0'=decided);
    [n2_receive_and_process_decided_for_seq0] n2_recv_ready=true & n2_recv_type=cmd_decided & n2_recv_seq=0 & n2_stage_seq0=decided  -> (n2_recv_ready'=false);
                                                                                                                                                                                                                                                                           
    // Receive and process_decided
    [n2_receive_and_process_decided_for_seq1] n2_recv_ready=true & n2_recv_type=cmd_decided & n2_recv_seq=1 & n2_stage_seq1!=decided & n2_seq+1<LOG_SIZE -> (n2_recv_ready'=false) & (n2_log_ts_seq1'=n2_recv_cmd_ts) & (n2_stage_seq1'=decided) & (n2_seq'=n2_seq+1);
    [n2_receive_and_process_decided_for_seq1] n2_recv_ready=true & n2_recv_type=cmd_decided & n2_recv_seq=1 & n2_stage_seq1!=decided & n2_seq+1=LOG_SIZE -> (n2_recv_ready'=false) & (n2_log_ts_seq1'=n2_recv_cmd_ts) & (n2_stage_seq1'=decided);
    [n2_receive_and_process_decided_for_seq1] n2_recv_ready=true & n2_recv_type=cmd_decided & n2_recv_seq=1 & n2_stage_seq1=decided  -> (n2_recv_ready'=false);

    // Send when a pkt is ready; Recv when a pkt is ready.
    [recv_02_0] n2_recv_ready=false ->         (n2_recv_ready'=true) & (n2_recv_from'=0) & (n2_recv_type'=w02_pkt_type_0) & (n2_recv_seq'=w02_pkt_seq_0) & (n2_recv_round'=w02_pkt_round_0) & (n2_recv_cmd_ts'=w02_pkt_cmd_ts_0);
    [send_20_0] n2_send_ready=true & n2_send_is_broadcast=false -> (n2_send_ready'=false);
    [recv_12_0] n2_recv_ready=false ->         (n2_recv_ready'=true) & (n2_recv_from'=1) & (n2_recv_type'=w12_pkt_type_0) & (n2_recv_seq'=w12_pkt_seq_0) & (n2_recv_round'=w12_pkt_round_0) & (n2_recv_cmd_ts'=w12_pkt_cmd_ts_0);
    [send_21_0] n2_send_ready=true & n2_send_is_broadcast=false -> (n2_send_ready'=false);
    [recv_02_1] n2_recv_ready=false ->         (n2_recv_ready'=true) & (n2_recv_from'=0) & (n2_recv_type'=w02_pkt_type_1) & (n2_recv_seq'=w02_pkt_seq_1) & (n2_recv_round'=w02_pkt_round_1) & (n2_recv_cmd_ts'=w02_pkt_cmd_ts_1);
    [send_20_1] n2_send_ready=true & n2_send_is_broadcast=false -> (n2_send_ready'=false);
    [recv_12_1] n2_recv_ready=false ->         (n2_recv_ready'=true) & (n2_recv_from'=1) & (n2_recv_type'=w12_pkt_type_1) & (n2_recv_seq'=w12_pkt_seq_1) & (n2_recv_round'=w12_pkt_round_1) & (n2_recv_cmd_ts'=w12_pkt_cmd_ts_1);
    [send_21_1] n2_send_ready=true & n2_send_is_broadcast=false -> (n2_send_ready'=false);
    [n2_send_broadcast] n2_send_ready=true & n2_send_is_broadcast=true -> (n2_send_ready'=false);

endmodule

module wire01
    // pkt slot 0
    w01_pkt_valid_0 : bool init false;
    w01_pkt_type_0 : [0..NUM_CMD_TYPES] init 0;
    w01_pkt_seq_0 : [0..LOG_SIZE] init 0;
    w01_pkt_round_0 : [0..MAX_ROUND] init 0;
    w01_pkt_cmd_ts_0 : [MIN_TS_VALUE..MAX_TS] init 0;
    // pkt slot 1
    w01_pkt_valid_1 : bool init false;
    w01_pkt_type_1 : [0..NUM_CMD_TYPES] init 0;
    w01_pkt_seq_1 : [0..LOG_SIZE] init 0;
    w01_pkt_round_1 : [0..MAX_ROUND] init 0;
    w01_pkt_cmd_ts_1 : [MIN_TS_VALUE..MAX_TS] init 0;
    [n0_send_broadcast] n0_send_ready=true & n0_send_is_broadcast=true & w01_pkt_valid_0=false ->         (w01_pkt_valid_0'=true) & (w01_pkt_type_0'=n0_send_type) & (w01_pkt_seq_0'=n0_send_seq) & (w01_pkt_round_0'=n0_send_round) & (w01_pkt_cmd_ts_0'=n0_send_cmd_ts);
    [send_01_0] n0_send_ready=true & n0_send_is_broadcast=false & w01_pkt_valid_0 = false & n0_send_ready=true ->         (w01_pkt_valid_0'=true) & (w01_pkt_type_0'=n0_send_type) & (w01_pkt_seq_0'=n0_send_seq) & (w01_pkt_round_0'=n0_send_round) & (w01_pkt_cmd_ts_0'=n0_send_cmd_ts);
    [recv_01_0] n0_recv_ready=false & w01_pkt_valid_0 = true -> (w01_pkt_valid_0'=false);
    [n0_send_broadcast] n0_send_ready=true & n0_send_is_broadcast=true & w01_pkt_valid_1=false ->         (w01_pkt_valid_1'=true) & (w01_pkt_type_1'=n0_send_type) & (w01_pkt_seq_1'=n0_send_seq) & (w01_pkt_round_1'=n0_send_round) & (w01_pkt_cmd_ts_1'=n0_send_cmd_ts);
    [send_01_1] n0_send_ready=true & n0_send_is_broadcast=false & w01_pkt_valid_1 = false & n0_send_ready=true ->         (w01_pkt_valid_1'=true) & (w01_pkt_type_1'=n0_send_type) & (w01_pkt_seq_1'=n0_send_seq) & (w01_pkt_round_1'=n0_send_round) & (w01_pkt_cmd_ts_1'=n0_send_cmd_ts);
    [recv_01_1] n0_recv_ready=false & w01_pkt_valid_1 = true -> (w01_pkt_valid_1'=false);

endmodule
module wire02 = wire01[n0_send_broadcast=n0_send_broadcast,w01_pkt_valid_0=w02_pkt_valid_0,w01_pkt_type_0=w02_pkt_type_0,w01_pkt_seq_0=w02_pkt_seq_0,w01_pkt_round_0=w02_pkt_round_0,w01_pkt_cmd_ts_0=w02_pkt_cmd_ts_0,send_01_0=send_02_0,recv_01_0=recv_02_0,w01_pkt_valid_1=w02_pkt_valid_1,w01_pkt_type_1=w02_pkt_type_1,w01_pkt_seq_1=w02_pkt_seq_1,w01_pkt_round_1=w02_pkt_round_1,w01_pkt_cmd_ts_1=w02_pkt_cmd_ts_1,send_01_1=send_02_1,recv_01_1=recv_02_1,n0_send_ready=n0_send_ready,n0_send_is_broadcast=n0_send_is_broadcast,n0_send_type=n0_send_type,n0_send_seq=n0_send_seq,n0_send_round=n0_send_round,n0_send_cmd_ts=n0_send_cmd_ts] endmodule
     
module wire10 = wire01[n0_send_broadcast=n1_send_broadcast,w01_pkt_valid_0=w10_pkt_valid_0,w01_pkt_type_0=w10_pkt_type_0,w01_pkt_seq_0=w10_pkt_seq_0,w01_pkt_round_0=w10_pkt_round_0,w01_pkt_cmd_ts_0=w10_pkt_cmd_ts_0,send_01_0=send_10_0,recv_01_0=recv_10_0,w01_pkt_valid_1=w10_pkt_valid_1,w01_pkt_type_1=w10_pkt_type_1,w01_pkt_seq_1=w10_pkt_seq_1,w01_pkt_round_1=w10_pkt_round_1,w01_pkt_cmd_ts_1=w10_pkt_cmd_ts_1,send_01_1=send_10_1,recv_01_1=recv_10_1,n0_send_ready=n1_send_ready,n0_send_is_broadcast=n1_send_is_broadcast,n0_send_type=n1_send_type,n0_send_seq=n1_send_seq,n0_send_round=n1_send_round,n0_send_cmd_ts=n1_send_cmd_ts] endmodule
     
module wire12 = wire01[n0_send_broadcast=n1_send_broadcast,w01_pkt_valid_0=w12_pkt_valid_0,w01_pkt_type_0=w12_pkt_type_0,w01_pkt_seq_0=w12_pkt_seq_0,w01_pkt_round_0=w12_pkt_round_0,w01_pkt_cmd_ts_0=w12_pkt_cmd_ts_0,send_01_0=send_12_0,recv_01_0=recv_12_0,w01_pkt_valid_1=w12_pkt_valid_1,w01_pkt_type_1=w12_pkt_type_1,w01_pkt_seq_1=w12_pkt_seq_1,w01_pkt_round_1=w12_pkt_round_1,w01_pkt_cmd_ts_1=w12_pkt_cmd_ts_1,send_01_1=send_12_1,recv_01_1=recv_12_1,n0_send_ready=n1_send_ready,n0_send_is_broadcast=n1_send_is_broadcast,n0_send_type=n1_send_type,n0_send_seq=n1_send_seq,n0_send_round=n1_send_round,n0_send_cmd_ts=n1_send_cmd_ts] endmodule
     
module wire20 = wire01[n0_send_broadcast=n2_send_broadcast,w01_pkt_valid_0=w20_pkt_valid_0,w01_pkt_type_0=w20_pkt_type_0,w01_pkt_seq_0=w20_pkt_seq_0,w01_pkt_round_0=w20_pkt_round_0,w01_pkt_cmd_ts_0=w20_pkt_cmd_ts_0,send_01_0=send_20_0,recv_01_0=recv_20_0,w01_pkt_valid_1=w20_pkt_valid_1,w01_pkt_type_1=w20_pkt_type_1,w01_pkt_seq_1=w20_pkt_seq_1,w01_pkt_round_1=w20_pkt_round_1,w01_pkt_cmd_ts_1=w20_pkt_cmd_ts_1,send_01_1=send_20_1,recv_01_1=recv_20_1,n0_send_ready=n2_send_ready,n0_send_is_broadcast=n2_send_is_broadcast,n0_send_type=n2_send_type,n0_send_seq=n2_send_seq,n0_send_round=n2_send_round,n0_send_cmd_ts=n2_send_cmd_ts] endmodule
     
module wire21 = wire01[n0_send_broadcast=n2_send_broadcast,w01_pkt_valid_0=w21_pkt_valid_0,w01_pkt_type_0=w21_pkt_type_0,w01_pkt_seq_0=w21_pkt_seq_0,w01_pkt_round_0=w21_pkt_round_0,w01_pkt_cmd_ts_0=w21_pkt_cmd_ts_0,send_01_0=send_21_0,recv_01_0=recv_21_0,w01_pkt_valid_1=w21_pkt_valid_1,w01_pkt_type_1=w21_pkt_type_1,w01_pkt_seq_1=w21_pkt_seq_1,w01_pkt_round_1=w21_pkt_round_1,w01_pkt_cmd_ts_1=w21_pkt_cmd_ts_1,send_01_1=send_21_1,recv_01_1=recv_21_1,n0_send_ready=n2_send_ready,n0_send_is_broadcast=n2_send_is_broadcast,n0_send_type=n2_send_type,n0_send_seq=n2_send_seq,n0_send_round=n2_send_round,n0_send_cmd_ts=n2_send_cmd_ts] endmodule
     
// rewards (to calculate expected number of steps)
rewards "steps"
    true : 1;
endrewards
label "n0_decided_log_seq0" = n0_log_ts_seq0 != INVALID;
label "n0_decided_log_seq0_good_value" = n0_log_ts_seq0 != INVALID & n0_log_ts_seq0 != BOT & n0_log_ts_seq0 != QUES_VOTE & n0_log_ts_seq0 != OUT_OF_ROUND;
label "n1_decided_log_seq0" = n1_log_ts_seq0 != INVALID;
label "n1_decided_log_seq0_good_value" = n1_log_ts_seq0 != INVALID & n1_log_ts_seq0 != BOT & n1_log_ts_seq0 != QUES_VOTE & n1_log_ts_seq0 != OUT_OF_ROUND;
label "n2_decided_log_seq0" = n2_log_ts_seq0 != INVALID;
label "n2_decided_log_seq0_good_value" = n2_log_ts_seq0 != INVALID & n2_log_ts_seq0 != BOT & n2_log_ts_seq0 != QUES_VOTE & n2_log_ts_seq0 != OUT_OF_ROUND;
label "n0_decided_log_seq1" = n0_log_ts_seq1 != INVALID;
label "n0_decided_log_seq1_good_value" = n0_log_ts_seq1 != INVALID & n0_log_ts_seq1 != BOT & n0_log_ts_seq1 != QUES_VOTE & n0_log_ts_seq1 != OUT_OF_ROUND;
label "n1_decided_log_seq1" = n1_log_ts_seq1 != INVALID;
label "n1_decided_log_seq1_good_value" = n1_log_ts_seq1 != INVALID & n1_log_ts_seq1 != BOT & n1_log_ts_seq1 != QUES_VOTE & n1_log_ts_seq1 != OUT_OF_ROUND;
label "n2_decided_log_seq1" = n2_log_ts_seq1 != INVALID;
label "n2_decided_log_seq1_good_value" = n2_log_ts_seq1 != INVALID & n2_log_ts_seq1 != BOT & n2_log_ts_seq1 != QUES_VOTE & n2_log_ts_seq1 != OUT_OF_ROUND;
label "n0_decided_log_seq0_is_out_of_round" = n0_log_ts_seq0 = OUT_OF_ROUND;
label "n1_decided_log_seq0_is_out_of_round" = n1_log_ts_seq0 = OUT_OF_ROUND;
label "n2_decided_log_seq0_is_out_of_round" = n2_log_ts_seq0 = OUT_OF_ROUND;
label "n0_decided_log_seq1_is_out_of_round" = n0_log_ts_seq1 = OUT_OF_ROUND;
label "n1_decided_log_seq1_is_out_of_round" = n1_log_ts_seq1 = OUT_OF_ROUND;
label "n2_decided_log_seq1_is_out_of_round" = n2_log_ts_seq1 = OUT_OF_ROUND;
label "n0_decided_log_seq0_is_ques_vote" = n0_log_ts_seq0 = QUES_VOTE;
label "n1_decided_log_seq0_is_ques_vote" = n1_log_ts_seq0 = QUES_VOTE;
label "n2_decided_log_seq0_is_ques_vote" = n2_log_ts_seq0 = QUES_VOTE;
label "n0_decided_log_seq1_is_ques_vote" = n0_log_ts_seq1 = QUES_VOTE;
label "n1_decided_log_seq1_is_ques_vote" = n1_log_ts_seq1 = QUES_VOTE;
label "n2_decided_log_seq1_is_ques_vote" = n2_log_ts_seq1 = QUES_VOTE;

